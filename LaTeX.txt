% File tacl2021v1.tex
% Dec. 15, 2021

% The English content of this file was modified from various *ACL instructions
% by Lillian Lee and Kristina Toutanova
%
% LaTeXery is mostly all adapted from acl2018.sty.

\documentclass[11pt,a4paper]{article}
\usepackage{times,latexsym}
\usepackage{url}
\usepackage[T1]{fontenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{cuted}
\usepackage{graphicx}
\usepackage{graphicx}
\usepackage{appendix}
\usepackage{esint}
\usepackage{bbold}
\usepackage{physics}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{scrextend}
\usepackage{adjustbox}
\usepackage{algorithm}
\usepackage{algpseudocode}
%% Package options:
%% Short version: "hyperref" and "submission" are the defaults.
%% More verbose version:
%% Most compact command to produce a submission version with hyperref enabled
%%    \usepackage[]{tacl2021v1}
%% Most compact command to produce a "camera-ready" version
\usepackage[acceptedWithA]{tacl2021v1}
%% Most compact command to produce a double-spaced copy-editor's version
%%    \usepackage[acceptedWithA,copyedit]{tacl2021v1}
%
%% If you need to disable hyperref in any of the above settings (see subsection
%% "LaTeX files") in the TACL instructions), add ",nohyperref" in the square
%% brackets. (The comma is a delimiter in case there are multiple options specified.)

\usepackage{tacl2021v1}
% \setlength\titlebox{10cm} % <- for Option 2 below

%%%% Material in this block is specific to generating TACL instructions
\usepackage{xspace,mfirstuc,tabulary}
\newcommand{\dateOfLastUpdate}{Dec. 15, 2021}
\newcommand{\styleFileVersion}{tacl2021v1}

\newcommand{\ex}[1]{{\sf #1}}

\newif\iftaclinstructions
\taclinstructionsfalse % AUTHORS: do NOT set this to true
\iftaclinstructions
\renewcommand{\confidential}{}
\renewcommand{\anonsubtext}{(No author info supplied here, for consistency with
TACL-submission anonymization requirements)}
\newcommand{\instr}
\fi

%
\iftaclpubformat % this "if" is set by the choice of options
\newcommand{\taclpaper}{final version\xspace}
\newcommand{\taclpapers}{final versions\xspace}
\newcommand{\Taclpaper}{Final version\xspace}
\newcommand{\Taclpapers}{Final versions\xspace}
\newcommand{\TaclPapers}{Final Versions\xspace}
\else
\newcommand{\taclpaper}{submission\xspace}
\newcommand{\taclpapers}{{\taclpaper}s\xspace}
\newcommand{\Taclpaper}{Submission\xspace}
\newcommand{\Taclpapers}{{\Taclpaper}s\xspace}
\newcommand{\TaclPapers}{Submissions\xspace}
\fi

%%%% End TACL-instructions-specific macro block
%%%%

\title{Improving Text Generation Metrics for\\ Evaluating Fine-Grained Physics Derivations}

% Author information does not appear in the pdf unless the "acceptedWithA" option is given

% The author block may be formatted in one of two ways:

% Option 1. Author’s address is underneath each name, centered.

%\author{
%  Template %Author1\Thanks{The {\em %actual} contributors to %this instruction
%    document and %corresponding template %file are given in %subsection
%    \ref{sec:contributo%rs}.} 
%  \\
%  Template %Affiliation1/Address %Line 1
%  \\
%  Template %Affiliation1/Address %Line 2
%  \\
%  Template %Affiliation1/Address %Line 2
%  \\
%  \texttt{template.emai%l1example.com}
%  \And
%  Template Author2 
%  \\
%  Template %Affiliation2/Address %Line 1
%  \\
%  Template %Affiliation2/Address %Line 2
%  \\
%  Template %Affiliation2/Address %Line 2
%  \\
%  \texttt{template.emai%l2@example.com}
%}

% % Option 2.  Author’s address is linked with superscript
% % characters to its name, author names are grouped, centered.

\author{Jordan Meadows$^1$, Tamsin James$^2$, Andr\'e Freitas$^{1,3}$ \\ $^1$University of Manchester, United Kingdom \\ $^2$University of Birmingham, United Kingdom\\ $^3$Idiap Research Institute, Switzerland \\
\texttt{jordan.meadows@postgrad.manchester.ac.uk} \\
\texttt{txj287@student.bham.ac.uk} \\
\texttt{andre.freitas@idiap.ch}}

\begin{document}
\maketitle
\begin{abstract}

The process of deriving equations from premises is a core component of mathematics and science. Large Language Models (LLMs) are somewhat able to derive equations, through text generation, but frequently hallucinate reasoning errors that limit their utility in theoretical discovery. This fundamental limitation of LLMs is impacted by the fact that common text generation metrics -- used to guide training and evaluate models -- entirely fail to capture these reasoning errors, such as the incorrect use of variables, operations, and syntax. Using a novel dataset of highly detailed physics derivations comprising various notations (such as braket notation and vector calculus), we evaluate the derivation generation capabilities of GPT and T5-related models in zero-shot and few-shot settings, and introduce simple improvements that better account for mathematical errors, and increase metric agreement.   

\end{abstract}

\section{Introduction}

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.85\linewidth]{gpt_errors.PNG}
    \caption{An incorrect derivation generated by \textbf{few-shot GPT-4} that scores high ROUGE (81), BLEU (71), and GLEU (71). Erroneous equations are denoted in red.}
    \label{fig:gpt4}
\end{figure}

LLMs are widely capable reasoners~\cite{lewkowycz2022solving,valentino2022hybrid,wysocka2023large,latif2023transformers}. Some possess domain knowledge spanning numerous fields, and can use mathematical and scientific laws to infer fair answers to difficult questions. However, their mathematical prowess has been called into question, due to hallucination issues impacting detailed elements of proofs~\cite{frieder2023mathematical}. These issues are exacerbated by the fact that common metrics used to measure the quality of models' reasoning are in poor agreement with mathematicians~\cite{welleck2022naturalprover}. It is difficult to ascertain exactly where models are making mistakes (such as those made by GPT-4 in Fig.~\ref{fig:gpt4}), because common metrics do not adequately penalise many fine-grained errors that, without incorporating a symbolic engine~\cite{meurer2017sympy}, must otherwise be discovered through extensive qualitative analysis~\cite{meadows2023generating}. 

Meanwhile, \textit{Physics} is a rich environment within which the mathematical capabilities of LLMs may be thoroughly examined, yet there are few examples of such efforts~\cite{lewkowycz2022solving}. This is particularly true at the lowest levels of calculation detail -- precisely where language models fail. In particular, theoretical physics is almost singularly concerned with deriving novel equations from premises. Even ignoring the deep physical interpretations of variables, expressions, and equations that characterise physics (and separate it from \textit{Mathematics}), the mechanical pursuit of deriving equations is unique due to its informal use of mathematical tools and specific notation. 

Physicists spend months \textit{deriving equations} from papers to verify and build on them. This directly results in profound technological advancements, such as \textit{electronics}~\cite{maxwell1865viii} and \textit{quantum computers}~\cite{benioff1980computer}. We would clearly like to automate this process, yet physics is largely incompatible with automated theorem provers~\cite{kaliszyk2015formalizing,davis2019use,meadows2021similarity}, and LLMs (such as GPT-4) are currently unable to provide fine-grained mathematical detail robustly. One reason why LLMs fail in this regard, is because online resources used for training (such as Wikipedia and arXiv), and many math reasoning datasets~\cite{mishra2022lila,hendrycks2021measuring,saxton2019analysing}, do not feature the required detail or notation necessary for fine-grained physics reasoning. In papers, much of this notation is written in LaTeX (\textit{e.g.,} Fig.~\ref{fig:gpt4}), and models need extensive training on derivations containing specific notation (\textit{e.g.,} braket notation), to be be able to generate syntactically and semantically correct derivations. There is a lack of suitable training and evaluation data, and metrics, to deliver this goal. Addressing the latter two issues, we contribute:


\begin{enumerate}
    \item A dataset of 218 fine-grained physics derivations comprising sequences of up to 9 equations, spanning electromagnetism, classical, quantum, and statistical mechanics. Derivations are similar to those found on Wikipedia, but have been expanded to include every step, resulting in highly detailed reasoning. Premise equations are separated from non-premises per example, where many premises are goal equations from previous derivations. Therefore, derivations may be chained together to form much longer sequences.

    \item An algorithm $(\mathcal{S}_M)$ for extending the functionality of common metrics to account for (empirically discovered) syntactic and semantic errors. This approach leads to improved agreement between metrics, more appropriate penalisation of errors, and less error counts in high ranking derivations.
    
    \item Zero-shot and few-shot evaluation of GPT-4, ChatGPT, and T5-related models on a derivation generation task with the curated dataset, using both common text generation metrics and their enhanced variations.  
\end{enumerate}

\noindent Through these contributions, we garner insights on the proficiency of LLMs in performing out-of-distribution fine-grained physics reasoning, and how text generation metrics may be adapted (without explicit reliance on symbolic engines~\cite{meurer2017sympy}) to better capture detailed reasoning errors frequently hallucinated by LLMs. We hope this research contributes to the increased use of LLMs for accelerating theoretical research, as mathematical work is increasingly outsourced to artificial intelligence.  

\section{Related work}

Our focus is the generation of physics derivations, resembling highly detailed human workings, with LLMs~\cite{brown2020language,ahmed2022few,song2022llm,ge2023openagi,hu2023llm,yang2023harnessing}. While we presently consider \textit{solely equations}, math generation exists in various forms, and is split between approaches that consider formal languages, and those that consider informal mathematical natural language~\cite{meadows2022survey,ferreira2020natural,welleck2021naturalproofs,ferreira2022or,valentino2022textgraphs}. In the formal case, GPT-j~\cite{polu2020generative, polu2022formal}, LISA~\cite{jiang2021language}, and Baldur~\cite{first2023baldur} model Metamath and Isabelle/HOL proofs. For generation involving informal reasoning, an approach based on OpenAI's Codex~\cite{chen2021evaluating, drori2022neural} translates university-level problems into executable code, and generates solution explanations. Minerva~\cite{lewkowycz2022solving} is a PaLM~\cite{chowdhery2022palm} model trained on a large corpus of mathematical text, and solves university-level problems in applied math, including physics, that outputs solutions in the form of mathematical and natural language. NaturalProver~\cite{welleck2022naturalprover} generates similar solutions to proofs from a curated dataset~\cite{welleck2021naturalproofs}. 
Some approaches rely on computer algebra systems, such as SymPy~\cite{meurer2017sympy}. \citet{chen2022program} solve numerical reasoning tasks including simple math elements such as numbers, by chain-of-thought prompting~\cite{wei2023chainofthought} language models to generate SymPy solvable code. \citet{mandlecha2022hybrid} employ models to answer questions ranging from arithmetic to calculus, and \citet{hu2022enhancing} solve a similar array of problems from a large-scale dataset~\cite{saxton2019analysing}. \citet{Drori_2022} fine-tune the decoder model, Codex~\cite{chen2021evaluating}, on a dataset of questions from MIT's university-level mathematics courses, generating SymPy solution code. \citet{lample2019deep} train a model to integrate and solve differential equations (somewhat~\cite{davis2019use}) more successfully than computer algebra systems. \citet{meadows2021similarity} reconstruct derivations from condensed matter research~\cite{mann2018manipulating} using a similarity-based search with a symbolic engine. Numerous approaches exist related to evaluating the mathematical and symbolic capabilities and robustness of models~\cite{welleck2022symbolic,stolfo2022causal,meadows2023symbolic}, in contexts such as solving math word problems~\cite{liang2022mwp,lewkowycz2022solving}. In particular, \citet{meadows2023generating} generate synthetic training data and out-of-distribution test sets to evaluate model generalisability in the context of derivation generation, and we use their training set to few-shot prompt GPT, and to guide dataset construction in the present work. Various datasets exist containing mathematical and physical reasoning~\cite{ferreira2020natural,hendrycks2021measuring,welleck2021naturalproofs,meadows2022physnlu,mishra2022lila}, however, we focus on isolating equational content from natural language descriptions, for the purpose of testing purely the mechanical, mathematical capabilities of models in the physics domain.

\section{Physics Data}

\begin{figure*}[h!]
    \centering
    \includegraphics[width=1\textwidth]{Figure1.jpg}
    \caption{The difference between the Wikipedia proof (left) and our equational interpretation (right) of a reasoning chain related to the Uncertainty Principle in quantum mechanics. The (red) values represent the number of intermediate equations between equivalent equations in each representation, and highlights the detail gap.}
    \label{fig:proof_comp}
\end{figure*}

We aim to elicit model behaviour resembling fine-grained workings, at approximately the level of a physicist \textit{carefully} checking a result they derived is true. This means models must perform sequential implicit operations to equations, such as integration and substitution, form implicit dependency graphs between linearised sequence elements during inference, while consistently using notation specified in the prompt, barely skipping steps, and grasping syntax.

To elicit this from models, we take a number of derivations from Wikipedia and rewrite them with the required granularity. Fig.~\ref{fig:proof_comp} gives an example of this rewriting and the departure from natural language. With respect to granularity differences, the single intermediate step (denoted by red) in the Wikipedia derivation on the left, is actually multiple finer-grained steps naturally omitted for the sake of succinct communication online. Experienced physicists may indeed skip these steps within their own workings, but there is no guarantee that language models can perform them reliably without hallucination~\cite{welleck2022naturalprover,frieder2023mathematical,meadows2023generating}. On the right hand side, this single step is expanded into four finer-grained steps that \textit{improve explainability}. The first of these equations is a premise defined in the natural language description from the Wikipedia example, that we necessarily include within our rewrite for a self-contained derivation. The second equation substitutes that premise into the first equation, and the third equation is not explicitly written anywhere -- it is the Fourier transform of $\varphi(\chi)$ hinted at within the Wikipedia description that, again, is necessary for completeness. The remaining equations are obtained through substituting elements of previous equations.

Our inclusion of the (implicit) Fourier transform and the (explicit) premise, give examples of how we map information from a combined modality of natural language and equations, to a single equational modality. Our expansion of one step into four, describes our push towards explainable \textit{fine-grained} reasoning of the kind we aim to elicit from models. High-quality~\cite{villalobos2022run} data of this kind is necessary to bridge an incompleteness gap between the communicative reasoning available online (used to train models), and the verbose reality of everyday calculation~\cite{meadows2021similarity}. Without evidence that models can robustly perform sequential fine-grained mathematics, it will be difficult to trust their utility in theoretical discovery.

\paragraph{Data Analysis.} We expand 60 Wikipedia examples following the discussed principles, and extract 218 short derivations resembling that of Fig.~\ref{fig:proof_comp}. The data is split into three fields: \textbf{Electromagnetism} (containing vector calculus), \textbf{Quantum Mechanics} (containing braket notation and commutation relations), and \textbf{Other Physics} (containing results from \textit{classical} and \textit{statistical mechanics}). Tab.~\ref{tab:sizes} captures the number of derivations within each subdivision. All curated examples are written in Appendices~\ref{app:electromagnetism} (electromagnetism), \ref{app:quantum} (quantum), and \ref{app:other} (other).

{\renewcommand{\arraystretch}{1.1}%
\begin{table}[h!]
	\centering
	\scalebox{1}{
		\begin{tabular}{@{}c|c @{}}
			\textbf{Field of Physics} & \textbf{\# Derivations}\\
			\hline
            Electromagnetism & 82 \\
            Quantum Mechanics & 98 \\
            Other Physics & 38 \\
            All fields & 218 \\
		\end{tabular}
		}
	\caption{Number of derivations in the dataset by field of physics. The \textit{Other} category corresponds to results from classical and statistical mechanics.}
	\label{tab:sizes}
\end{table}}

\noindent Smaller models, such as BERT~\cite{devlin2018bert} and T5~\cite{raffel2020exploring}, are limited to input sequences of up to 512 tokens. This corresponds to a LaTeX derivation comprising between 4-9 equations (excluding natural language). We segment the original expanded derivations into shorter examples to accommodate these limitations, where longer equations generally occur within shorter derivations, and vice versa. Much of this is ``by eye'' however, and tokenizers used in experiments exclude 14\% of the dataset. The length distribution of examples -- alongside a similar set of synthetic LaTeX derivations~\cite{meadows2023generating} -- is given in Fig.~\ref{fig:length_distribution}.

Other similarities with the synthetic dataset include an overlap of 155 physics symbols and a similar step granularity. Otherwise, the physics derivations contain significantly more symbols, limits of integration, and entirely separate notation. In particular, this includes \textit{braket notation} that is commonplace in \textit{quantum mechanics} (such as $\int \braket{x}{\Psi}^{\dagger}x'\delta(x-x') \braket{x'}{\Psi} dx' = \braket{x}{\Psi}^{\dagger}x \braket{x}{\Psi}$, from \ref{app:quantum}.93), and \textit{vector calculus} -- involving the grad, curl, and div operators -- that is commonplace in \textit{electromagnetism} (such as $\nabla \cdot (\phi\nabla\phi) = (\nabla\phi)^2 + \phi\nabla^2\phi$, from \ref{app:electromagnetism}.8).

\textit{Premise equations} are another crucial element of derivations. These are axiomatic equations deemed necessary (or at least helpful) for deriving a goal equation. The distribution of the number of premises per derivation is given in Fig.~\ref{fig:premise_distribution}. Examples from the physics data contain 2 or 3 premises on average, and when derivations contain an average of 5 or 6 equations, this means there are only a couple of steps that actually involve any application of implicit operations (such as substitution or differentiation). Any remaining steps involve simply writing the premises and goal equation in the correct order, with correct syntax. Premises are separated from non-premises, and goal equations from some derivations are premises in another, meaning that sequences may be chained together to form much longer examples (up to roughly 60 derivations containing 20 equations each without repeats). The dataset contains both prompts and corresponding derivations. Output derivations take the form of LaTeX equations conjoined by an ``and'' token, which provides a minimalistic \textit{template} for defining equation boundaries.

\begin{figure}[h!]
    \centering
    \includegraphics[width=1\linewidth]{Lengths.PNG}
    \caption{$P(L)$ is the probability that a given derivation contains $L$ equations. \textit{Physics Distribution} represents the length distribution of the physics derivations presented in the the current work, while \textit{Synthetic Distribution} represents that of the synthetic derivations used to train MathT5.}
    \label{fig:length_distribution}
\end{figure} 

\begin{figure}[h!]
    \centering
    \includegraphics[width=1\linewidth]{Premises.PNG}
    \caption{$P(N)$ is the probability that a given derivation contains $N$ premise equations.}
    \label{fig:premise_distribution}
\end{figure} 

\section{Derivation Generation}

\paragraph{Zero-shot prompting.} We want models to generate self-contained sequences of equations that derive goal equations from premises using implicit operations, such as the rightmost derivation of Fig.~\ref{fig:proof_comp}. To do this, the data contains premises and goal equations following the template below.
\vspace{10pt}
\begin{addmargin}[1em]{1em}% 1em left, 2em right
\textit{Given \;\; $q{(a)} = e^{a}$ \newline \newline and  \;\; $G{(a)} = - e^{a} + \frac{d}{d a} q{(a)}$, \newline \newline
then obtain \;\; $e^{G{(a)}} = 1$}
\end{addmargin}
\vspace{10pt}
This mirrors the template from \citet{meadows2023generating}, except that intermediate steps are not given in the prompt because differentation and integration results are generally derived more naturally in the physics data, rather than being calculated in a single step with an engine~\cite{meurer2017sympy}. This prompt is given to the T5-based models.

To zero-shot prompt GPT, we prepend the following sentence to the input above: \textit{``Derive the final equation using the premise equations from the following prompt (denoted by "Prompt:"). Give only the equations involved in the derivation. Do not include any text other than equations each separated by "and". Prompt: ''}.

\paragraph{Few-shot prompting GPT.} To elicit the behaviour required from the GPT models, which are not limited by the same sequence length restrictions of smaller models, we adapt the prompt to increase the probability that generation outputs match the format described above, particularly aiming to minimise the inclusion of any natural language. Few-shot learning~\cite{moller2023prompt}, or in-context learning, is a method of enhancing the zero-shot performance of LLMs by including examples in the prompt. In particular, chain-of-thought prompts~\cite{wei2023chainofthought} involve explanations of how results have been obtained from in-context examples, rather than simply including such results without explanation, and can improve generation quality. In our case, where the results themselves \textit{are} equation chains serving as mathematical descriptions, any further chain-of-thought prompting would involve accompanying natural language explanations. Instead of including natural language, as this is something we aim to minimize, we create prompts that contain a variety of training examples.

For each prompt, such as the initial example, a set of 5 example prompts (and derivations) are randomly selected from the set of \textit{synthetic derivations}. Departing from previous work, we select in-context examples by selecting only those containing \textit{more than one premise}, and with no given intermediate equations, to better match the physics prompts. The examples are then fit into the follow few-shot prompt: \newline \indent \textit{The following examples consist of a prompt (denoted by Prompt:) and a mathematical derivation (denoted by Derivation:). Each derivation contains LaTeX equations separated by "and".} \newline \noindent The training prompts are appended after this description, then continues: \newline \indent \textit{Now given the following prompt, generate the derivation. Ensure equations are split by the word "and".} \newline \noindent The evaluation prompt is inserted here, prepended by \textit{``Prompt:''}.

This prompting methodology was chosen to minimize any natural language in the generated output, and to force derivations into the correct output template (LaTeX equations separated by ``and''). Instantiated few-shot prompts are fed to the GPT models through the OpenAI API\footnote{\url{https://platform.openai.com/overview}}, with temperature set to 0 to minimise non-deterministic effects.

\section{Improving Metrics}

\begin{figure}[h!]
    \begin{adjustbox}{minipage=\linewidth,center}
    \hspace*{-0.2cm}   % Adjust this to move the figure to the left
    \includegraphics[width=1\linewidth]{metric.PNG}
    \caption{$M$ (left) represents how reference-based text generation metrics typically calculate similarity scores, \textit{i.e.,} by comparing entire reference (purple) and prediction (blue) derivation sequences. $\mathcal{S}_M$ (right) represents how such metrics can be adapted to compare equations. $M_+$ is a version of $M$ adapted to include additional equation-level scoring functions, and $\alpha$ is a padding element.}
    \label{fig:metric_diagram}
    \end{adjustbox}
\end{figure}

In the context of equation derivations, text generation metrics fail to penalise both fine-grained and larger-scale errors. On the lower end of the granularity spectrum, an incorrectly placed bracket can greatly alter the meaning of an equation. On the upper end, repeating an equation unnecessarily makes a derivation too verbose at best, and at worst, the repeat may be written in place of more crucial results. Without extensive expert analysis of which errors should be prioritised over others, or a standard approach to parsing any given derivation (\textit{e.g.,} in LaTeX) into forms interpretable by symbolic engines to determine their validity, many of these errors are difficult to account for.

A simple method of enhancing current metrics involves \textit{reducing the granularity scale at which they operate}. Typically, reference-based metrics give a similarity score between two overall sequences. In our case, this sequence comprises of equations artificially forced into some linearised template, where the identification of equation spans within sequences is trivial. Rather than calculate similarity scores between two derivations, we instead calculate scores \textit{between equations}, and average equation-level scores over the sequence, this is described in Fig.~\ref{fig:metric_diagram}. 

In the enhanced metric $\mathcal{S}_M$, the original metric $M$ is applied to consecutive pairs of equations in the reference and prediction derivations. $M$ can now be easily adapted to account for various equation-level errors that should negatively impact the score, denoted by $M_+$. In our current work, we check for missing equality (and inequality) symbols, the presence of imbalanced brackets as a basic ``syntax'' check, and redundant equations where the LHS is an exact match of the RHS. These equation-level checks are illustrative examples, but research~\cite{meadows2023generating} suggests these are common errors present in LLM-generated derivations. If any equations fail the checks they obtain a null score, but these scores would be variable hyperparameters in more sophisticated designs, that reflects the relative importance of each error.  

Beyond equation-level checks, at the derivation level, to effect how repeated equations are scored, we currently remove exact matches from the sequence. If the reference and generated derivations were previously the same length, this repeated equation has replaced a more valuable result. Removing repeated equations changes the prediction derivation length, and length discrepancies are penalised.

To ensure all equations contribute to the aggregated score, and to penalise length discrepancies between reference and prediction derivations, we include padding elements denoted in Fig.~\ref{fig:metric_diagram} by $\alpha$ (presently defined as empty strings). However, the location of where any $\alpha$ should be inserted in the derivation is not arbitrary. Without affecting the order of the equations, all combinations of where $\alpha$ may be inserted are trialled, with the aim of maximising the averaged $M_+$ score over equation pairs as follows:
\begin{equation}
    \mathcal{S}_M = \underset{c \,\in \, C}{\mathrm{max}} \; \frac{1}{L+D} \sum_{n=1}^{L+D} M_+(R^{(c)}_n, P^{(c)}_n)
\end{equation}
\noindent where $C$ is the set of all trial combinations $c$, the shortest derivation by equation count is $L$, the number of padding elements $\alpha$ is $D$, the equation-level metric is $M_+$, and $R^{(c)}_n$ and $P^{(c)}_n$ are respectively the $n^{th}$ reference and prediction equation pairs in padded derivation pair $c$. The implementation used in the current work is described by Algorithm~\ref{alg:enhanced_metric}, alongside notes for improvement in Appendix~\ref{app:enhanced_metric}. For example, a repeated equation could be replaced by $\alpha$ for stronger penalties. 

\section{Evaluation}

\paragraph{Models.} T5~\cite{raffel2020exploring} is an encoder-decoder transformer where all pretraining objectives are formulated as text generation (and therefore do not require different loss functions). FLAN-T5~\cite{chung2022scaling} is T5 fine-tuned on instructions, and outperforms T5 in a variety of tasks. The GPT models~\cite{brown2020language} are decoder-only transformer-based models trained on massive natural (and mathematical) language corpora. We evaluate 8 models on derivation generation: the base and large variants of T5 and FLAN-T5, ChatGPT, GPT-4, MathT5-base, and MathT5-large~\cite{meadows2023generating}. MathT5-large is a version of FLAN-T5-large fine-tuned for 25 epochs on 15K (LaTeX) synthetic mathematical derivations (containing 4 - 10 equations), that were generated using a symbolic engine. It outperforms the few-shot performance of GPT-4 and ChatGPT on derivation generation in ROUGE, BLEU, BLEURT, and GLEU scores, and shows some generalisation capabilities. It was trained on 155 physics-related symbols, but struggles with out-of-vocabulary symbols. MathT5-base is the equivalent, but uses T5-base as the initialised model before fine-tuning.

\paragraph{Metrics.} The ROUGE metric~\cite{lin2004rouge} evaluates the quality of automatic summarization and machine translation. It measures the quality of a generated summary by comparing it with reference summaries, based on n-gram overlap. The BLEU score~\cite{papineni2002bleu} functions similarly, gauging the proportion of the generated words present in the reference text. It also imposes a penalty for excessively short sentences. GLEU~\cite{mutton2007gleu}, a variant of the BLEU score, evaluates natural language processing tasks by measuring the n-gram overlap between generated and reference sentences, taking into account both precision and recall, and is used in related work~\cite{welleck2022naturalprover}. The improved metric ($\textit{e.g., } \mathcal{S}_{ROUGE}$) is $\mathcal{S}_M$, where $M \in \{\text{ROUGE}, \text{BLEU}, \text{GLEU}\}$. 

\iffalse
{\renewcommand{\arraystretch}{1.2}%
\begin{table}[h!]
	\centering
	\scalebox{0.62}{
		\begin{tabular}{@{}l|l|c|c|c|c|c|c|c|c|c|c|c|c@{}}
			&  \multicolumn{3}{c|}{\textbf{ROUGE}} & \multicolumn{3}{c|}{\textbf{BLEU}} & \multicolumn{3}{c|}{\textbf{GLEU}}\\
			\hline
			& \textbf{All} & \textbf{P1} & \textbf{P2} & \textbf{All} & \textbf{P1} & \textbf{P2} & \textbf{All} & \textbf{P1} & \textbf{P2} \\
			\hline
			MathT5-base & 69.5 & 64.1 & 56.4 & 58.5 & 55.1 & 49.0 & 59.9 & 56.7 & 51.3\\
            MathT5-large & 69.1 & 64.4 & 55.7 & 60.6 & 56.4 & 46.8 & 62.1 & 58.1 & 49.9\\
            ChatGPT & 77.7 & 75.8 & 60.2 & 68.7 & 65.6 & 44.4 & 70.5 & 68.4 & 51.5\\
            GPT-4 & 85.6 & 81.0 & 70.5 & 79.7 & 73.8 & 58.9 & 80.6 & 75.7 & 63.5\\
            
		\end{tabular}
		}
	\caption{\textbf{All} represents scores for derivations with more than 3 premises. \textbf{P1} are scores after removing 1 premise. \textbf{P2} are scores after removing 2 premises.} 
    \label{tab:perturbation_scores}
\end{table}}
\fi

\subsection{Results}

{\renewcommand{\arraystretch}{1}%
\begin{table*}[h!]
\centering
\scalebox{0.95}{
\begin{tabular}{@{}l|c|c|c|c|c|c|c @{}}
& \textbf{ROUGE} & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textbf{BLEU} & $\mathbf{\mathcal{S}_{BLEU}}$ & \textbf{GLEU} & $\mathbf{\mathcal{S}_{GLEU}}$ \\
\hline
T5-base & 13.6 & 3.4 & 1.8 & 1.3 & 7.2 & 2.9\\
T5-large & 9.5 & 1.7 & 1.0 & 0.6 & 5.0 & 1.6\\
FLAN-T5-base & 9.2 & 2.6 & 2.7 & 1.2 & 6.4 & 2.4\\
FLAN-T5-large & 7.0 & 1.4 & 0.6 & 0.4 & 3.5 & 1.0\\
MathT5-base & 70.6 & 34.4 & 58.6 & 33.1 & 60.7 & 34.1\\
MathT5-large & 69.6 & 34.9 & 60.2 & 33.4 & 62.1 & 34.7\\
ChatGPT \textit{(ZS)} & 56.8 & 9.3 & 48.3 & 8.6 & 51.3 & 8.9\\
ChatGPT & 77.7 & 66.1 & 67.3 & 65.1 & 70.3 & 66.3\\
GPT-4 \textit{(ZS)} & 77.1 & 61.2 & 60.3 & 60.1 & 66.4 & 61.1\\
GPT-4 & \textbf{84.3} & \textbf{73.7} & \textbf{78.0} & \textbf{72.3} & \textbf{79.1} & \textbf{73.6}
\end{tabular}
}
\caption{Evaluation results for derivation generation with the physics dataset. \textit{(ZS)} refers to zero-shot performance. Otherwise, all T5 results are zero-shot, and GPT results are few-shot.}
\label{tab:main_scores}
\end{table*}}

{\renewcommand{\arraystretch}{1}%
\begin{table*}[h!]
\centering
\scalebox{0.9}{
\begin{tabular}{@{}l|c|c|c|c|c|c|c|c @{}}
& \textbf{Field} & \textbf{ROUGE} & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textbf{BLEU} & $\mathbf{\mathcal{S}_{BLEU}}$ & \textbf{GLEU} & $\mathbf{\mathcal{S}_{GLEU}}$ \\
\hline
\multirow{3}{*}{MathT5-base} & \textit{EM} & 75.9 & 39.1 & 64.8 & 38.6 & 66.3 & 39.0\\
& \textit{QM} & 68.4 & 32.7 & 55.7 & 30.7 & 58.2 & 31.6\\
& \textit{Other} & 63.2 & 27.3 & 50.6 & 26.0 & 52.9 & 28.2\\
\hline
\multirow{3}{*}{MathT5-large} & \textit{EM} & 75.1 & 39.3 & 67.9 & 37.9 & 69.1 & 39.1\\
& \textit{QM} & 67.9 & 34.4 & 57.3 & 32.8 & 59.2 & 33.8\\
& \textit{Other} & 60.0 & 25.0 & 48.6 & 23.7 & 52.3 & 26.1\\
\hline
\multirow{3}{*}{ChatGPT} & \textit{EM} & 82.7 & 71.7 & 71.1 & 71.1 & 75.3 & 71.6\\
& \textit{QM} & 76.7 & 64.3 & 66.7 & 63.8 & 69.1 & 64.6\\
& \textit{Other} & 67.6 & 57.0 & 59.1 & 53.3 & 61.1 & 57.3\\
\hline
\multirow{3}{*}{GPT-4} & \textit{EM} & 86.4 & 76.5 & 81.0 & 75.7 & 81.8 & 76.4\\
& \textit{QM} & 83.6 & 72.6 & 77.8 & 71.6 & 78.9 & 72.6\\
& \textit{Other} & 81.0 & 69.8 & 70.9 & 65.8 & 73.0 & 69.1\\
\end{tabular}
}
\caption{Derivation generation results by field of physics. \textit{EM} is electromagnetism, \textit{QM} is quantum mechanics, and \textit{Other} contains derivations from classical and statistical mechanics.}
\label{tab:fields_scores}
\end{table*}}

\paragraph{Few-shot GPT dominates across all metrics.} Our few-shot approach used to prompt the GPT models does not use physics derivations, and therefore \textit{does not learn any author biases present in the physics data}. Instead, synthetic derivations are included in prompts that demonstrate the required granularity between steps, while helping to force model output into the required template. In-context learning significantly improves performance over zero-shot prompting, and notably, few-shot ChatGPT outperforms zero-shot GPT-4 across all metrics in Tab.~\ref{tab:main_scores}.

\paragraph{MathT5 outperforms zero-shot ChatGPT and all T5 models.} The MathT5 models both perform similarly, and are outperformed only by GPT-4 in zero-shot performance. The advantage over ChatGPT is surprising, because we evaluate on significantly out-of-distribution derivations (\textit{e.g.,} Fig.~\ref{fig:length_distribution} and \ref{fig:premise_distribution}), and ChatGPT contains $1000$x the parameter count of MathT5-base. Despite known mathematical limitations of ChatGPT~\cite{frieder2023mathematical}, this discrepancy likely comes from its inability to output derivations in the required format (where it frequently includes natural language and verbose derivations), rather than any inherent mathematical knowledge possessed by MathT5.

\paragraph{Models agree on the relative difficulty of physics domains.} The physics dataset is divided into electromagnetism (EM), quantum mechanics (QM), and Other (Tab.~\ref{tab:sizes}). Across all models and metrics, \textit{electromagnetism is easier than quantum, which is easier than ``other''} (Tab.~\ref{tab:fields_scores}). This is not a reflection of the fields themselves, but reflects the samples we include in each category, and \textit{how} we derive results. For example, in Other, many of the derivations are generally easier (\textit{e.g.,} \ref{app:other}.16). However, some premises are included for \textit{physical context} (\textit{e.g.,} Euler-Lagrange, Eq. (1004, 1017) etc.), and do not directly contribute to an operationally self-contained derivation. This deviates from the training data of MathT5 and the few-shot GPT examples, where clearly defined operations are applied to all premises. 

\paragraph{Improved metrics unify scores.} The original metrics significantly disagree -- both in numerical value and model ranking~\cite{meadows2023generating}. For example, it is not unanimous from Tab.~\ref{tab:main_scores} that MathT5-large outperforms MathT5-base, and the ROUGE score of the latter is \textit{12 points greater} than its BLEU score. After applying $\mathcal{S}_M$, the ranking is unanimous, and \textit{scores agree to within 1 point}.

\paragraph{Improved metrics disproportionately penalise models.} Some models are more severely impacted by metric improvements. For example, ChatGPT \textit{(ZS)} loses 40 points compared to original scores, while ChatGPT loses up to 10 points. Related discrepancies can partially be explained by model output not matching the template assumed by $\mathcal{S}_M$. However, MathT5 suffers significant losses (30 points) and certainly follows the template, while GPT-4 relatively maintains its scores. This decrease suggests that the \textit{improved metrics are detecting and penalising previously undetected errors}.

\subsection{Errors}

{\renewcommand{\arraystretch}{0.9}%
\begin{table*}[h!]
	\centering
	\scalebox{1}{
		\begin{tabular}{@{}l|c|c|c|c|c|c @{}}
			& \textbf{Syntax} & \textbf{Equality} & \textbf{Repeated} & \textbf{Redundant} & \textbf{Skipped steps} & \textbf{Verbose}\\
			\hline
            MathT5-base & 503 & 24 & 145 & 19 & 77 & 68\\
            MathT5-large & 452 & 30 & 82 & 28 & 60 & 70\\
            ChatGPT & 6 & 3 & 243 & 4 & 78 & 62\\
            GPT-4 \textit{(ZS)} & 0 & 0 & 1 & 0 & 156 & 5\\
            GPT-4 & 0 & 0 & 0 & 1 & 57 & 52
		\end{tabular}
		}
	\caption{Error counts for specific equation-level and derivation-level categories. \textbf{Syntax} refers to the number of equations with unbalanced brackets. \textbf{Equality} counts the number of equations without equality (or inequality) symbols. \textbf{Repeated} is the number of derivations with repeating equations. \textbf{Redundant} is the number of equations where the LHS exactly matches the RHS. \textbf{Skipped steps} and \textbf{Verbose} respectively count the number of prediction derivations that contain less or more equations than the references.}
	\label{tab:error_counts}
\end{table*}}

We count derivation errors made by models in Tab.~\ref{tab:error_counts} by identifying equations via the output template (\textit{i.e.,} ``and'' separated equations), and perform equation-level and derivation-level error checks of the kind $\mathcal{S}_M$ may effect. Therefore, we only include models that understand the output template. Tab.~\ref{tab:detailed_error_counts} describes the errors present in the top $1/3$ derivations by metric scores. 

\paragraph{Improved metrics reduce error counts in high ranking derivations.} A metric that more suitably accounts for fine-grained errors, should feature less such errors in high ranking derivations. MathT5 are the only (included) models that produce syntax errors in the top derivations, and $\mathcal{S}_M$ reduces this by a factor of $1/3$. Notably, this does not come at the cost of significantly greater error counts in other categories, and the number of repeated, redundant, and equality errors generally decreases. For models without syntax errors, the number of repeating errors generally decreases.

\paragraph{Improved metrics do not reduce all errors.} $\mathcal{S}_M$ does not generally reduce the presence of skipped steps or verbose derivations in the top $1/3$. For example, ChatGPT's top derivations by $\mathcal{S}_{\text{GLEU}}$ both contain more skipped steps and verbosity, \textit{and an additional redundant equation}, resulting in a higher error rate comparative to GLEU. However, we note that length discrepancies are the least impactful error type, as longer or shorter derivations may contain no \textit{reasoning} errors, while a redundant equation is always at least one error.

{\renewcommand{\arraystretch}{1}%
\begin{table*}[h!]
	\centering
	\scalebox{0.9}{
		\begin{tabular}{@{}l|l|c|c|c|c|c|c @{}}
			& \textbf{Metric} &\textbf{Syntax} & \textbf{Equality} & \textbf{Repeated} & \textbf{Redundant} & \textbf{Skipped steps} & \textbf{Verbose}\\
			\hline
            \multirow{6}{*}{MathT5-base} & ROUGE & 113 & 1 & 22 & 5 & 27 & 11\\
            & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textit{32} & \textit{1} & \textit{27} & \textit{5} & \textit{25} & \textit{15} \\
            \cline{2-8}
            
             & BLEU & 100 & 0 & 30 & 7 & 20 & 14\\
             & $\mathbf{\mathcal{S}_{BLEU}}$ & \textit{38} & \textit{2} & \textit{29} & \textit{5} & \textit{24} & \textit{17} \\
             \cline{2-8}

             & GLEU & 95 & 0 & 28 & 7 & 21 & 13\\
             & $\mathbf{\mathcal{S}_{GLEU}}$ & \textit{38} & \textit{2} & \textit{29} & \textit{5} & \textit{24} & \textit{17} \\
             \hline
             
            \multirow{6}{*}{MathT5-large} & ROUGE & 124 & 7 & 23 & 8 & 17 & 20\\
            & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textit{33} & \textit{0} & \textit{17} & \textit{4} & \textit{24} & \textit{14} \\
            \cline{2-8}

             & BLEU & 107 & 7 & 19 & 9 & 15 & 14\\
             & $\mathbf{\mathcal{S}_{BLEU}}$ & \textit{26} & \textit{0} & \textit{19} & \textit{6} & \textit{24} & \textit{14} \\
             \cline{2-8}

             & GLEU & 108 & 7 & 19 & 9 & 16 & 14\\
            & $\mathbf{\mathcal{S}_{GLEU}}$ & \textit{28} & \textit{1} & \textit{20} & \textit{4} & \textit{23} & \textit{15} \\
             \hline

            \multirow{6}{*}{ChatGPT} & ROUGE & 0 & 0 & 7 & 1 & 23 & 12\\
            & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textit{0} & \textit{0} & \textit{4} & \textit{1} & \textit{20} & \textit{11} \\
            \cline{2-8}

             & BLEU & 0 & 0 & 8 & 1 & 18 & 11\\
             & $\mathbf{\mathcal{S}_{BLEU}}$ & \textit{0} & \textit{0} & \textit{4} & \textit{1} & \textit{23} & \textit{10} \\
             \cline{2-8}

             & GLEU & 0 & 0 & 8 & 0 & 18 & 10\\
             & $\mathbf{\mathcal{S}_{GLEU}}$ & \textit{0} & \textit{0} & \textit{8} & \textit{1} & \textit{19} & \textit{12} \\
             \hline 

            \multirow{6}{*}{GPT-4 \textit{(ZS)}} & ROUGE & 0 & 0 & 0 & 0 & 40 & 0\\
            & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{44} & \textit{0} \\
             \cline{2-8}

              & BLEU & 0 & 0 & 1 & 0 & 35 & 2\\
              & $\mathbf{\mathcal{S}_{BLEU}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{48} & \textit{0} \\
               \cline{2-8}

              & GLEU & 0 & 0 & 1 & 0 & 37 & 0\\
              & $\mathbf{\mathcal{S}_{GLEU}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{47} & \textit{0} \\
              \hline

            \multirow{6}{*}{GPT-4} & ROUGE & 0 & 0 & 0 & 0 & 7 & 7\\
            & $\mathbf{\mathcal{S}_{ROUGE}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{4} & \textit{7} \\
            \cline{2-8}

             & BLEU & 0 & 0 & 0 & 0 & 5 & 6\\
             & $\mathbf{\mathcal{S}_{BLEU}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{5} & \textit{11} \\
             \cline{2-8}

             & GLEU & 0 & 0 & 0 & 0 & 6 & 5\\
             & $\mathbf{\mathcal{S}_{GLEU}}$ & \textit{0} & \textit{0} & \textit{0} & \textit{0} & \textit{4} & \textit{8}\\
             \hline
            
		\end{tabular}
		}
	\caption{Error counts for the top $1/3$ derivations by metric score.}
	\label{tab:detailed_error_counts}
\end{table*}}

\subsection{Does $\mathcal{S}_M$ reward better reasoning?}

There is no explicit ``overall'' reasoning check applied by $\mathcal{S}_M$, and this is very difficult to automate without incorporating a symbolic engine. However, a more sophisticated approach for penalising fine-grained errors may indirectly improve the likelihood that correct overall reasoning is present in top-$n$ derivations. We take the top-$20$ MathT5-base derivations by ROUGE (Appendix~\ref{app:top_metric}), and compare them with that of $\mathcal{S}_{\text{ROUGE}}$ (Appendix~\ref{app:top_new_metric}). MathT5-base scores a high average ROUGE of $71$ and a significantly lower $\mathcal{S}_{ROUGE}$ of $34$. We select this model and metric due to this discrepancy.

We do not compare model reasoning with that of the references, rather, we consider each derivation as a stand-alone argument, and blindly assess its correctness. Examples with any repeating, redundant, or otherwise invalid equations are considered incorrect, while skipping steps or verbosity is allowed (as we do not know the reference).

\paragraph{$\mathcal{S}_M$ reduces LaTeX syntax errors.} To render the ROUGE derivations, a number of syntax errors ($14/20$ equations) had to be manually corrected. For $\mathcal{S}_{\text{ROUGE}}$ this number is significantly reduced ($4/20$).

\paragraph{$\mathcal{S}_M$ may implicitly reward correct derivations.} Of the $20$ derivations considered, \textit{only $2$} are correct in the ROUGE set. This increases to $5$ in the $\mathcal{S}_{\text{ROUGE}}$ set. Given the small sample size we avoid the claim that $\mathcal{S}_M$ is in general more likely to detect correct reasoning, but here it has found more correct examples.


\section{Conclusion}

Using a dataset of fine-grained derivations spanning multiple fields of physics, we evaluate GPT and T5-related models on a derivation generation task in zero-shot and few-shot settings, using canonical reference-based text generation metrics. We introduce a number of improvements to all metrics by reducing the granularity scale within which they are applied, and include reference-free equation-level scoring methods that penalise various reasoning errors. This leads to non-trivial insights condensed into the following points: 


\paragraph{Fine-grained mathematical reasoning is not faithfully delivered by the state-of-the-art.} Even for the short derivations featured in this work, zero-shot prompting LLMs does not reliably return coherent, detailed reasoning, aligning with previous work~\cite{welleck2022naturalprover,frieder2023mathematical,meadows2023generating}. This is especially true if output is required in a particular template for automatic evaluation. Detailed examples contained within few-shot prompts can greatly improve the detail and quality of results, but mathematical correctness is not guaranteed, and we are far from outsourcing theoretical work to current LLMs without significant human verification. 

\paragraph{Reducing the granularity scale of generation metrics could circumvent symbolic verification in the short-term.} In this work, we show how current metrics can give scores that better reflect derivation quality without a symbolic engine. These improvements greatly increase score alignment between metrics, significantly penalise models producing targeted errors, minimally penalise models that do not, reduce error counts in high ranking derivations, and may increase the probability that correct examples obtain higher scores, implicitly rewarding better reasoning. Physicists spend months verifying (LaTeX) equations in papers due to a discrepancy between the granularity communicated in research, and the necessary detail required to confirm results. It would be useful if LLMs could derive \textit{some} intermediate results, or at least make errors that are easier to check (\textit{e.g.,} less LaTeX syntax errors). This gradual and practical improvement of LLMs towards mathematical perfection does not require mathematically complete metrics, but current metrics distinctly fail because they do not detect nor penalise fine-grained errors. For example, MathT5 outperforms zero-shot ChatGPT on physics data presently discussed, and scores high ROUGE (71), yet clearly does not demonstrate the required mathematical capabilities in this context. Gradually improving models using metrics that account for increasingly more detail, could result in LLMs generating reasoning that is ``close enough'', requiring less time to correct by users compared to deriving equations without model assistance. This may increase adoption and accelerate research.




\bibliography{tacl2021}
\bibliographystyle{acl_natbib}

\appendix

\iffalse
{\renewcommand{\arraystretch}{1}%
\begin{table}[h!]
	\centering
	\scalebox{0.82}{
		\begin{tabular}{@{}l|c|c|c|c|c|c @{}}
			& Static & VR & EE & AG & SR & Average\\
			\hline
            ROUGE & $0.5$ & $-0.5$ & $-0.5$ & $0.5$ & $0.5$ & $0.1$\\
            BLEU & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $0.5$ & $-0.1$\\
            BLEURT & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $-0.3$\\
            GLEU & $0.5$ & $0.5$ & $-0.5$ & $0.5$ & $-0.5$ & $0.1$\\
            XGB & $0.5$ & $-0.5$ & $1.0$ & $0.5$ & $0.5$ & $\mathbf{0.4}$\\
             ROUGE+ & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $0.5$ & $-0.1$\\
             BLEU+ & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $0.5$ & $-0.1$\\
             GLEU+ & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $0.5$ & $-0.1$\\
		\end{tabular}
		}
	\caption{\textbf{Model performance rankings.} Spearman's ranking coefficients calculated by comparing metric-based rankings to manual rankings, based on the conventional performance of FLAN-T5-large, GPT-4, and ChatGPT, from Table~\ref{tab:detailed_rankings}.}
	\label{tab:spearman_performance}
\end{table}}

{\renewcommand{\arraystretch}{1}%
\begin{table}[h!]
	\centering
	\scalebox{0.9}{
		\begin{tabular}{@{}l|c|c|c|c|c @{}}
			& VR & EE & AG & SR & Average\\
			\hline
            ROUGE & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $-0.3$\\
            BLEU & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $-0.3$\\
            BLEURT & $0.5$ & $1.0$ & $0.5$ & $-0.5$ & $\mathbf{0.4}$\\
            GLEU & $0.5$ & $-0.5$ & $-0.5$ & $-0.5$ & $-0.3$\\
            XGB & $1.0$ & $1.0$ & $0.5$ & $-1.0$ & $\mathbf{0.4}$\\
            ROUGE+ & $1.0$ & $0.5$ & $-1.0$ & $-0.5$ & $0.0$\\
            BLEU+ & $1.0$ & $0.5$ & $-1.0$ & $-0.5$ & $0.0$\\
            GLEU+ & $1.0$ & $0.5$ & $-1.0$ & $-0.5$ & $0.0$\\
            
		\end{tabular}
		}
	\caption{\textbf{Model generalisation rankings}. Spearman coefficients show how accurately each metric ranks \textit{each model's generalisation to a given perturbation}, measured by a performance drop from the static scores (such as Table~\ref{tab:performance_difference}), calculated from Table~\ref{tab:difference_rankings}.}
	\label{tab:spearman_model_difficulty}
\end{table}}

{\renewcommand{\arraystretch}{1}%
\begin{table}[h!]
	\centering
	\scalebox{0.9}{
		\begin{tabular}{@{}l|c|c|c|c @{}}
			 & FLAN-T5 & GPT-4 & ChatGPT & Average\\
			\hline
            ROUGE & $0.4$ & $0.8$ & $0.4$ & $0.5$\\
            BLEU & $0.4$ & $0.8$ & $0.6$ & $0.6$\\
            BLEURT & $0.2$ & $0.8$ & $0.8$ & $0.6$\\
            GLEU & $0.6$ & $0.8$ & $0.6$ & $\mathbf{0.7}$\\
            XGB & $0.4$ & $-0.3$ & $-0.2$ & $0.0$\\
            ROUGE+ & $0.4$ & $0.8$ & $0.8$ & $\mathbf{0.7}$\\
            BLEU+ & $0.4$ & $0.8$ & $0.8$ & $\mathbf{0.7}$\\
            GLEU+ & $0.4$ & $0.8$ & $0.8$ & $\mathbf{0.7}$\\
		\end{tabular}
		}
	\caption{\textbf{Perturbation generalisation rankings.} Spearman coefficients show how accurately each metric ranks \textit{model generalisation to each perturbation}, measured by a performance drop from the static scores, calculated from Table~\ref{tab:difference_rankings}.}
	\label{tab:spearman_pert_difficulty}
\end{table}}

{\renewcommand{\arraystretch}{1}%
\begin{table*}[h!]
	\centering
	\scalebox{0.6}{
		\begin{tabular}{c|c|c|c|c|c|c|c|c|c| c |c|c|c}
			Perturbation & Model & Incorrect eqs & Repeating eqs & Redundant eqs & Manual rank & ROUGE & BLEU & BLEURT & GLEU & XGB & ROUGE+ & BLEU+ & GLEU+\\
			\hline
                \multirow{3}{*}{Static} & FLAN-T5 & 2 & 0 & 0 & 2 & 92 & 86 & 76 & 87 & 77 & 89.3 & 89.5 & 89.5\\
                & GPT-4 & 0 & 0 & 0 & 1 & 84 & 73 & 65 & 76 & 55 & 77.2 & 75.9 & 76.4\\
                & ChatGPT & 2 & 2 & 0 & 3 & 79 & 69 & 64 & 72 & 47 & 70.5 & 69.6 & 70.2\\
                \hline
                \multirow{3}{*}{VR} & FLAN-T5 & 6 & 2 & 1 & 3 & 85 & 77 & 75 & 78 & 55 & 78.4 & 77.6 & 77.7\\
                & GPT-4 & 0 & 0 & 0 & 1 & 85 & 77 & 70 & 80 & 53 & 77.5 & 77.0 & 77.6\\
                & ChatGPT & 4 & 1 & 1 & 2 & 81 & 75 & 70 & 76 & 41 & 69.6 & 70.4 & 71.0\\
                \hline
                \multirow{3}{*}{EE} & FLAN-T5 & 5 & 3 & 2 & 3 & 90 & 85 & 73 & 85 & 19 & 81.3 & 79.1 & 79.6\\
                & GPT-4 & 0 & 0 & 0 & 1 & 84 & 75 & 65 & 78 & 34 & 74.6 & 74.3 & 74.9\\
                & ChatGPT & 4 & 2 & 0 & 2 & 82 & 75 & 62 & 77 & 26 & 70.9 & 70.9 & 71.7\\
                \hline 
                \multirow{3}{*}{AG} & FLAN-T5 & 3 & 1 & 0 & 2 & 94 & 90 & 79 & 91 & 56 & 94.2 & 94.0 & 94.0\\
                & GPT-4 & 0 & 0 & 0 & 1 & 84 & 73 & 66 & 77 & 34 & 75.3 & 74.2 & 74.9\\
                & ChatGPT & 4 & 1 & 0 & 3 & 84 & 78 & 70 & 79 & 22 & 76.7 & 76.5 & 77.1\\
                \hline
                \multirow{3}{*}{SR} & FLAN-T5 & 3 & 1 & 1 & 2 & 85 & 78 & 65 & 79 & 43 & 73.9 & 73.1 & 73.2\\
                & GPT-4 & 3 & 0 & 2 & 1 & 79 & 66 & 54 & 70 & 38 & 65.5 & 63.7 & 64.7\\
                & ChatGPT & 5 & 0 & 2 & 3 & 76 & 66 & 55 & 69 & 26 & 62.3 & 60.3 & 61.1\\ 
		\end{tabular}
		}
	\caption{Values used for calculating Spearman's rank coefficients in Table~\ref{tab:spearman_performance}. Rounded values are not used to make calculations, and are for ease of reading. Incorrect/repeating/redundant eqs represents the number of derivations that include that error (not the total number of errors). A model with highest performance has a manual rank of 1.}
	\label{tab:detailed_rankings}
\end{table*}}

{\renewcommand{\arraystretch}{1}%
\begin{table*}[h!]
	\centering
	\scalebox{0.6}{
		\begin{tabular}{c|c|c|c|c|c|c|c|c|c| c |c|c|c}
			Model & Perturbation & Incorrect eqs & Repeating eqs & Redundant eqs & Manual rank & ROUGE & BLEU & BLEURT & GLEU & XGB & ROUGE+ & BLEU+ & GLEU+ \\
			\hline
                \multirow{4}{*}{FLAN-T5} & VR & 4 & 2 & 1 & 4 & 6.1 & 8.3 & 1.5 & 8.3 & 22.0 & 10.9 & 11.9 & 11.8\\
                & EE & 3 & 3 & 2 & 3 & 1.0 & -0.1 & 2.8 & 0.3 & 57.2 & 8.0 & 10.4 & 9.9\\
                & AG & 1 & 1 & 0 & 1 & -0.4 & -1.5 & -0.5 & -1.3 & 20.6 & -4.9 & -4.5 & -4.5\\
                & SR & 1 & 1 & 1 & 2 & 7.9 & 9.3 & 12.1 & 8.3 & 33.5 & 15.4 & 16.4 & 16.3\\
                \hline
                \multirow{4}{*}{GPT-4} & VR & 0 & 0 & 0 & 1 & 0.8 & 0.3 & -3.6 & 0.4 & 2.2 & -0.3 & -1.1 & -1.2\\
                & EE & 0 & 0 & 0 & 1 & 1.6 & 3.5 & 0.6 & 3.1 & 20.7 & 2.6 & 1.6 & 1.5\\
                & AG & 0 & 0 & 0 & 1 & 1.6 & 4.4 & 0.5 & 3.2 & 20.8 & 1.9 & 1.7 & 1.5\\
                & SR & 3 & 0 & 2 & 4 & 5.8 & 8.0 & 11.5 & 6.3 & 17.4 & 11.7 & 12.2 & 11.7\\
                \hline 
                \multirow{4}{*}{ChatGPT} & VR & 2 & -1 & 1 & 2 & -0.2 & -3.4 & -8.2 & -2.3 & 6.2 & 0.9 & -0.8 & -0.8\\
                & EE & 2 & 0 & 0 & 3 & 0.9 & -0.5 & 1.5 & -0.5 & 21.2 & -0.4 & -1.3 & -1.5\\
                & AG & 2 & -1 & 0 & 1 & 1.1 & -0.5 & 0.6 & -0.5 & 25.0 & -6.2 & -6.9 & -6.9\\
                & SR & 3 & -2 & 2 & 4 & 5.4 & 5.0 & 11.1 & 3.9 & 21.3 & 8.2 & 9.3 & 9.1\\
                
		\end{tabular}
		}
	\caption{Values used for calculating Spearman's rank coefficients in Tables~\ref{tab:spearman_model_difficulty} and \ref{tab:spearman_pert_difficulty}. Incorrect/repeating/redundant eqs represents the number of derivations that include that error in the relevant perturbed derivations, \textit{minus} those from the static derivations. Exactly these values are used in calculations. A model generalises best to a perturbation with a manual rank of 1.}
	\label{tab:difference_rankings}
\end{table*}}
\fi

\bibliography{tacl2021}
\bibliographystyle{acl_natbib}

\section{Electromagnetism}
\label{app:electromagnetism}

\subsection{Gauss' law: equivalence between differential and integral forms}

\begin{equation}
%PREM
    \oiint_S \mathbf{E}\cdot d\mathbf{A} = \frac{Q}{\varepsilon_0}
\end{equation}

\begin{equation}
%PREM
    \oiint_S \mathbf{E}\cdot d\mathbf{A} = \iiint_V \nabla \cdot \mathbf{E} dV
\end{equation}

\begin{equation}
    \iiint_V \nabla \cdot \mathbf{E} dV = \frac{Q}{\varepsilon_0}
\end{equation}

\begin{equation}
%PREM
    Q = \iiint_V \rho dV
\end{equation}

\begin{equation}
    \iiint_V \nabla \cdot \mathbf{E} dV = \iiint_V \frac{\rho}{\varepsilon_0} dV
\end{equation}

\subsection{Gauss' law: equivalence between differential and integral forms 2}

\begin{equation}
%PREM
    \iiint_V \nabla \cdot \mathbf{E} dV = \iiint_V \frac{\rho}{\varepsilon_0} dV
\end{equation}

\begin{equation}
    \iiint_V \nabla \cdot \mathbf{E}dV - \iiint_V\frac{\rho}{\varepsilon_0} dV = 0
\end{equation}

\begin{equation}
    \iiint_V (\nabla \cdot \mathbf{E} - \frac{\rho}{\varepsilon_0}) dV = 0
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E} = \frac{\rho}{\varepsilon_0}
\end{equation}

\subsection{Gauss' law: Equivalence of total and free charge statements}

\begin{equation}
%PREM
    \rho_{b} = -\nabla \cdot \mathbf{P}
\end{equation}

\begin{equation}
%PREM
    \rho_f = \nabla \cdot \mathbf{D}
\end{equation}

\begin{equation}
%PREM
    \rho = \rho_b + \rho_f
\end{equation}

\begin{equation}
    \rho = -\nabla \cdot \mathbf{P} + \nabla \cdot \mathbf{D}
\end{equation}

\begin{equation}
    \rho = \nabla \cdot (\mathbf{D} - \mathbf{P})
\end{equation}

\subsection{Gauss' law: Equivalence of total and free charge statements 2}

\begin{equation}
%PREM
    \mathbf{D} = \varepsilon_0 \mathbf{E} + \mathbf{P}
\end{equation}

\begin{equation}
%PREM
    \rho = \nabla \cdot (\mathbf{D} - \mathbf{P})
\end{equation}

\begin{equation}
    \varepsilon_0 \mathbf{E} = \mathbf{D} - \mathbf{P}
\end{equation}

\begin{equation}
   \rho = \nabla \cdot \varepsilon_0 \mathbf{E}
\end{equation}

\begin{equation}
   \frac{\rho}{\varepsilon_0} = \nabla \cdot \mathbf{E}
\end{equation}

\subsection{Gauss' law: Derivation from Coulomb's law}

\begin{equation}
%PREM
    \mathbf{E}(\mathbf{r}) = \frac{1}{4\pi\varepsilon_0} \int \frac{\rho(\mathbf{s})(\mathbf{r} - \mathbf{s})}{|\mathbf{r} - \mathbf{s}|^3}d^3\mathbf{s}
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \nabla \cdot \frac{1}{4\pi\varepsilon_0} \int \frac{\rho(\mathbf{s})(\mathbf{r} - \mathbf{s})}{|\mathbf{r} - \mathbf{s}|^3}d^3\mathbf{s}
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \frac{1}{4\pi\varepsilon_0} \int \rho(\mathbf{s}) \nabla \cdot \frac{(\mathbf{r} - \mathbf{s})}{|\mathbf{r} - \mathbf{s}|^3}d^3\mathbf{s}
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \frac{(\mathbf{r} - \mathbf{s})}{|\mathbf{r} - \mathbf{s}|^3} = 4 \pi \delta (\mathbf{r} - \mathbf{s})
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \frac{1}{4\pi\varepsilon_0} \int \rho(\mathbf{s}) 4 \pi \delta (\mathbf{r} - \mathbf{s})d^3\mathbf{s}
\end{equation}

\subsection{Gauss' law: Derivation from Coulomb's law 2}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \frac{1}{4\pi\varepsilon_0} \int \rho(\mathbf{s}) 4 \pi \delta (\mathbf{r} - \mathbf{s})d^3\mathbf{s}
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \frac{1}{\varepsilon_0} \int \rho(\mathbf{s}) \delta (\mathbf{r} - \mathbf{s})d^3\mathbf{s}
\end{equation}

\begin{equation}
%PREM
    \int \rho(\mathbf{s}) \delta (\mathbf{r} - \mathbf{s})d^3\mathbf{s} = \rho(\mathbf{r})
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{E}(\mathbf{r}) = \frac{\rho(\mathbf{r})}{\varepsilon_0}
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation}

\begin{equation}
%PREM
    \nabla^2 \phi_1 = -\frac{\rho_f}{\varepsilon_0}
\end{equation}

\begin{equation}
%PREM
    \nabla^2 \phi_2 = -\frac{\rho_f}{\varepsilon_0}
\end{equation}

\begin{equation}
%PREM
    \phi = \phi_2 - \phi_1
\end{equation}

\begin{equation}
    \nabla^2\phi = \nabla^2(\phi_2 - \phi_1)
\end{equation}

\begin{equation}
    \nabla^2\phi = \nabla^2\phi_2 - \nabla^2\phi_1
\end{equation}

\begin{equation}
    \nabla^2\phi = (-\frac{\rho_f}{\varepsilon_0}) - (-\frac{\rho_f}{\varepsilon_0})
\end{equation}

\begin{equation}
    \nabla^2\phi = 0
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 2}

\begin{equation}
%PREM
    \nabla \cdot (\phi\nabla\phi) = (\nabla\phi)^2 + \phi\nabla^2\phi
\end{equation}

\begin{equation}
%PREM
    \nabla^2\phi = 0
\end{equation}

\begin{equation}
    \nabla \cdot (\phi\nabla\phi) = (\nabla\phi)^2
\end{equation}

\begin{equation}
    \int_V \nabla \cdot (\phi\nabla\phi) dV = \int_V (\nabla\phi)^2 dV
\end{equation}

\begin{equation}
%PREM
    \int_V \nabla \cdot (\phi\nabla\phi) dV = \int_S \phi\nabla\phi \cdot d\mathbf{S}
\end{equation}

\begin{equation}
    \int_S \phi\nabla\phi \cdot d\mathbf{S} = \int_V (\nabla\phi)^2 dV
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 3}

\begin{equation}
%PREM
    \int_S \phi\nabla\phi \cdot d\mathbf{S} = \int_V (\nabla\phi)^2 dV
\end{equation}

\begin{equation}
%PREM
    \int_S \phi\nabla\phi \cdot d\mathbf{S} = 0
\end{equation}

\begin{equation}
    \int_V (\nabla\phi)^2 dV = 0
\end{equation}

\begin{equation}
    (\nabla\phi)^2= 0
\end{equation}

\begin{equation}
    \nabla\phi = 0
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 4}

\begin{equation}
%PREM
    \nabla\phi = (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi})
\end{equation}

\begin{equation}
%PREM
    (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi}) \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}


\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}} = (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi}) \cdot \hat{\mathbf{r}}
\end{equation}

\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 5}

\begin{equation}
%PREM
    \nabla\phi = 0
\end{equation}

\begin{equation}
%PREM
    \nabla\phi \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}

\begin{equation}
    0 \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}

\begin{equation}
    0 = \frac{\partial \phi}{\partial r}
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 6}

\begin{equation}
%PREM
    \frac{\partial \phi}{\partial r} = 0
\end{equation}

\begin{equation}
    \int \frac{\partial \phi}{\partial r} dr = \int 0 dr
\end{equation}

\begin{equation}
%PREM
    \int 0 dr = C_1
\end{equation}

\begin{equation}
%PREM
    \int \frac{\partial \phi}{\partial r} dr = \phi + C_2
\end{equation}

\begin{equation}
    \phi + C_2 = C_1
\end{equation}

\begin{equation}
    \phi = C_1 - C_2
\end{equation}

\subsection{Uniqueness theorem for Poisson's equation 7}

\begin{equation}
%PREM
    \phi = C_1 - C_2
\end{equation}

\begin{equation}
%PREM
    C = C_1 - C_2
\end{equation}

\begin{equation}
    \phi = C
\end{equation}

\begin{equation}
%PREM
    \phi = \phi_2 - \phi_1
\end{equation}

\begin{equation}
    \phi_2 - \phi_1 = C
\end{equation}

\subsection{Poisson's equation: Newtonian gravity}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{g} = -4\pi G \rho
\end{equation}

\begin{equation}
%PREM
    \mathbf{g}= -\nabla\phi
\end{equation}

\begin{equation}
    \nabla \cdot (-\nabla\phi) = - 4 \pi G \rho
\end{equation}

\begin{equation}
    \nabla \cdot \nabla\phi = 4 \pi G \rho
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \nabla\phi = \nabla^2\phi
\end{equation}

\begin{equation}
    \nabla^2 \phi = 4\pi G \rho
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation}

\begin{equation}
%PREM
    \nabla^2 \phi = 4\pi G \rho
\end{equation}

\begin{equation}
%PREM
    \nabla^2 \phi = \nabla \cdot \nabla\phi
\end{equation}

\begin{equation}
    \nabla \cdot \nabla\phi = 4\pi G \rho
\end{equation}

\begin{equation}
    \int_V\nabla \cdot \nabla\phi dV = \int_V 4\pi G \rho dV
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 2}

\begin{equation}
%PREM
    \int_V\nabla \cdot \nabla\phi dV = \int_V 4\pi G \rho dV
\end{equation}

\begin{equation}
%PREM
    m = \int_V \rho dV
\end{equation}

\begin{equation}
    \int_V\nabla \cdot \nabla\phi dV = 4\pi G m
\end{equation}

\begin{equation}
%PREM
    \int_V\nabla \cdot \nabla\phi dV = \int_S \nabla\phi \cdot d\mathbf{S}
\end{equation}

\begin{equation}
    \int_S \nabla\phi \cdot d\mathbf{S} = 4\pi G m
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 3}

\begin{equation}
%PREM
    \nabla\phi = (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi})
\end{equation}


\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}} = (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi}) \cdot \hat{\mathbf{r}}
\end{equation}

\begin{equation}
%PREM
    \hat{\mathbf{r}} = (1, 0, 0)
\end{equation}

\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}} = (\frac{\partial \phi}{\partial r}, \frac{1}{r}\frac{\partial \phi}{\partial \theta}, \frac{1}{r \sin \theta}\frac{\partial \phi}{\partial \varphi}) \cdot (1, 0, 0)
\end{equation}

\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 4}

\begin{equation}
%PREM
    \nabla\phi \cdot \hat{\mathbf{r}} = \frac{\partial \phi}{\partial r}
\end{equation}

\begin{equation}
%PREM
    d\mathbf{S} = \hat{\mathbf{r}} dS
\end{equation}

\begin{equation}
    \nabla\phi \cdot d\mathbf{S} = \nabla\phi \cdot \hat{\mathbf{r}} dS
\end{equation}

\begin{equation}
    \nabla\phi \cdot \hat{\mathbf{r}}dS = \frac{\partial \phi}{\partial r}dS
\end{equation}

\begin{equation}
    \nabla\phi \cdot d\mathbf{S} = \frac{\partial \phi}{\partial r}dS
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 5}

\begin{equation}
%PREM
    \nabla\phi \cdot d\mathbf{S} = \frac{\partial \phi}{\partial r}dS
\end{equation}

\begin{equation}
%PREM
    \int_S \nabla\phi \cdot d\mathbf{S} = 4\pi G m
\end{equation}

\begin{equation}
    \int_S\nabla\phi \cdot d\mathbf{S} = \int_S\frac{\partial \phi}{\partial r}dS
\end{equation}

\begin{equation}
    \int_S \frac{\partial \phi}{\partial r} dS = 4\pi G m
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 6}

\begin{equation}
%PREM
    \int_S \frac{\partial \phi}{\partial r} dS = 
    \int_0^{2\pi}\int_0^\pi \frac{\partial \phi}{\partial r} r^2 \sin\theta d\theta d\varphi
\end{equation}

\begin{equation}
%PREM
    \int_0^\pi \sin\theta d\theta = 2
\end{equation}

\begin{equation}
    \int_S \frac{\partial \phi}{\partial r} dS = 
    2 \int_0^{2\pi} \frac{\partial \phi}{\partial r} r^2 d\varphi
\end{equation}

\begin{equation}
%PREM
    \int_0^{2\pi} d\varphi = 2\pi
\end{equation}

\begin{equation}
    \int_S \frac{\partial \phi}{\partial r} dS = 
    4 \pi \frac{\partial \phi}{\partial r} r^2
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 7}

\begin{equation}
%PREM
    \int_S \frac{\partial \phi}{\partial r} dS = 
    4 \pi \frac{\partial \phi}{\partial r} r^2
\end{equation}

\begin{equation}
%PREM
    \int_S \frac{\partial \phi}{\partial r} dS = 4\pi G m
\end{equation}

\begin{equation}
    4 \pi \frac{\partial \phi}{\partial r} r^2 = 4\pi G m
\end{equation}

\begin{equation}
    \frac{\partial \phi}{\partial r} = \frac{G m}{r^2}
\end{equation}

\subsection{Poisson's equation: Gravitational potential from Poisson's equation 8}

\begin{equation}
%PREM
    \frac{\partial \phi}{\partial r} = \frac{G m}{r^2}
\end{equation}

\begin{equation}
    \int_{\infty}^r\frac{\partial \phi}{\partial r}dr = \int_{\infty}^r\frac{G m}{r^2}dr
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r\frac{\partial \phi}{\partial r}dr = \phi(r) - \phi(\infty)
\end{equation}

\begin{equation}
    \phi(r) - \phi(\infty) = \int_{\infty}^r\frac{G m}{r^2}dr
\end{equation}

\begin{equation}
%PREM
\int_{\infty}^r\frac{G m}{r^2}dr = \frac{-Gm}{r}
\end{equation}

\begin{equation}
    \phi(r) - \phi(\infty) = \frac{-Gm}{r}
\end{equation}

\begin{equation}
%PREM
    \phi(\infty) = 0
\end{equation}

\begin{equation}
    \phi(r) = \frac{-Gm}{r}
\end{equation}

\subsection{Poisson's equation: Electrostatics}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{D} = \rho_f
\end{equation}

\begin{equation}
%PREM
    \mathbf{D}= \varepsilon\mathbf{E}
\end{equation}

\begin{equation}
    \nabla \cdot \varepsilon\mathbf{E} = \rho_f
\end{equation}

\begin{equation}
%PREM
    \mathbf{E} = -\nabla\phi
\end{equation}

\begin{equation}
    \nabla \cdot \varepsilon(-\nabla\phi) = \rho_f
\end{equation}

\begin{equation}
    \nabla \cdot \nabla\phi = -\frac{\rho_f}{\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \nabla\phi = \nabla^2\phi
\end{equation}

\begin{equation}
    \nabla^2\phi = -\frac{\rho_f}{\varepsilon}
\end{equation}

\subsection{Poisson's equation: Electrostatic potential from Poisson's equation}

\begin{equation}
%PREM
    \nabla^2 \phi = -\frac{\rho_f}{\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \nabla^2 \phi = \nabla \cdot \nabla\phi
\end{equation}

\begin{equation}
    \nabla \cdot \nabla\phi = -\frac{\rho_f}{\varepsilon}
\end{equation}

\begin{equation}
    \int_V\nabla \cdot \nabla\phi dV = \int_V -\frac{\rho_f}{\varepsilon} dV
\end{equation}

\begin{equation}
%PREM
    Q = \int_V \rho_f dV
\end{equation}

\begin{equation}
    \int_V\nabla \cdot \nabla\phi dV = -\frac{Q}{\varepsilon}
\end{equation}

\subsection{Poisson's equation: Electrostatic potential from Poisson's equation 2}

\begin{equation}
%PREM
    \int_V\nabla \cdot \nabla\phi dV = -\frac{Q}{\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \int_V\nabla \cdot \nabla\phi dV = \int_S \nabla\phi \cdot d\mathbf{S}
\end{equation}

\begin{equation}
    \int_S \nabla\phi \cdot d\mathbf{S} = -\frac{Q}{\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \nabla\phi \cdot d\mathbf{S} = \frac{\partial \phi}{\partial r}dS
\end{equation}

\begin{equation}
    \int_S\nabla\phi \cdot d\mathbf{S} = \int_S\frac{\partial \phi}{\partial r}dS
\end{equation}

\begin{equation}
    \int_S \frac{\partial \phi}{\partial r} dS = -\frac{Q}{\varepsilon}
\end{equation}

\subsection{Poisson's equation: Electrostatic potential from Poisson's equation 3}

\begin{equation}
%PREM
    \int_S \frac{\partial \phi}{\partial r} dS = -\frac{Q}{\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \int_S \frac{\partial \phi}{\partial r} dS = 
    4 \pi \frac{\partial \phi}{\partial r} r^2
\end{equation}

\begin{equation}
    4 \pi \frac{\partial \phi}{\partial r} r^2 = -\frac{Q}{\varepsilon}
\end{equation}

\begin{equation}
    \frac{\partial \phi}{\partial r} = -\frac{Q}{4\pi\varepsilon r^2}
\end{equation}

\begin{equation}
    \int_{\infty}^r\frac{\partial \phi}{\partial r}dr = \int_{\infty}^r-\frac{Q}{4\pi\varepsilon r^2}dr
\end{equation}

\subsection{Poisson's equation: Electrostatic potential from Poisson's equation 4}

\begin{equation}
%PREM
    \int_{\infty}^r\frac{\partial \phi}{\partial r}dr = \int_{\infty}^r-\frac{Q}{4\pi\varepsilon r^2}dr
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r\frac{\partial \phi}{\partial r}dr = \phi(r) - \phi(\infty)
\end{equation}

\begin{equation}
    \phi(r) - \phi(\infty) = \int_{\infty}^r-\frac{Q}{4\pi\varepsilon r^2}dr
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r-\frac{Q}{4\pi\varepsilon r^2}dr = \frac{Q}{4\pi\varepsilon r}
\end{equation}

\begin{equation}
    \phi(r) - \phi(\infty) = \frac{Q}{4\pi\varepsilon r}
\end{equation}

\begin{equation}
%PREM
    \phi(\infty) = 0
\end{equation}

\begin{equation}
    \phi(r) = \frac{Q}{4\pi\varepsilon r}
\end{equation}

\subsection{Lorentz force: continuous charge distribution}

\begin{equation}
%PREM
    \frac{d\mathbf{F}}{dV} = \frac{dq}{dV}(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\end{equation}

\begin{equation}
%PREM
    \mathbf{f} = \frac{d\mathbf{F}}{dV}
\end{equation}

\begin{equation}
%PREM
    \rho = \frac{dq}{dV}
\end{equation}

\begin{equation}
    \mathbf{f} = \rho(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\end{equation}

\begin{equation}
    \mathbf{f} = \rho\mathbf{E} + \rho\mathbf{v} \times \mathbf{B}
\end{equation}

\subsection{Lorentz force: continuous charge distribution 2}

\begin{equation}
%PREM
    \mathbf{f} = \rho\mathbf{E} + \rho\mathbf{v} \times \mathbf{B}
\end{equation}

\begin{equation}
%PREM
    \mathbf{J} = \rho\mathbf{v}
\end{equation}

\begin{equation}
    \mathbf{f} = \rho\mathbf{E} + \mathbf{J} \times \mathbf{B}
\end{equation}

\begin{equation}
%PREM
    \mathbf{F} = \iiint \frac{d\mathbf{F}}{dV} dV
\end{equation}

\begin{equation}
%PREM
    \mathbf{f} = \frac{d\mathbf{F}}{dV}
\end{equation}

\begin{equation}
    \mathbf{F} = \iiint \mathbf{f} dV
\end{equation}

\begin{equation}
    \mathbf{F} = \iiint(\rho\mathbf{E} + \mathbf{J} \times \mathbf{B})dV
\end{equation}

\subsection{Lorentz force: Lorentz force in terms of potentials}

\begin{equation}
%PREM
    \mathbf{E} = -\nabla \phi - \frac{\partial \mathbf{A}}{\partial t}
\end{equation}

\begin{equation}
%PREM
    \mathbf{B} = \nabla \times \mathbf{A}
\end{equation}

\begin{equation}
%PREM
    \mathbf{F} = q(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla \phi - \frac{\partial \mathbf{A}}{\partial t} + \mathbf{v} \times (\nabla \times \mathbf{A}))
\end{equation}

\begin{equation}
%PREM
    \mathbf{v} \times (\nabla \times \mathbf{A}) = \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A}
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla \phi - \frac{\partial \mathbf{A}}{\partial t} + \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A})
\end{equation}

\subsection{Lorentz force: Lorentz force in terms of potentials 2}

\begin{equation}
%PREM
    \frac{d\mathbf{A}}{dt} = \frac{\partial\mathbf{A}}{\partial t} + (\mathbf{v}\cdot\nabla)\mathbf{A}
\end{equation}

\begin{equation}
    \frac{\partial\mathbf{A}}{\partial t} = \frac{d\mathbf{A}}{dt} - (\mathbf{v}\cdot\nabla)\mathbf{A}
\end{equation}

\begin{equation}
%PREM
    \mathbf{F} = q(-\nabla \phi - \frac{\partial \mathbf{A}}{\partial t} + \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A})
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla \phi -  (\frac{d\mathbf{A}}{dt} - (\mathbf{v}\cdot\nabla)\mathbf{A}) + \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A})
\end{equation}

\subsection{Lorentz force: Lorentz force in terms of potentials 3}

\begin{equation}
%PREM
    \mathbf{F} = q(-\nabla \phi -  (\frac{d\mathbf{A}}{dt} - (\mathbf{v}\cdot\nabla)\mathbf{A}) + \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A})
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla \phi -  \frac{d\mathbf{A}}{dt} + (\mathbf{v}\cdot\nabla)\mathbf{A} + \nabla(\mathbf{v}\cdot\mathbf{A}) - (\mathbf{v}\cdot\nabla)\mathbf{A})
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla \phi -  \frac{d\mathbf{A}}{dt} + \nabla(\mathbf{v}\cdot\mathbf{A}))
\end{equation}

\begin{equation}
%PREM
    -\nabla \phi + \nabla(\mathbf{v}\cdot\mathbf{A}) = -\nabla(\phi - \mathbf{v}\cdot\mathbf{A})
\end{equation}

\begin{equation}
    \mathbf{F} = q(-\nabla(\phi - \mathbf{v}\cdot\mathbf{A}) -  \frac{d\mathbf{A}}{dt})
\end{equation}

\subsection{Lorentz force: Potential energy derivation from scalar potential}

\begin{equation}
%PREM
    \mathbf{F} = -q\nabla\phi
\end{equation}

\begin{equation}
%PREM
    U = -\int_{\infty}^r\mathbf{F}\cdot d\mathbf{r}
\end{equation}

\begin{equation}
    U = -\int_{\infty}^r -q\nabla\phi \cdot d\mathbf{r}
\end{equation}

\begin{equation}
    U = q\int_{\infty}^r \nabla\phi \cdot d\mathbf{r}
\end{equation}

\subsection{Lorentz force: Potential energy derivation from scalar potential 2}

\begin{equation}
%PREM
    d\mathbf{r} = \hat{\mathbf{r}} dr
\end{equation}

\begin{equation}
    \nabla\phi \cdot d\mathbf{r} = \nabla\phi \cdot \hat{\mathbf{r}} dr
\end{equation}

\begin{equation}
    \int_{\infty}^r\nabla\phi \cdot d\mathbf{r} = \int_{\infty}^r\nabla\phi \cdot \hat{\mathbf{r}} dr
\end{equation}

\begin{equation}
%PREM
    \nabla\phi \cdot \hat{\mathbf{r}} = \frac{\partial\phi}{\partial r}
\end{equation}

\begin{equation}
    \int_{\infty}^{r}\nabla\phi \cdot \hat{\mathbf{r}}dr = \int_{\infty}^{r} \frac{\partial\phi}{\partial r}dr
\end{equation}

\begin{equation}
    \int_{\infty}^r\nabla\phi \cdot d\mathbf{r} = \int_{\infty}^r\frac{\partial\phi}{\partial r} dr
\end{equation}

\subsection{Lorentz force: Potential energy derivation from scalar potential 3}

\begin{equation}
%PREM
    U = q\int_{\infty}^r \nabla\phi \cdot d\mathbf{r}
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r\nabla\phi \cdot d\mathbf{r} = \int_{\infty}^r\frac{\partial\phi}{\partial r} dr
\end{equation}

\begin{equation}
    U = q\int_{\infty}^r\frac{\partial\phi}{\partial r} dr
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r\frac{\partial\phi}{\partial r} dr = \phi(r) - \phi(\infty)
\end{equation}

\begin{equation}
%PREM
    \phi(\infty) = 0
\end{equation}

\begin{equation}
    \int_{\infty}^r\frac{\partial\phi}{\partial r} dr = \phi(r)
\end{equation}

\begin{equation}
    U = q\phi(r)
\end{equation}

\subsection{Laplace equation: Analytic functions (u)}

\begin{equation}
%PREM
    \frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial x}(\frac{\partial u}{\partial x}) = \frac{\partial}{\partial x}(\frac{\partial v}{\partial y})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial x}(\frac{\partial u}{\partial x}) = \frac{\partial^2 u}{\partial x^2}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial x}(\frac{\partial v}{\partial y}) = \frac{\partial^2 u}{\partial x^2}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial x}(\frac{\partial v}{\partial y}) = \frac{\partial^2 v}{\partial x \partial y}
\end{equation}

\begin{equation}
    \frac{\partial^2 u}{\partial x^2} = \frac{\partial^2 v}{\partial x \partial y}
\end{equation}


\subsection{Laplace equation: Analytic functions (u) 2}

\begin{equation}
%PREM
    \frac{\partial v}{\partial x} = -\frac{\partial u}{\partial y}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial y}(\frac{\partial u}{\partial y}) = \frac{\partial}{\partial y}(-\frac{\partial v}{\partial x})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 u}{\partial y^2} = \frac{\partial}{\partial y}(\frac{\partial u}{\partial y})
\end{equation}

\begin{equation}
    \frac{\partial^2 u}{\partial y^2} = \frac{\partial}{\partial y}(-\frac{\partial v}{\partial x})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial y}(\frac{\partial v}{\partial x}) = \frac{\partial^2 v}{\partial y \partial x}
\end{equation}

\begin{equation}
    \frac{\partial^2 u}{\partial y^2} = - \frac{\partial^2 v}{\partial y \partial x}
\end{equation}

\subsection{Laplace equation: Analytic functions (u) 3}

\begin{equation}
%PREM
    \frac{\partial^2 u}{\partial x^2} = \frac{\partial^2 v}{\partial x \partial y}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 u}{\partial y^2} = - \frac{\partial^2 v}{\partial y \partial x}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 v}{\partial x \partial y} = \frac{\partial^2 v}{\partial y \partial x}
\end{equation}

\begin{equation}
    \frac{\partial^2 u}{\partial y^2} = - \frac{\partial^2 u}{\partial x^2}
\end{equation}

\begin{equation}
    \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} = 0 
\end{equation}

\begin{equation}
%PREM
    \nabla^2 u = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}
\end{equation}

\begin{equation}
    \nabla^2 u = 0
\end{equation}

\subsection{Laplace equation: Analytic functions (v)}

\begin{equation}
%PREM
    \frac{\partial v}{\partial x} = -\frac{\partial u}{\partial y}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial x}(\frac{\partial v}{\partial x}) = \frac{\partial}{\partial x}(-\frac{\partial u}{\partial y})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial x}(\frac{\partial v}{\partial x}) = \frac{\partial^2 v}{\partial x^2} 
\end{equation}

\begin{equation}
    \frac{\partial}{\partial x}(-\frac{\partial u}{\partial y}) = \frac{\partial^2 v}{\partial x^2}
\end{equation}

\begin{equation}
%PREM
      \frac{\partial}{\partial x}(\frac{\partial u}{\partial y}) = \frac{\partial^2 u}{\partial x \partial y}
\end{equation}

\begin{equation}
    \frac{\partial^2 v}{\partial x^2} = -\frac{\partial^2 u}{\partial x \partial y}
\end{equation}

\subsection{Laplace equation: Analytic functions (v) 2}

\begin{equation}
%PREM
    \frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}
\end{equation}

\begin{equation}
     \frac{\partial}{\partial y}(\frac{\partial u}{\partial x}) = \frac{\partial}{\partial y}(\frac{\partial v}{\partial y})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 v}{\partial y^2} = \frac{\partial}{\partial y}(\frac{\partial v}{\partial y})
\end{equation}

\begin{equation}
    \frac{\partial^2 v}{\partial y^2} = \frac{\partial}{\partial y}(\frac{\partial u}{\partial x})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial y}(\frac{\partial u}{\partial x}) = \frac{\partial^2 u}{\partial y \partial x} 
\end{equation}

\begin{equation}
    \frac{\partial^2 v}{\partial y^2} = \frac{\partial^2 u}{\partial y \partial x} 
\end{equation}

\subsection{Laplace equation: Analytic functions (v) 3}

\begin{equation}
%PREM
    \frac{\partial^2 v}{\partial x^2} = -\frac{\partial^2 u}{\partial x \partial y}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 v}{\partial y^2} = \frac{\partial^2 u}{\partial y \partial x} 
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 u}{\partial x \partial y} = \frac{\partial^2 u}{\partial y \partial x}
\end{equation}

\begin{equation}
    \frac{\partial^2 v}{\partial y^2} = - \frac{\partial^2 v}{\partial x^2}
\end{equation}

\begin{equation}
    \frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2} = 0 
\end{equation}

\begin{equation}
%PREM
    \nabla^2 v = \frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2}
\end{equation}

\begin{equation}
    \nabla^2 v = 0
\end{equation}

\subsection{Laplace equation: Electrostatics}

\begin{equation}
%PREM
    \mathbf{E} = (u, v)
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{E} = \rho
\end{equation}

\begin{equation}
%PREM
    \nabla = (\frac{\partial}{\partial x}, \frac{\partial}{\partial y})
\end{equation}

\begin{equation}
    (\frac{\partial}{\partial x}, \frac{\partial}{\partial y}) \cdot (u, v) = \rho
\end{equation}

\begin{equation}
    (\frac{\partial}{\partial x}, \frac{\partial}{\partial y}) \cdot (u, v) = \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y}
\end{equation}

\begin{equation}
    \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = \rho
\end{equation}

\subsection{Laplace equation: Electrostatics 2}

\begin{equation}
%PREM
    \frac{\partial \phi}{\partial x} = -u
\end{equation}

\begin{equation}
%PREM
    \frac{\partial \phi}{\partial y} = -v
\end{equation}

\begin{equation}
    \frac{\partial u}{\partial x} = -\frac{\partial^2 \phi}{\partial x^2}
\end{equation}

\begin{equation}
    \frac{\partial v}{\partial y} = -\frac{\partial^2 \phi}{\partial y^2}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = \rho
\end{equation}

\begin{equation}
    -\frac{\partial^2 \phi}{\partial x^2} -\frac{\partial^2 \phi}{\partial y^2} = \rho
\end{equation}

\begin{equation}
    \frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} = -\rho
\end{equation}

\subsection{Laplace equation: Electrostatics 3}

\begin{equation}
%PREM
    \nabla^2\phi = \frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} = -\rho
\end{equation}

\begin{equation}
    \nabla^2\phi = -\rho
\end{equation}

\begin{equation}
%PREM
    \rho = 0
\end{equation}

\begin{equation}
     \nabla^2\phi = 0
\end{equation}

\subsection{Lorentz force: Potential energy derivation from vector potential}

\begin{equation}
%PREM
    \mathbf{F} = q(\nabla(\mathbf{v}\cdot\mathbf{A}) -  \frac{d\mathbf{A}}{dt})
\end{equation}

\begin{equation}
%PREM
    U = -\int_{\infty}^r\mathbf{F}\cdot d\mathbf{r}
\end{equation}

\begin{equation}
    U = -q\int_{\infty}^r (\nabla(\mathbf{v}\cdot\mathbf{A}) -  \frac{d\mathbf{A}}{dt}) \cdot d\mathbf{r}
\end{equation}

\begin{equation}
%PREM
    \frac{d\mathbf{A}}{dt} = 0
\end{equation}

\begin{equation}
    U = -q\int_{\infty}^r\nabla(\mathbf{v}\cdot\mathbf{A})\cdot d\mathbf{r}
\end{equation}

\subsection{Lorentz force: Potential energy derivation from vector potential 2}

\begin{equation}
%PREM
    \hat{\mathbf{r}} = (1, 0, 0)
\end{equation}

\begin{equation}
%PREM
    \nabla(\mathbf{v}\cdot\mathbf{A}) = (\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}, \frac{1}{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\theta}, \frac{1}{r\sin\theta}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\varphi})
\end{equation}

\begin{equation}
    \nabla(\mathbf{v}\cdot\mathbf{A})\cdot \hat{\mathbf{r}} = (\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}, \frac{1}{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\theta}, \frac{1}{r\sin\theta}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\varphi}) \cdot (1, 0, 0)
\end{equation}

\begin{multline}
    (\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}, \frac{1}{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\theta}, \frac{1}{r\sin\theta}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial\varphi}) \cdot (1, 0, 0)\\ = \frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}
\end{multline}

\begin{equation}
    \nabla(\mathbf{v}\cdot\mathbf{A})\cdot \hat{\mathbf{r}} = \frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}
\end{equation}

\subsection{Lorentz force: Potential energy derivation from vector potential 3}

\begin{equation}
%PREM
    \nabla(\mathbf{v}\cdot\mathbf{A})\cdot \hat{\mathbf{r}} = \frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}
\end{equation}

\begin{equation}
    \int_{\infty}^{r}\nabla(\mathbf{v}\cdot\mathbf{A})\cdot \hat{\mathbf{r}}dr = \int_{\infty}^{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}dr
\end{equation}

\begin{equation}
%PREM
    d\mathbf{r} = \hat{\mathbf{r}} dr
\end{equation}

\begin{equation}
%PREM
    U = -q\int_{\infty}^r\nabla(\mathbf{v}\cdot\mathbf{A})\cdot d\mathbf{r}
\end{equation}

\begin{equation}
    U = -q\int_{\infty}^r\nabla(\mathbf{v}\cdot\mathbf{A})\cdot \hat{\mathbf{r}}dr
\end{equation}

\begin{equation}
    U = -q\int_{\infty}^{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}dr
\end{equation}

\subsection{Lorentz force: Potential energy derivation from vector potential 4}

\begin{equation}
%PREM
    U = -q\int_{\infty}^{r}\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r}dr
\end{equation}

\begin{equation}
%PREM
    \int_{\infty}^r\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r} dr = \mathbf{v}\cdot\mathbf{A}(r) - \mathbf{v}\cdot\mathbf{A}(\infty)
\end{equation}

\begin{equation}
%PREM
    \mathbf{A}(\infty) = 0
\end{equation}

\begin{equation}
    \int_{\infty}^r\frac{\partial(\mathbf{v}\cdot\mathbf{A})}{\partial r} dr = \mathbf{v}\cdot\mathbf{A}(r)
\end{equation}

\begin{equation}
    U = -q\mathbf{v}\cdot\mathbf{A}(r)
\end{equation}

\subsection{Lorentz force: Derivation of classical Lagrangian of EM field}

\begin{equation}
%PREM
    V = q\phi - q\dot{\mathbf{r}}\cdot\mathbf{A}
\end{equation}

\begin{equation}
%PREM
    T = \frac{m}{2}\dot{\mathbf{r}}\cdot\dot{\mathbf{r}}
\end{equation}

\begin{equation}
%PREM
    L = T - V
\end{equation}

\begin{equation}
    L = \frac{m}{2}\dot{\mathbf{r}}\cdot\dot{\mathbf{r}} - (q\phi - q\dot{\mathbf{r}}\cdot\mathbf{A})
\end{equation}

\begin{equation}
    L = \frac{m}{2}\dot{\mathbf{r}}\cdot\dot{\mathbf{r}} + q\dot{\mathbf{r}}\cdot\mathbf{A} - q\phi
\end{equation}

\subsection{Lorentz force: Derivation of classical Lagrangian of EM field 2}

\begin{equation}
%PREM
    L = \frac{m}{2}\dot{\mathbf{r}}\cdot\dot{\mathbf{r}} + q\dot{\mathbf{r}}\cdot\mathbf{A} - q\phi
\end{equation}

\begin{equation}
%PREM
    \dot{\mathbf{r}} = (\dot{x}, \dot{y}, \dot{z})
\end{equation}

\begin{equation}
%PREM
    \mathbf{A} = (A_x, A_y, A_z)
\end{equation}

\begin{equation}
    \dot{\mathbf{r}}\cdot\dot{\mathbf{r}} = (\dot{x}, \dot{y}, \dot{z})\cdot(\dot{x}, \dot{y}, \dot{z})
\end{equation}

\begin{equation}
    \dot{\mathbf{r}}\cdot\dot{\mathbf{\mathbf{A}}} = (\dot{x}, \dot{y}, \dot{z})\cdot(A_x, A_y, A_z)
\end{equation}

\begin{equation}
    L = \frac{m}{2}(\dot{x}, \dot{y}, \dot{z})\cdot(\dot{x}, \dot{y}, \dot{z}) + q(\dot{x}, \dot{y}, \dot{z})\cdot(A_x, A_y, A_z) - q\phi
\end{equation}

\subsection{Lorentz force: Derivation of classical Lagrangian of EM field 3}

\begin{equation}
%PREM
    L = \frac{m}{2}(\dot{x}, \dot{y}, \dot{z})\cdot(\dot{x}, \dot{y}, \dot{z}) + q(\dot{x}, \dot{y}, \dot{z})\cdot(A_x, A_y, A_z) - q\phi
\end{equation}

\begin{equation}
    (\dot{x}, \dot{y}, \dot{z})\cdot(\dot{x}, \dot{y}, \dot{z}) = \dot{x}^2 + \dot{y}^2 + \dot{z}^2
\end{equation}

\begin{equation}
    (\dot{x}, \dot{y}, \dot{z})\cdot(A_x, A_y, A_z) = \dot{x}A_x + \dot{y}A_y + \dot{z}A_z
\end{equation}

\begin{equation}
    L = \frac{m}{2}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\phi
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS)}

\begin{equation}
%PREM
    L = \frac{m}{2}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\phi
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial \dot{x}} = \frac{\partial}{\partial \dot{x}}(\frac{m}{2}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\phi)
\end{equation}

\begin{multline}
    \frac{\partial L}{\partial \dot{x}} = \frac{m}{2}\frac{\partial}{\partial \dot{x}}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2)\\ + q\frac{\partial}{\partial \dot{x}}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\frac{\partial}{\partial \dot{x}}\phi
\end{multline}

\begin{equation}
%PREM
    \frac{\partial}{\partial \dot{x}}\phi = 0
\end{equation}

\begin{multline}
    \frac{\partial L}{\partial \dot{x}} = \frac{m}{2}\frac{\partial}{\partial \dot{x}}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2)\\ + q\frac{\partial}{\partial \dot{x}}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z)
\end{multline}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 2}

\begin{multline}
%PREM
    \frac{\partial L}{\partial \dot{x}} = \frac{m}{2}\frac{\partial}{\partial \dot{x}}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2)\\ + q\frac{\partial}{\partial \dot{x}}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z)
\end{multline}

\begin{equation}
    \frac{\partial}{\partial \dot{x}}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) = 2\dot{x}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial \dot{x}}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) = A_x
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial \dot{x}} = \frac{m}{2}2\dot{x} + qA_x
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial \dot{x}} = m\dot{x} + qA_x
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 3}

\begin{equation}
%PREM
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = \frac{\partial L}{\partial x}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial L}{\partial \dot{x}} = m\dot{x} + qA_x
\end{equation}

\begin{equation}
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = \frac{d}{dt}(m\dot{x} + qA_x)
\end{equation}

\begin{equation}
    \frac{d}{dt}(m\dot{x} + qA_x) = m\frac{d}{dt}\dot{x} + q\frac{d}{dt}A_x
\end{equation}

\begin{equation}
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = m\frac{d}{dt}\dot{x} + q\frac{d}{dt}A_x
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 4}

\begin{equation}
%PREM
    dA_x = \frac{\partial A_x}{\partial t}dt + \frac{\partial A_x}{\partial x}dx + \frac{\partial A_x}{\partial y}dy + \frac{\partial A_x}{\partial z}dz
\end{equation}

\begin{equation}
    \frac{dA_x}{dt} = \frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\frac{dx}{dt} + \frac{\partial A_x}{\partial y}\frac{dy}{dt} + \frac{\partial A_x}{\partial z}\frac{dz}{dt}
\end{equation}

\begin{equation}
%PREM
    \frac{dx}{dt} = \dot{x}
\end{equation}

\begin{equation}
%PREM
    \frac{dy}{dt} = \dot{y}
\end{equation}

\begin{equation}
%PREM
    \frac{dz}{dt} = \dot{z}
\end{equation}

\begin{equation}
    \frac{dA_x}{dt} = \frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 5}

\begin{equation}
%PREM
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = m\frac{d}{dt}\dot{x} + q\frac{d}{dt}A_x
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt}\dot{x} = \Ddot{x}
\end{equation}

\begin{equation}
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = m\Ddot{x} + q\frac{dA_x}{dt}
\end{equation}

\begin{equation}
%PREM
    \frac{dA_x}{dt} = \frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}
\end{equation}

\begin{equation}
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = m\Ddot{x} + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z})
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (RHS)}

\begin{equation}
%PREM
    L = \frac{m}{2}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\phi
\end{equation}


\begin{equation}
    \frac{\partial L}{\partial x} = \frac{\partial}{\partial x}(\frac{m}{2}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\phi)
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial x} = \frac{m}{2}\frac{\partial}{\partial x}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) + q\frac{\partial}{\partial x}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\frac{\partial}{\partial x}\phi
\end{equation}

\begin{equation}
    \frac{\partial}{\partial x}(\dot{x}^2 + \dot{y}^2 + \dot{z}^2) = 0
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial x} = q\frac{\partial}{\partial x}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\frac{\partial}{\partial x}\phi
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (RHS) 2}

\begin{equation}
%PREM
    \frac{\partial L}{\partial x} = q\frac{\partial}{\partial x}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z) - q\frac{\partial}{\partial x}\phi
\end{equation}

\begin{equation}
%PREM
    I = \frac{\partial}{\partial x}(\dot{x}A_x + \dot{y}A_y + \dot{z}A_z)
\end{equation}

\begin{equation}
    I = \frac{\partial}{\partial x}(\dot{x}A_x) + \frac{\partial}{\partial x}(\dot{y}A_y) + \frac{\partial}{\partial x}(\dot{z}A_z)
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial x}(\dot{x}A_x) + \frac{\partial}{\partial x}(\dot{y}A_y) + \frac{\partial}{\partial x}(\dot{z}A_z) = \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial x} = q(\frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial}{\partial x}\phi
\end{equation}

\subsection{Lorentz force: Derivation of x component of electric field}

\begin{equation}
%PREM
    \mathbf{E} = -\nabla\phi - \frac{\partial\mathbf{A}}{\partial t}
\end{equation}

\begin{equation}
%PREM
    \nabla\phi = (\frac{\partial\phi}{\partial x}, \frac{\partial\phi}{\partial y}, \frac{\partial\phi}{\partial z})
\end{equation}

\begin{equation}
%PREM
    \mathbf{A} = (A_x, A_y, A_z)
\end{equation}

\begin{equation}
    \mathbf{E} = -(\frac{\partial\phi}{\partial x}, \frac{\partial\phi}{\partial y}, \frac{\partial\phi}{\partial z}) - \frac{\partial}{\partial t} (A_x, A_y, A_z)
\end{equation}

\begin{multline}
    \mathbf{E} \cdot (1, 0, 0) = -((\frac{\partial\phi}{\partial x}, \frac{\partial\phi}{\partial y}, \frac{\partial\phi}{\partial z}) - \frac{\partial}{\partial t} (A_x, A_y, A_z)) \\ \cdot (1, 0, 0)
\end{multline}

\subsection{Lorentz force: Derivation of x component of electric field 2}

\begin{equation}
%PREM
    E_x = \mathbf{E} \cdot (1, 0, 0)
\end{equation}

\begin{multline}
%PREM
    \mathbf{E} \cdot (1, 0, 0) = -(\frac{\partial\phi}{\partial x}, \frac{\partial\phi}{\partial y}, \frac{\partial\phi}{\partial z})\cdot (1, 0, 0)\\ - \frac{\partial}{\partial t} (A_x, A_y, A_z) \cdot (1, 0, 0)
\end{multline}

\begin{equation}
    \mathbf{E} \cdot (1, 0, 0) = -\frac{\partial\phi}{\partial x} - \frac{\partial A_x}{\partial t}
\end{equation}

\begin{equation}
    E_x = -\frac{\partial\phi}{\partial x} - \frac{\partial A_x}{\partial t}
\end{equation}

\begin{equation}
    E_x = -(\frac{\partial\phi}{\partial x} + \frac{\partial A_x}{\partial t})
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian}

\begin{equation}
%PREM
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = \frac{\partial L}{\partial x}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt}\frac{\partial L}{\partial \dot{x}} = m\Ddot{x} + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial L}{\partial x} = q(\frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial}{\partial x}\phi
\end{equation}

\begin{multline}
     m\Ddot{x} + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}) = \\ q(\frac{\partial A_x}{\partial x}\dot{x} + \frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial \phi}{\partial x}
\end{multline}

\begin{multline}
     m\Ddot{x} + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}) = \\ q(\frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial \phi}{\partial x}
\end{multline}

\begin{equation}
%PREM
    F_x = m\Ddot{x}
\end{equation}

\begin{multline}
     F_x + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}) = \\ q(\frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial \phi}{\partial x}
\end{multline}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 2}

\begin{multline}
%PREM
     F_x + q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}) = \\ q(\frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial \phi}{\partial x}
\end{multline}

\begin{multline}
     F_x = -q(\frac{\partial A_x}{\partial t} + \frac{\partial A_x}{\partial y}\dot{y} + \frac{\partial A_x}{\partial z}\dot{z}) + \\ q(\frac{\partial A_y}{\partial x}\dot{y} + \frac{\partial A_z}{\partial x}\dot{z}) - q\frac{\partial \phi}{\partial x}
\end{multline}

\begin{multline}
     F_x = -q(\frac{\partial A_x}{\partial t} + \frac{\partial \phi}{\partial x}) + \\q(\dot{y}(\frac{\partial A_y}{\partial x} - \frac{\partial A_x}{\partial y}) + \dot{z}(\frac{\partial A_z}{\partial x} - \frac{\partial A_x}{\partial z}))
\end{multline}

\begin{equation}
%PREM
    E_x = -(\frac{\partial\phi}{\partial x} + \frac{\partial A_x}{\partial t})
\end{equation}

\begin{multline}
     F_x = qE_x + q(\dot{y}(\frac{\partial A_y}{\partial x} - \frac{\partial A_x}{\partial y}) +\\ \dot{z}(\frac{\partial A_z}{\partial x} - \frac{\partial A_x}{\partial z}))
\end{multline}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 3}

\begin{multline}
%PREM
    \dot{\mathbf{r}} \times (\nabla \times \mathbf{A}) \\ = (\dot{y}(\nabla \times \mathbf{A})_z - \dot{z}(\nabla \times \mathbf{A})_y, \\ \dot{z}(\nabla \times \mathbf{A})_x - \dot{x}(\nabla \times \mathbf{A})_z, \\ \dot{x}(\nabla \times \mathbf{A})_y - \dot{y}(\nabla \times \mathbf{A})_x)
\end{multline}

\begin{equation}
%PREM
    (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x = (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A})) \cdot (1, 0, 0)
\end{equation}

\begin{multline}
     (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A})) \cdot (1, 0, 0) \\ = (\dot{y}(\nabla \times \mathbf{A})_z - \dot{z}(\nabla \times \mathbf{A})_y, \\ \dot{z}(\nabla \times \mathbf{A})_x - \dot{x}(\nabla \times \mathbf{A})_z, \\ \dot{x}(\nabla \times \mathbf{A})_y - \dot{y}(\nabla \times \mathbf{A})_x) \cdot (1, 0, 0)
\end{multline}

\begin{equation}
     (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A})) \cdot (1, 0, 0) = \dot{y}(\nabla \times \mathbf{A})_z - \dot{z}(\nabla \times \mathbf{A})_y
\end{equation}

\begin{equation}
     (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x = \dot{y}(\nabla \times \mathbf{A})_z - \dot{z}(\nabla \times \mathbf{A})_y
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 4}

\begin{equation}
%PREM
     (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x = \dot{y}(\nabla \times \mathbf{A})_z - \dot{z}(\nabla \times \mathbf{A})_y
\end{equation}

\begin{equation}
%PREM
    (\nabla \times \mathbf{A})_y = \frac{\partial A_x}{\partial z} - \frac{\partial A_z}{\partial x}
\end{equation}

\begin{equation}
%PREM
    (\nabla \times \mathbf{A})_z = \frac{\partial A_y}{\partial x} - \frac{\partial A_x}{\partial y}
\end{equation}

\begin{equation}
     (\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x = \dot{y}(\frac{\partial A_y}{\partial x} - \frac{\partial A_x}{\partial y}) - \dot{z}(\frac{\partial A_x}{\partial z} - \frac{\partial A_z}{\partial x})
\end{equation}

\begin{multline}
%PREM
     F_x = qE_x + q(\dot{y}(\frac{\partial A_y}{\partial x} - \frac{\partial A_x}{\partial y}) +\\ \dot{z}(\frac{\partial A_z}{\partial x} - \frac{\partial A_x}{\partial z}))
\end{multline}

\begin{equation}
     F_x = qE_x + q(\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 5}

\begin{equation}
%PREM
     F_x = qE_x + q(\dot{\mathbf{r}} \times (\nabla \times \mathbf{A}))_x
\end{equation}

\begin{equation}
%PREM
     \mathbf{B} = \nabla \times \mathbf{A}
\end{equation}

\begin{equation}
     F_x = qE_x + q(\dot{\mathbf{r}} \times \mathbf{B})_x
\end{equation}

\begin{equation}
%PREM
     F_x = \mathbf{F} \cdot \hat{\mathbf{x}}
\end{equation}

\begin{equation}
%PREM
     E_x = \mathbf{E} \cdot \hat{\mathbf{x}}
\end{equation}

\begin{equation}
%PREM
    (\dot{\mathbf{r}} \times \mathbf{B})_x = (\dot{\mathbf{r}} \times \mathbf{B}) \cdot \hat{\mathbf{x}}
\end{equation}

\begin{equation}
     \mathbf{F} \cdot \hat{\mathbf{x}} = q\mathbf{E} \cdot \hat{\mathbf{x}} + q(\dot{\mathbf{r}} \times \mathbf{B}) \cdot \hat{\mathbf{x}}
\end{equation}

\subsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 6}

\begin{equation}
%PREM
     \mathbf{F} \cdot \hat{\mathbf{x}} = q\mathbf{E} \cdot \hat{\mathbf{x}} + q(\dot{\mathbf{r}} \times \mathbf{B}) \cdot \hat{\mathbf{x}}
\end{equation}

\begin{equation}
     \mathbf{F} \cdot \hat{\mathbf{x}} = (q\mathbf{E} + q(\dot{\mathbf{r}} \times \mathbf{B})) \cdot \hat{\mathbf{x}}
\end{equation}

\begin{equation}
%PREM
     \hat{\mathbf{x}} \cdot \hat{\mathbf{x}} = 1 
\end{equation}

\begin{equation}
     \mathbf{F} \cdot \hat{\mathbf{x}} \cdot \hat{\mathbf{x}} = (q\mathbf{E} + q(\dot{\mathbf{r}} \times \mathbf{B})) \cdot \hat{\mathbf{x}} \cdot \hat{\mathbf{x}} 
\end{equation}

\begin{equation}
     \mathbf{F} = q\mathbf{E} + q(\dot{\mathbf{r}} \times \mathbf{B})
\end{equation}

\begin{equation}
     \mathbf{F} = q(\mathbf{E} + \dot{\mathbf{r}} \times \mathbf{B})
\end{equation}

\subsection{Magnetic flux: Flux through a closed surface}

\begin{equation}
%PREM
    \oiint_S \mathbf{B} \cdot d\mathbf{S} = 0
\end{equation}

\begin{equation}
%PREM
    \oiint_S \mathbf{B} \cdot d\mathbf{S} = \iiint_V \nabla \cdot \mathbf{B} dV
\end{equation}

\begin{equation}
    \iiint_V \nabla \cdot \mathbf{B} dV = 0
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{B} = 0
\end{equation}

\subsection{Maxwell's equations: Charge conservation}

\begin{equation}
%PREM
    \nabla \cdot (\nabla \times \mathbf{B}) = 0
\end{equation}

\begin{equation}
%PREM
    \nabla \times \mathbf{B} = \mu_0 \mathbf{J} + \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t}
\end{equation}

\begin{equation}
    \nabla \cdot (\nabla \times \mathbf{B}) = \nabla \cdot (\mu_0 \mathbf{J} + \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t})
\end{equation}

\begin{equation}
    \nabla \cdot (\nabla \times \mathbf{B}) = \nabla \cdot \mu_0 \mathbf{J} + \nabla \cdot \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t}
\end{equation}

\begin{equation}
    \nabla \cdot \mu_0 \mathbf{J} + \nabla \cdot \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t} = 0
\end{equation}

\subsection{Maxwell's equations: Charge conservation 2}

\begin{equation}
%PREM
    \nabla \cdot \mu_0 \mathbf{J} + \nabla \cdot \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t} = 0
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{J} + \nabla \cdot \varepsilon_0\frac{\partial \mathbf{E}}{\partial t} = 0
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \varepsilon_0\frac{\partial \mathbf{E}}{\partial t} = \varepsilon_0 \frac{\partial}{\partial t}(\nabla \cdot \mathbf{E})
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{J} + \varepsilon_0 \frac{\partial}{\partial t}(\nabla \cdot \mathbf{E}) = 0
\end{equation}

\subsection{Maxwell's equations: Charge conservation 3}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{J} + \varepsilon_0 \frac{\partial}{\partial t}(\nabla \cdot \mathbf{E}) = 0
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{E} = \frac{\rho}{\varepsilon_0}
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{J} + \varepsilon_0 \frac{\partial}{\partial t}(\frac{\rho}{\varepsilon_0}) = 0
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{J} + \frac{\partial}{\partial t}(\rho) = 0
\end{equation}

\begin{equation}
    \nabla \cdot \mathbf{J} = - \frac{\partial \rho}{\partial t}
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{E}$}

\begin{equation}
%PREM
    \nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t} 
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{E}) = \nabla \times (-\frac{\partial \mathbf{B}}{\partial t})
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = -\nabla \times \frac{\partial \mathbf{B}}{\partial t}
\end{equation}

\begin{equation}
%PREM
    \nabla \times \frac{\partial \mathbf{B}}{\partial t} = \frac{\partial}{\partial t} (\nabla \times \mathbf{B})
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = -\frac{\partial}{\partial t} (\nabla \times \mathbf{B})
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{E}$ 2}

\begin{equation}
%PREM
   \nabla \times (\nabla \times \mathbf{E}) = -\frac{\partial}{\partial t} (\nabla \times \mathbf{B})
\end{equation}

\begin{equation}
%PREM
   \nabla \times \mathbf{B} = \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t}
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = -\frac{\partial}{\partial t} (\mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t})
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = -\mu_0\varepsilon_0\frac{\partial}{\partial t} (\frac{\partial \mathbf{E}}{\partial t})
\end{equation}

\begin{equation}
%PREM
   \frac{\partial}{\partial t} (\frac{\partial \mathbf{E}}{\partial t}) = \frac{\partial^2 \mathbf{E}}{\partial t^2}
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{E}}{\partial t^2}
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{E}$ 3}

\begin{equation}
%PREM
   \nabla \times (\nabla \times \mathbf{E}) = \nabla(\nabla \cdot \mathbf{E}) - \nabla^2 \mathbf{E}
\end{equation}

\begin{equation}
%PREM
    \nabla \cdot \mathbf{E} = 0 
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{E}) = - \nabla^2 \mathbf{E}
\end{equation}

\begin{equation}
%PREM
   \nabla \times (\nabla \times \mathbf{E}) = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{E}}{\partial t^2}
\end{equation}

\begin{equation}
   - \nabla^2 \mathbf{E} = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{E}}{\partial t^2}
\end{equation}

\begin{equation}
   \mu_0\varepsilon_0\frac{\partial^2 \mathbf{E}}{\partial t^2} - \nabla^2 \mathbf{E} = 0
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{E}$ 4}

\begin{equation}
%PREM
   \mu_0\varepsilon_0\frac{\partial^2 \mathbf{E}}{\partial t^2} - \nabla^2 \mathbf{E} = 0
\end{equation}

\begin{equation}
%PREM
    c_0 = \frac{1}{\sqrt{\mu_0\varepsilon_0}}
\end{equation}

\begin{equation}
    \mu_0\varepsilon_0 = \frac{1}{c_0^2}
\end{equation}

\begin{equation}
   \frac{1}{c_0^2}\frac{\partial^2 \mathbf{E}}{\partial t^2} - \nabla^2 \mathbf{E} = 0
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{B}$}

\begin{equation}
%PREM
    \nabla \times \mathbf{B} = \mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t}
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = \nabla \times (\mu_0\varepsilon_0\frac{\partial \mathbf{E}}{\partial t})
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = \mu_0\varepsilon_0\nabla \times (\frac{\partial \mathbf{E}}{\partial t})
\end{equation}

\begin{equation}
%PREM
    \nabla \times (\frac{\partial \mathbf{E}}{\partial t}) = \frac{\partial}{\partial t}(\nabla \times \mathbf{E})
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = \mu_0\varepsilon_0\frac{\partial}{\partial t}(\nabla \times \mathbf{E})
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{B}$ 2}

\begin{equation}
%PREM
    \nabla \times (\nabla \times \mathbf{B}) = \mu_0\varepsilon_0\frac{\partial}{\partial t}(\nabla \times \mathbf{E})
\end{equation}

\begin{equation}
%PREM
    \nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = \mu_0\varepsilon_0\frac{\partial}{\partial t}(-\frac{\partial \mathbf{B}}{\partial t})
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = -\mu_0\varepsilon_0\frac{\partial}{\partial t}(\frac{\partial \mathbf{B}}{\partial t})
\end{equation}

\begin{equation}
%PREM
    \frac{\partial}{\partial t}(\frac{\partial \mathbf{B}}{\partial t}) = \frac{\partial^2 \mathbf{B}}{\partial t^2}
\end{equation}

\begin{equation}
    \nabla \times (\nabla \times \mathbf{B}) = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{B}}{\partial t^2}
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{B}$ 3}

\begin{equation}
%PREM
   \nabla \times (\nabla \times \mathbf{B}) = \nabla(\nabla \cdot \mathbf{B}) - \nabla^2 \mathbf{B}
\end{equation}

\begin{equation}
%PREM
   \nabla \cdot \mathbf{B} = 0
\end{equation}

\begin{equation}
   \nabla \times (\nabla \times \mathbf{B}) = - \nabla^2 \mathbf{B}
\end{equation}

\begin{equation}
%PREM
    \nabla \times (\nabla \times \mathbf{B}) = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{B}}{\partial t^2}
\end{equation}

\begin{equation}
   - \nabla^2 \mathbf{B} = -\mu_0\varepsilon_0\frac{\partial^2 \mathbf{B}}{\partial t^2}
\end{equation}

\begin{equation}
   \mu_0\varepsilon_0\frac{\partial^2 \mathbf{B}}{\partial t^2} - \nabla^2 \mathbf{B} = 0
\end{equation}

\subsection{Electromagnetic wave equation: The origin of the electromagnetic wave equation in $\mathbf{B}$ 4}

\begin{equation}
%PREM
   \mu_0\varepsilon_0\frac{\partial^2 \mathbf{B}}{\partial t^2} - \nabla^2 \mathbf{B} = 0
\end{equation}

\begin{equation}
%PREM
    c_0 = \frac{1}{\sqrt{\mu_0\varepsilon_0}}
\end{equation}

\begin{equation}
    \mu_0\varepsilon_0 = \frac{1}{c_0^2}
\end{equation}

\begin{equation}
   \frac{1}{c_0^2}\frac{\partial^2 \mathbf{B}}{\partial t^2} - \nabla^2 \mathbf{B} = 0
\end{equation}

\subsection{Ampere's circuital law: Proof of equivalence}

\begin{equation}
%PREM
    \frac{1}{\mu_0}\mathbf{B} = \mathbf{H} + \mathbf{M}
\end{equation}

\begin{equation}
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \nabla \times (\mathbf{H} + \mathbf{M})
\end{equation}

\begin{equation}
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \nabla \times \mathbf{H} + \nabla \times \mathbf{M}
\end{equation}

\begin{equation}
%PREM
    \mathbf{J}_M = \nabla \times \mathbf{M}
\end{equation}

\begin{equation}
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \nabla \times \mathbf{H} + \mathbf{J}_M
\end{equation}

\subsection{Ampere's circuital law: Proof of equivalence 2}

\begin{equation}
%PREM
    \nabla\times \mathbf{H} = \mathbf{J}_f + \frac{\partial \mathbf{D}}{\partial t}
\end{equation}

\begin{equation}
%PREM
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \nabla \times \mathbf{H} + \mathbf{J}_M
\end{equation}

\begin{equation}
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \mathbf{J}_f + \frac{\partial \mathbf{D}}{\partial t} + \mathbf{J}_M
\end{equation}

\begin{equation}
%PREM
    \mathbf{D} = \varepsilon_0\mathbf{E} + \mathbf{P}
\end{equation}

\begin{equation}
    \frac{\partial \mathbf{D}}{\partial t} = \frac{\partial}{\partial t}(\varepsilon_0\mathbf{E} + \mathbf{P})
\end{equation}

\begin{equation}
    \frac{\partial \mathbf{D}}{\partial t} = \frac{\partial}{\partial t}\varepsilon_0\mathbf{E} + \frac{\partial}{\partial t}\mathbf{P}
\end{equation}

\begin{equation}
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \mathbf{J}_f + \frac{\partial}{\partial t}\varepsilon_0\mathbf{E} + \frac{\partial}{\partial t}\mathbf{P} + \mathbf{J}_M
\end{equation}

\subsection{Ampere's circuital law: Proof of equivalence 3}

\begin{equation}
%PREM
    \nabla \times \frac{1}{\mu_0}\mathbf{B} = \mathbf{J}_f + \frac{\partial}{\partial t}\varepsilon_0\mathbf{E} + \frac{\partial}{\partial t}\mathbf{P} + \mathbf{J}_M
\end{equation}

\begin{equation}
    \frac{1}{\mu_0}(\nabla \times \mathbf{B}) = \mathbf{J}_f + \varepsilon_0\frac{\partial\mathbf{E}}{\partial t} + \frac{\partial\mathbf{P}}{\partial t} + \mathbf{J}_M
\end{equation}

\begin{equation}
%PREM
    \mathbf{J}_P = \frac{\partial\mathbf{P}}{\partial t}
\end{equation}

\begin{equation}
    \frac{1}{\mu_0}(\nabla \times \mathbf{B}) = \mathbf{J}_f + \varepsilon_0\frac{\partial\mathbf{E}}{\partial t} + \mathbf{J}_P + \mathbf{J}_M
\end{equation}

\subsection{Ampere's circuital law: Proof of equivalence 4}

\begin{equation}
%PREM
    \frac{1}{\mu_0}(\nabla \times \mathbf{B}) = \mathbf{J}_f + \varepsilon_0\frac{\partial\mathbf{E}}{\partial t} + \mathbf{J}_P + \mathbf{J}_M
\end{equation}

\begin{equation}
%PREM
    \mathbf{J}_b = \mathbf{J}_P + \mathbf{J}_M
\end{equation}

\begin{equation}
    \frac{1}{\mu_0}(\nabla \times \mathbf{B}) = \mathbf{J}_f + \varepsilon_0\frac{\partial\mathbf{E}}{\partial t} + \mathbf{J}_b
\end{equation}

\begin{equation}
%PREM
    \mathbf{J} = \mathbf{J}_f + \mathbf{J}_b
\end{equation}

\begin{equation}
    \frac{1}{\mu_0}(\nabla \times \mathbf{B}) = \mathbf{J}  + \varepsilon_0\frac{\partial\mathbf{E}}{\partial t}
\end{equation}

\section{Quantum Mechanics}
\label{app:quantum}

\subsection{Uncertainty principle: Kennard inequality proof part 1.1}

\begin{equation}
%PREM
    \sigma^2_x = \expval{x^2} - \expval{x}^2
\end{equation}

\begin{equation}
%PREM
    \expval{x} = \int_{-\infty}^{\infty}x\cdot p(x)dx
\end{equation}

\begin{equation}
%PREM
    p(x) = |\psi(x)|^2
\end{equation}

\begin{equation}
    \expval{x} = \int_{-\infty}^{\infty}x\cdot |\psi(x)|^2dx
\end{equation}

\begin{equation}
%PREM
    \expval{x^2} = \int_{-\infty}^{\infty}x^2\cdot p(x)dx
\end{equation}

\begin{equation}
    \expval{x^2} = \int_{-\infty}^{\infty}x^2\cdot|\psi(x)|^2dx
\end{equation}

\begin{equation}
    \sigma_x^2 =  \int_{-\infty}^{\infty}x^2\cdot|\psi(x)|^2dx - (\int_{-\infty}^{\infty}x\cdot|\psi(x)|^2dx)^2
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 1.2}

\begin{equation}
%PREM
    \sigma_x^2 =  \int_{-\infty}^{\infty}x^2\cdot|\psi(x)|^2dx - (\int_{-\infty}^{\infty}x\cdot|\psi(x)|^2dx)^2
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty}x\cdot|\psi(x)|^2dx = 0
\end{equation}

\begin{equation}
    \sigma_x^2 =  \int_{-\infty}^{\infty}x^2\cdot|\psi(x)|^2dx
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 1.3}

\begin{equation}
%PREM
    f(x) = x \cdot\psi(x)
\end{equation}

\begin{equation}
    f^*(x) = \psi^*(x)\cdot x
\end{equation}

\begin{equation}
    f^*(x)\cdot f(x) = (\psi^*(x)\cdot x)\cdot(x \cdot\psi(x))
\end{equation}

\begin{equation}
    f^*(x)\cdot f(x) = x^2\cdot(\psi^*(x)\cdot\psi(x))
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 1.4}

\begin{equation}
%PREM
    f^*(x)\cdot f(x) = x^2\cdot(\psi^*(x)\cdot\psi(x))
\end{equation}

\begin{equation}
%PREM
    \psi^*(x)\cdot\psi(x) = |\psi(x)|^2
\end{equation}

\begin{equation}
    f^*(x)\cdot f(x) = x^2\cdot|\psi(x)|^2
\end{equation}

\begin{equation}
%PREM
    \sigma_x^2 =  \int_{-\infty}^{\infty}x^2\cdot|\psi(x)|^2dx
\end{equation}

\begin{equation}
    \sigma_x^2 =  \int_{-\infty}^{\infty}f^*(x)\cdot f(x)dx
\end{equation}

\begin{equation}
%PREM
    \bra{f}\ket{f} = \int_{-\infty}^{\infty}f^*(x)\cdot f(x)dx
\end{equation}

\begin{equation}
    \sigma_x^2 = \bra{f}\ket{f}
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.1}

\begin{equation}
%PREM
    g(x) = \frac{1}{\sqrt{2\pi\hbar}}\int_{-\infty}^{\infty}\tilde{g}(p)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
%PREM
    \tilde{g}(p) = p\cdot \varphi (p)
\end{equation}

\begin{equation}
    g(x) = \frac{1}{\sqrt{2\pi\hbar}}\int_{-\infty}^{\infty}p\cdot \varphi (p)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
%PREM
    \varphi(p) = \frac{1}{\sqrt{2\pi\hbar}}\int_{-\infty}^{\infty}\psi (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi
\end{equation}

\begin{equation}
    g(x) = \frac{1}{\sqrt{2\pi\hbar}}\int_{-\infty}^{\infty}p\cdot (\frac{1}{\sqrt{2\pi\hbar}}\int_{-\infty}^{\infty}\psi (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi\hbar}\int_{-\infty}^{\infty}p\cdot (\int_{-\infty}^{\infty}\psi§ (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.2}

\begin{equation}
%PREM
    \frac{dv}{d\chi} = e^{\frac{-ip\chi}{\hbar}}
\end{equation}

\begin{equation}
%PREM
    v = \int\frac{dv}{d\chi}d\chi 
\end{equation}

\begin{equation}
    v = \int e^{\frac{-ip\chi}{\hbar}}d\chi 
\end{equation}

\begin{equation}
%PREM
    b = \frac{-ip\chi}{\hbar}
\end{equation}

\begin{equation}
    db = \frac{-ip}{\hbar}d\chi
\end{equation}

\begin{equation}
    \frac{\hbar}{-ip}db = d\chi
\end{equation}

\begin{equation}
    v = \int e^{b}\frac{\hbar}{-ip}db 
\end{equation}

\begin{equation}
    v = \frac{\hbar}{-ip}e^{b} + C
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.3}

\begin{equation}
%PREM
    u = \psi(\chi)
\end{equation}

\begin{equation}
%PREM
    v = \frac{\hbar}{-ip}e^{b}
\end{equation}

\begin{equation}
%PREM
    b = \frac{-ip\chi}{\hbar}
\end{equation}

\begin{equation}
    v = \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}} 
\end{equation}

\begin{equation}
    uv = \psi(\chi) \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}} 
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.4}

\begin{equation}
%PREM
    uv = \psi(\chi) \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}} 
\end{equation}

\begin{equation}
    \eval{(uv)}^{\infty}_{-\infty}  = \eval{(\psi(\chi) \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}})}^{\infty}_{-\infty}
\end{equation}

\begin{multline}
    \eval{(\psi(\chi) \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}})}^{\infty}_{-\infty} = (\psi(\infty) \frac{\hbar}{-ip}e^{\frac{-ip\infty}{\hbar}})\\ - (\psi(-\infty) \frac{\hbar}{-ip}e^{\frac{ip\infty}{\hbar}})
\end{multline}

\begin{equation}
%PREM
    \psi(\infty) = 0
\end{equation}

\begin{equation}
%PREM
    \psi(-\infty) = 0
\end{equation}

\begin{equation}
    \eval{(\psi(\chi) \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}})}^{\infty}_{-\infty}  = 0
\end{equation}

\begin{equation}
    \eval{(uv)}^{\infty}_{-\infty}  = 0
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.5}

\begin{equation}
%PREM
    I = \eval{(uv)}^{\infty}_{-\infty} - \int^{\infty}_{-\infty}v\frac{du}{d\chi}d\chi
\end{equation}

\begin{equation}
%PREM
    \eval{(uv)}^{\infty}_{-\infty}  = 0
\end{equation}

\begin{equation}
    I = - \int^{\infty}_{-\infty}v\frac{du}{d\chi}d\chi
\end{equation}

\begin{equation}
%PREM
   \frac{du}{d\chi} = \frac{d\psi(\chi)}{d\chi}
\end{equation}

\begin{equation}
%PREM
    v = \frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}} 
\end{equation}

\begin{equation}
    I = - \int^{\infty}_{-\infty}(\frac{\hbar}{-ip}e^{\frac{-ip\chi}{\hbar}})(\frac{d\psi(\chi)}{d\chi})d\chi
\end{equation}

\begin{equation}
    I = \frac{\hbar}{ip} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.6}

\begin{equation}
%PREM
    I = \frac{\hbar}{ip} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi
\end{equation}

\begin{equation}
%PREM
    I = \int_{-\infty}^{\infty}\psi (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi
\end{equation}

\begin{equation}
    \int_{-\infty}^{\infty}\psi (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi = \frac{\hbar}{ip} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi
\end{equation}

\begin{equation}
%PREM
    g(x) = \frac{1}{2\pi\hbar}\int_{-\infty}^{\infty}p\cdot (\int_{-\infty}^{\infty}\psi§ (\chi)\cdot e^{\frac{-ip\chi}{\hbar}}d\chi)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi\hbar}\int_{-\infty}^{\infty}p\cdot (\frac{\hbar}{ip} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.7}

\begin{equation}
%PREM
    g(x) = \frac{1}{2\pi\hbar}\int_{-\infty}^{\infty}p\cdot (\frac{\hbar}{ip} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi)\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi\hbar}\int_{-\infty}^{\infty}\frac{\hbar}{i} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{-ip\chi}{\hbar}}d\chi\cdot e^{\frac{ipx}{\hbar}}dp
\end{equation}

\begin{equation}
    e^{\frac{-ip\chi}{\hbar}}\cdot e^{\frac{ipx}{\hbar}} = e^{\frac{i}{\hbar}(x-\chi)p}
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{i}{\hbar}(x-\chi)p}d\chi dp
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.8}

\begin{equation}
%PREM
    g(x) = \frac{1}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{\frac{i}{\hbar}(x-\chi)p}d\chi dp
\end{equation}

\begin{equation}
%PREM
    b = \frac{p}{\hbar}
\end{equation}

\begin{equation}
    b\hbar = p
\end{equation}

\begin{equation}
    \hbar \cdot db = dp
\end{equation}

\begin{equation}
    g(x) = \frac{1}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{i(x-\chi)b}d\chi \hbar \cdot db
\end{equation}

\begin{equation}
    g(x) = \frac{\hbar}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{i(x-\chi)b}d\chi db
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.9}

\begin{equation}
%PREM
    g(x) = \frac{\hbar}{2\pi i}\int_{-\infty}^{\infty} \int^{\infty}_{-\infty}\frac{d\psi(\chi)}{d\chi}e^{i(x-\chi)b}d\chi db
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty} e^{i(x-\chi)b}db = 2\pi\delta(x-\chi)
\end{equation}

\begin{equation}
    g(x) = \frac{\hbar}{2\pi i}\int_{-\infty}^{\infty}\frac{d\psi(\chi)}{d\chi}2\pi\delta(x-\chi) d\chi
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty}\frac{d\psi(\chi)}{d\chi}2\pi\delta(x-\chi) d\chi = 2\pi\frac{d\psi(x)}{dx}
\end{equation} 

\begin{equation}
    g(x) = \frac{\hbar}{2\pi i}(2\pi\frac{d\psi(x)}{dx})
\end{equation}

\begin{equation}
    g(x) = \frac{\hbar}{i}(\frac{d\psi(x)}{dx})
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 2.10}

\begin{equation}
%PREM
    g(x) = \frac{\hbar}{i}(\frac{d\psi(x)}{dx})
\end{equation} 

\begin{equation}
%PREM
    -i = \frac{1}{i}
\end{equation}

\begin{equation}
    g(x) = -i\hbar(\frac{d\psi(x)}{dx})
\end{equation}

\begin{equation}
    g(x) = (-i\hbar\frac{d}{dx})\cdot\psi(x)
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 3.1}

\begin{equation}
%PREM
    \tilde{g}(p) = p\cdot \varphi (p)
\end{equation}

\begin{equation}
    \tilde{g}^*(p) = \varphi^*(p) \cdot p
\end{equation}

\begin{equation}
    \tilde{g}^*(p)\cdot\tilde{g}(p) = (\varphi^*(p) \cdot p)\cdot (p\cdot \varphi (p))
\end{equation}

\begin{equation}
    \tilde{g}^*(p)\cdot\tilde{g}(p) = p^2\varphi^*(p)\cdot\varphi (p)
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 3.2}

\begin{equation}
%PREM
    \tilde{g}^*(p)\cdot\tilde{g}(p) = p^2\varphi^*(p)\cdot\varphi (p)
\end{equation}

\begin{equation}
%PREM
    \varphi^*(p)\cdot\varphi (p) = |\varphi(p)|^2
\end{equation}

\begin{equation}
    \tilde{g}^*(p)\cdot\tilde{g}(p) = p^2|\varphi(p)|^2
\end{equation}

\begin{equation}
%PREM
    \tilde{g}^*(p)\cdot\tilde{g}(p) =  |\tilde{g}(p)|^2
\end{equation}

\begin{equation}
    |\tilde{g}(p)|^2 =  p^2|\varphi(p)|^2
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 3.3}

\begin{equation}
%PREM
    \sigma_p^2 = \int_{-\infty}^{\infty}p^2|\varphi(p)|^2dp
\end{equation}

\begin{equation}
%PREM
    |\tilde{g}(p)|^2 =  p^2|\varphi(p)|^2
\end{equation}

\begin{equation}
    \sigma_p^2 = \int_{-\infty}^{\infty}|\tilde{g}(p)|^2dp
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty}|\tilde{g}(p)|^2dp = \int_{-\infty}^{\infty}|g(x)|^2dx
\end{equation}

\begin{equation}
    \sigma_p^2 = \int_{-\infty}^{\infty}|g(x)|^2dx
\end{equation}

\begin{equation}
%PREM
   \bra{g}\ket{g} = \int_{-\infty}^{\infty}|g(x)|^2dx
\end{equation}

\begin{equation}
    \sigma_p^2 = \bra{g}\ket{g}
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 4.1}

\begin{equation}
%PREM
    \sigma_x^2 = \bra{f}\ket{f}
\end{equation}

\begin{equation}
%PREM
    \sigma_p^2 = \bra{g}\ket{g}
\end{equation}

\begin{equation}
    \sigma_x^2\sigma_p^2 = \bra{f}\ket{f}\cdot \bra{g}\ket{g}
\end{equation}

\begin{equation}
%PREM
    \bra{f}\ket{f}\cdot \bra{g}\ket{g} \geq |\bra{f}\ket{g}|^2 
\end{equation}

\begin{equation}
    \sigma_x^2\sigma_p^2 \geq |\bra{f}\ket{g}|^2 
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 4.2}

\begin{equation}
%PREM
    z = \bra{f}\ket{g}
\end{equation}

\begin{equation}
    z^* = \bra{g}\ket{f}
\end{equation}

\begin{equation}
%PREM
    \Im(z) = \frac{1}{2i}(z - z^*)
\end{equation}

\begin{equation}
    \Im(z) = \frac{1}{2i}(\bra{f}\ket{g} - \bra{g}\ket{f})
\end{equation}

\begin{equation}
    (\Im(z))^2 = (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 4.3}

\begin{equation}
%PREM
    |z|^2 = (\Re(z))^2 + (\Im(z))^2
\end{equation}

\begin{equation}
%PREM
    (\Re(z))^2 + (\Im(z))^2 \geq (\Im(z))^2
\end{equation}

\begin{equation}
    |z|^2 \geq (\Im(z))^2
\end{equation}

\begin{equation}
%PREM
    (\Im(z))^2 = (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\begin{equation}
    |z|^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 4.4}

\begin{equation}
%PREM
    \sigma_x^2\sigma_p^2 \geq |\bra{f}\ket{g}|^2 
\end{equation}

\begin{equation}
%PREM
    |z|^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\begin{equation}
%PREM
    z = \bra{f}\ket{g}
\end{equation}

\begin{equation}
    |\bra{f}\ket{g}|^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\begin{equation}
    \sigma_x^2\sigma_p^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 5.1}

\begin{equation}
%PREM
    \sigma_x^2\sigma_p^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\begin{equation}
%PREM
    f(x) = x \cdot \psi (x)
\end{equation}

\begin{equation}
%PREM
    g(x) = (-i\hbar \frac{d}{dx}) \cdot \psi (x)
\end{equation}

\begin{equation}
%PREM
    \bra{f}\ket{g} = \int_{-\infty}^{\infty} f^*(x)\cdot g(x)dx
\end{equation}

\begin{equation}
    f^*(x) = \psi^*(x) \cdot x 
\end{equation}

\begin{equation}
    \bra{f}\ket{g} = \int_{-\infty}^{\infty}(\psi^*(x) \cdot x)\cdot((-i\hbar\frac{d}{dx})\cdot\psi(x))dx
\end{equation}

\begin{equation}
    \bra{f}\ket{g} = -i\hbar\int_{-\infty}^{\infty} x \psi^*(x) \frac{d \psi(x)}{dx} dx
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 5.2}

\begin{equation}
%PREM
    f(x) = x \cdot \psi (x)
\end{equation}

\begin{equation}
%PREM
    g^*(x) = \psi^* (x) \cdot (-i\hbar \frac{d}{dx})
\end{equation}

\begin{equation}
%PREM
    \bra{g}\ket{f} = \int_{-\infty}^{\infty}g^*(x) \cdot f(x) dx
\end{equation}

\begin{equation}
    \bra{g}\ket{f} = \int_{-\infty}^{\infty}(\psi^* (x) \cdot (-i\hbar \frac{d}{dx})) \cdot (x \cdot \psi (x))dx
\end{equation}

\begin{equation}
    \bra{g}\ket{f} = -i\hbar\int_{-\infty}^{\infty}\psi^* (x)  \frac{d}{dx} (x\psi (x))dx 
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 5.3}

\begin{equation}
%PREM
    \bra{f}\ket{g} = -i\hbar\int_{-\infty}^{\infty} x \psi^*(x) \frac{d \psi(x)}{dx} dx
\end{equation}

\begin{equation}
%PREM
    \bra{g}\ket{f} = -i\hbar\int_{-\infty}^{\infty}\psi^* (x)  \frac{d}{dx} (x\psi (x))dx 
\end{equation}

\begin{multline}
    \bra{f}\ket{g} - \bra{g}\ket{f} = (-i\hbar\int_{-\infty}^{\infty} x \psi^*(x) \frac{d \psi(x)}{dx} dx)\\ - (-i\hbar\int_{-\infty}^{\infty}\psi^* (x)  \frac{d}{dx} (x\psi (x))dx)
\end{multline}

\begin{multline}
    \bra{f}\ket{g} - \bra{g}\ket{f} = -i\hbar\int_{-\infty}^{\infty}( x \psi^*(x) \frac{d \psi(x)}{dx} \\ - \psi^*(x)\frac{d}{dx}(x\psi(x)))dx
\end{multline}

\subsection{Uncertainty principle: Kennard inequality proof part 5.4}

\begin{multline}
%PREM
    \bra{f}\ket{g} - \bra{g}\ket{f} = -i\hbar\int_{-\infty}^{\infty}( x \psi^*(x) \frac{d \psi(x)}{dx} \\ - \psi^*(x)\frac{d}{dx}(x\psi(x)))dx
\end{multline}

\begin{multline}
    \bra{f}\ket{g} - \bra{g}\ket{f} =\\ -i\hbar\int_{-\infty}^{\infty}\psi^* (x)( x\frac{d\psi(x)}{dx} - \frac{d}{dx}(x\psi(x)))dx
\end{multline}

\begin{equation}
%PREM
    \frac{d}{dx}(x\psi(x)) = x\frac{d\psi(x)}{dx} + \psi(x)
\end{equation}

\begin{multline}
    \bra{f}\ket{g} - \bra{g}\ket{f} =\\ -i\hbar\int_{-\infty}^{\infty}\psi^* (x)( x\frac{d\psi(x)}{dx} - (x\frac{d\psi(x)}{dx} + \psi(x)))dx
\end{multline}

\subsection{Uncertainty principle: Kennard inequality proof part 5.5}

\begin{multline}
%PREM
    \bra{f}\ket{g} - \bra{g}\ket{f} =\\ -i\hbar\int_{-\infty}^{\infty}\psi^* (x)( x\frac{d\psi(x)}{dx} - (x\frac{d\psi(x)}{dx} + \psi(x)))dx
\end{multline}

\begin{multline}
    \bra{f}\ket{g} - \bra{g}\ket{f} =\\ -i\hbar\int_{-\infty}^{\infty}\psi^* (x)( x\frac{d\psi(x)}{dx} - x\frac{d\psi(x)}{dx} - \psi(x))dx
\end{multline}

\begin{equation}
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar\int_{-\infty}^{\infty}\psi^* (x)\psi(x)dx
\end{equation}

\begin{equation}
%PREM
    \psi^*(x)\psi(x) = |\psi(x)|^2
\end{equation}

\begin{equation}
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar\int_{-\infty}^{\infty}|\psi(x)|^2 dx
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 5.6}

\begin{equation}
%PREM
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar\int_{-\infty}^{\infty}|\psi(x)|^2 dx
\end{equation}

\begin{equation}
%PREM
    p(x) = |\psi(x)|^2
\end{equation}

\begin{equation}
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar\int_{-\infty}^{\infty}p(x)dx
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty}p(x)dx = 1
\end{equation}

\begin{equation}
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar
\end{equation}

\subsection{Uncertainty principle: Kennard inequality proof part 5.7}

\begin{equation}
%PREM
    \bra{f}\ket{g} - \bra{g}\ket{f} = i\hbar
\end{equation}

\begin{equation}
    \frac{\bra{f}\ket{g}- \bra{g}\ket{f}}{2i} = \frac{\hbar}{2}
\end{equation}

\begin{equation}
    (\frac{\bra{f}\ket{g}- \bra{g}\ket{f}}{2i})^2 = \frac{\hbar^2}{4}
\end{equation}

\begin{equation}
%PREM
    \sigma_x^2\sigma_p^2 \geq (\frac{\bra{f}\ket{g} - \bra{g}\ket{f}}{2i})^2
\end{equation}

\begin{equation}
    \sigma_x^2\sigma_p^2 \geq \frac{\hbar^2}{4}
\end{equation}

\begin{equation}
    \sigma_x\sigma_p \geq \frac{\hbar}{2}
\end{equation}


\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation}

\begin{equation}
%PREM
    \psi(x,t) = (A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial t} = \frac{\partial}{\partial t}((A\sin(kx) + B\cos(kx))e^{-i\omega t})
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial t} = (A\sin(kx) + B\cos(kx))\frac{\partial}{\partial t}(e^{-i\omega t})
\end{equation}

\begin{equation}
    \frac{\partial}{\partial t}(e^{-i\omega t}) = -i\omega e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial t} = (A\sin(kx) + B\cos(kx))(-i\omega e^{-i\omega t})
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 2}

\begin{equation}
%PREM
    \frac{\partial\psi(x,t)}{\partial t} = (A\sin(kx) + B\cos(kx))(-i\omega e^{-i\omega t})
\end{equation}

\begin{equation}
    i\hbar\frac{\partial\psi(x,t)}{\partial t} = i\hbar(A\sin(kx) + B\cos(kx))(-i\omega e^{-i\omega t})
\end{equation}

\begin{equation}
%PREM
    -i\cdot i = 1
\end{equation}

\begin{equation}
    i\hbar\frac{\partial\psi(x,t)}{\partial t} = \hbar\omega (A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
    i\hbar\frac{\partial\psi(x,t)}{\partial t} = \hbar\omega \psi(x,t)
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 3}

\begin{equation}
%PREM
    \psi(x,t) = (A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial x} = \frac{\partial}{\partial x}((A\sin(kx) + B\cos(kx))e^{-i\omega t})
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial x} = (A\frac{\partial}{\partial x}(\sin(kx)) + B\frac{\partial}{\partial x}(\cos(kx)))e^{-i\omega t}
\end{equation}

\begin{equation}
   \frac{\partial}{\partial x}(\sin(kx)) = k\cos(kx)
\end{equation}

\begin{equation}
   \frac{\partial}{\partial x}(\cos(kx)) = -k\sin(kx)
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial x} = (A(k\cos(kx)) + B(-k\sin(kx)))e^{-i\omega t}
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 4}

\begin{equation}
%PREM
    \frac{\partial\psi(x,t)}{\partial x} = (A(k\cos(kx)) + B(-k\sin(kx)))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial\psi(x,t)}{\partial x} = k(A\cos(kx) - B\sin(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial^2\psi(x,t)}{\partial x^2} = \frac{\partial}{\partial x}(k(A\cos(kx) - B\sin(kx))e^{-i\omega t})
\end{equation}

\begin{equation}
    \frac{\partial^2\psi(x,t)}{\partial x^2} = k(A\frac{\partial}{\partial x}(\cos(kx)) - B\frac{\partial}{\partial x}(\sin(kx)))e^{-i\omega t}
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 5}

\begin{equation}
%PREM
    \frac{\partial^2\psi(x,t)}{\partial x^2} = k(A\frac{\partial}{\partial x}(\cos(kx)) - B\frac{\partial}{\partial x}(\sin(kx)))e^{-i\omega t}
\end{equation}

\begin{equation}
   \frac{\partial}{\partial x}(\sin(kx)) = k\cos(kx)
\end{equation}

\begin{equation}
   \frac{\partial}{\partial x}(\cos(kx)) = -k\sin(kx)
\end{equation}

\begin{equation}
    \frac{\partial^2\psi(x,t)}{\partial x^2} = k(A(-k\sin(kx)) - B(k\cos(kx)))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial^2\psi(x,t)}{\partial x^2} = -k^2(A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 6}

\begin{equation}
%PREM
    \frac{\partial^2\psi(x,t)}{\partial x^2} = -k^2(A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
%PREM
    \psi(x,t) = (A\sin(kx) + B\cos(kx))e^{-i\omega t}
\end{equation}

\begin{equation}
    \frac{\partial^2\psi(x,t)}{\partial x^2} = -k^2\psi(x,t)
\end{equation}

\begin{equation}
    -\frac{\hbar^2}{2m}\frac{\partial^2\psi(x,t)}{\partial x^2} = -\frac{\hbar^2}{2m}(-k^2\psi(x,t))
\end{equation}

\begin{equation}
    -\frac{\hbar^2}{2m}\frac{\partial^2\psi(x,t)}{\partial x^2} = \frac{\hbar^2 k^2}{2m}\psi(x,t)
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 7}

\begin{equation}
%PREM
    i\hbar\frac{\partial}{\partial t}\psi(x,t) = -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2}\psi(x,t) + V(x)\psi(x,t)    
\end{equation}

\begin{equation}
%PREM
    V(x) = 0
\end{equation}

\begin{equation}
    i\hbar\frac{\partial}{\partial t}\psi(x,t) = -\frac{\hbar}{2m}\frac{\partial^2}{\partial x^2}\psi(x,t)  
\end{equation}

\begin{equation}
%PREM
    i\hbar\frac{\partial\psi(x,t)}{\partial t} = \hbar\omega \psi(x,t)
\end{equation}

\begin{equation}
    \hbar\omega \psi(x,t) = -\frac{\hbar}{2m}\frac{\partial^2}{\partial x^2}\psi(x,t)  
\end{equation}

\subsection{Particle in a box: Wavefunction angular velocity as a function of particle mass from Schr\"{o}dinger's equation 8}

\begin{equation}
%PREM
    -\frac{\hbar^2}{2m}\frac{\partial^2\psi(x,t)}{\partial x^2} = \frac{\hbar^2 k^2}{2m}\psi(x,t)
\end{equation}

\begin{equation}
%PREM
    \hbar\omega \psi(x,t) = -\frac{\hbar}{2m}\frac{\partial^2}{\partial x^2}\psi(x,t)  
\end{equation}

\begin{equation}
    \hbar\omega \psi(x,t) = \frac{\hbar^2 k^2}{2m}\psi(x,t)
\end{equation}

\begin{equation}
    \hbar\omega = \frac{\hbar^2 k^2}{2m}
\end{equation}

\begin{equation}
%PREM
    p = \hbar k
\end{equation}

\begin{equation}
    \hbar\omega = \frac{p^2}{2m}
\end{equation}

\begin{equation}
    \omega = \frac{p^2}{2m\hbar}
\end{equation}

\subsection{Quantum harmonic oscillator: Ladder operator method}

\begin{equation}
%PREM
    a = \sqrt{\frac{m\omega}{2\hbar}}(\hat{x} + \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
%PREM
    a^{\dagger} = \sqrt{\frac{m\omega}{2\hbar}}(\hat{x} - \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
    aa^{\dagger} = (\sqrt{\frac{m\omega}{2\hbar}}(\hat{x} + \frac{i}{m\omega}\hat{p}))(\sqrt{\frac{m\omega}{2\hbar}}(\hat{x} - \frac{i}{m\omega}\hat{p}))
\end{equation}

\begin{equation}
    aa^{\dagger} = \frac{m\omega}{2\hbar}(\hat{x} + \frac{i}{m\omega}\hat{p})(\hat{x} - \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
    aa^{\dagger} = \frac{m\omega}{2\hbar}(\hat{x}^2 - \frac{i}{m\omega}\hat{x}\hat{p} + \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)
\end{equation}

\subsection{Quantum harmonic oscillator: Ladder operator method 2}

\begin{equation}
%PREM
    a = \sqrt{\frac{m\omega}{2\hbar}}(\hat{x} + \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
%PREM
    a^{\dagger} = \sqrt{\frac{m\omega}{2\hbar}}(\hat{x} - \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
    a^{\dagger}a = (\sqrt{\frac{m\omega}{2\hbar}}(\hat{x} - \frac{i}{m\omega}\hat{p}))(\sqrt{\frac{m\omega}{2\hbar}}(\hat{x} + \frac{i}{m\omega}\hat{p}))
\end{equation}

\begin{equation}
    a^{\dagger}a = \frac{m\omega}{2\hbar}(\hat{x} - \frac{i}{m\omega}\hat{p})(\hat{x} + \frac{i}{m\omega}\hat{p})
\end{equation}

\begin{equation}
    a^{\dagger}a = \frac{m\omega}{2\hbar}(\hat{x}^2 + \frac{i}{m\omega}\hat{x}\hat{p} - \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)
\end{equation}

\subsection{Quantum harmonic oscillator: Ladder operator method 3}

\begin{equation}
%PREM
    aa^{\dagger} = \frac{m\omega}{2\hbar}(\hat{x}^2 - \frac{i}{m\omega}\hat{x}\hat{p} + \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)
\end{equation}

\begin{equation}
%PREM
    a^{\dagger}a = \frac{m\omega}{2\hbar}(\hat{x}^2 + \frac{i}{m\omega}\hat{x}\hat{p} - \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)
\end{equation}

\begin{multline}
    aa^{\dagger} - a^{\dagger}a = \frac{m\omega}{2\hbar}(\hat{x}^2 - \frac{i}{m\omega}\hat{x}\hat{p} + \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)\\ - \frac{m\omega}{2\hbar}(\hat{x}^2 + \frac{i}{m\omega}\hat{x}\hat{p} - \frac{i}{m\omega}\hat{p}\hat{x} + \hat{p}^2)
\end{multline}

\begin{equation}
    aa^{\dagger} - a^{\dagger}a = \frac{m\omega}{2\hbar}(- 2\frac{i}{m\omega}\hat{x}\hat{p} + 2\frac{i}{m\omega}\hat{p}\hat{x})
\end{equation}

\begin{equation}
    aa^{\dagger} - a^{\dagger}a = \frac{i}{\hbar}(\hat{p}\hat{x} - \hat{x}\hat{p})
\end{equation}

\subsection{Quantum harmonic oscillator: Ladder operator method 4}

\begin{equation}
%PREM
    aa^{\dagger} - a^{\dagger}a = \frac{i}{\hbar}(\hat{p}\hat{x} - \hat{x}\hat{p})
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{p}}{\hat{x}} = \hat{p}\hat{x} - \hat{x}\hat{p}
\end{equation}

\begin{equation}
    aa^{\dagger} - a^{\dagger}a = \frac{i}{\hbar}\comm{\hat{p}}{\hat{x}}
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{p}}{\hat{x}} = -i\hbar
\end{equation}

\begin{equation}
    aa^{\dagger} - a^{\dagger}a = \frac{i}{\hbar}(-i\hbar)
\end{equation}

\begin{equation}
%PREM
    -i\cdot i = 1
\end{equation}

\begin{equation}
    aa^{\dagger} - a^{\dagger}a = 1
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = aa^{\dagger} - a^{\dagger}a
\end{equation}

\begin{equation}
    \comm{a}{a^{\dagger}} = 1
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.1}

\begin{equation}
%PREM
    (\frac{-\hbar^2}{2m}\frac{d^2}{dx^2} + \frac{m\omega^2}{2}x^2)\psi(x) = E\psi(x)
\end{equation}

\begin{equation}
%PREM
    x = \sqrt{\frac{\hbar}{m\omega}}q
\end{equation}

\begin{equation}
    dx = \sqrt{\frac{\hbar}{m\omega}}dq
\end{equation}

\begin{equation}
    \frac{1}{dx^2} = \frac{m\omega}{\hbar}\frac{1}{dq^2}
\end{equation}

\begin{equation}
    (\frac{-\hbar^2}{2m}(\frac{m\omega}{\hbar}\frac{d}{dq^2}) + \frac{m\omega^2}{2}(\sqrt{\frac{\hbar}{m\omega}}q)^2)\psi(q) = E\psi(q)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.2}

\begin{equation}
%PREM
    (\frac{-\hbar^2}{2m}(\frac{m\omega}{\hbar}\frac{d}{dq^2}) + \frac{m\omega^2}{2}(\sqrt{\frac{\hbar}{m\omega}}q)^2)\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
    (\frac{-\hbar^2}{2m}\frac{m\omega}{\hbar}\frac{d^2}{dq^2} + \frac{m\omega^2}{2}\frac{\hbar}{m\omega}q^2)\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
    (\frac{-\hbar\omega}{2}\frac{d^2}{dq^2} + \frac{\hbar\omega}{2}q^2)\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
    \frac{\hbar\omega}{2}(-\frac{d^2}{dq^2} + q^2)\psi(q) = E\psi(q)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.3}

\begin{equation}
%PREM
    (\frac{d}{dq}q - q\frac{d}{dq})f(q) = \frac{d}{dq}(qf(q)) -q \frac{df(q)}{dq}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dq}(qf(q)) = f(q) + q\frac{df(q)}{dq}
\end{equation}

\begin{equation}
    (\frac{d}{dq}q - q\frac{d}{dq})f(q) = (f(q) + q\frac{df(q)}{dq}) -q \frac{df(q)}{dq}
\end{equation}

\begin{equation}
    (\frac{d}{dq}q - q\frac{d}{dq})f(q) = f(q)
\end{equation}

\begin{equation}
    (\frac{d}{dq}q - q\frac{d}{dq}) = 1
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.4}

\begin{equation}
%PREM
    (-\frac{d^2}{dq^2} + q^2)(\frac{d^2}{dq^2} + q^2) = -\frac{d^2}{dq^2} - \frac{d}{dq}q + q\frac{d}{dq} + q^2
\end{equation}

\begin{equation}
    -\frac{d^2}{dq^2} + q^2 = \frac{d}{dq}q - q\frac{d}{dq} + (-\frac{d^2}{dq^2} + q^2)(\frac{d^2}{dq^2} + q^2)
\end{equation}

\begin{equation}
%PREM
    (\frac{d}{dq}q - q\frac{d}{dq}) = 1
\end{equation}

\begin{equation}
    -\frac{d^2}{dq^2} + q^2 = 1 + (-\frac{d^2}{dq^2} + q^2)(\frac{d^2}{dq^2} + q^2)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.5}

\begin{equation}
%PREM
    \frac{\hbar\omega}{2}(-\frac{d^2}{dq^2} + q^2)\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
%PREM
    -\frac{d^2}{dq^2} + q^2 = 1 + (-\frac{d^2}{dq^2} + q^2)(\frac{d^2}{dq^2} + q^2)
\end{equation}

\begin{equation}
    \frac{\hbar\omega}{2}(1 + (-\frac{d^2}{dq^2} + q^2)(\frac{d^2}{dq^2} + q^2))\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
    \hbar\omega(\frac{1}{2} + \frac{1}{\sqrt{2}}(-\frac{d^2}{dq^2} + q^2)\frac{1}{\sqrt{2}}(\frac{d^2}{dq^2} + q^2))\psi(q) = E\psi(q)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.6}

\begin{equation}
%PREM
    \hbar\omega(\frac{1}{2} + \frac{1}{\sqrt{2}}(-\frac{d^2}{dq^2} + q^2)\frac{1}{\sqrt{2}}(\frac{d^2}{dq^2} + q^2))\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
%PREM
    a = \frac{1}{\sqrt{2}}(\frac{d^2}{dq^2} + q^2)
\end{equation}

\begin{equation}
%PREM
    a^{\dagger} = \frac{1}{\sqrt{2}}(-\frac{d^2}{dq^2} + q^2)
\end{equation}

\begin{equation}
    \hbar\omega(\frac{1}{2} + a^{\dagger}a)\psi(q) = E\psi(q)
\end{equation}

\begin{equation}
    E = \hbar\omega(a^{\dagger}a + \frac{1}{2})
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 2}

\begin{equation}
%PREM
    \comm{q}{p} = qp-pq
\end{equation}

\begin{equation}
%PREM
    p = -i\frac{d}{dq}
\end{equation}

\begin{equation}
    \comm{q}{p} = q(-i\frac{d}{dq})-(-i\frac{d}{dq})q
\end{equation}

\begin{equation}
    \comm{q}{p} = i(\frac{d}{dq}q - q\frac{d}{dq})
\end{equation}

\begin{equation}
    \comm{q}{p}f(q) = i(\frac{d}{dq}q - q\frac{d}{dq})f(q)
\end{equation}

\begin{equation}
%PREM
    (\frac{d}{dq}q - q\frac{d}{dq}) = 1
\end{equation}

\begin{equation}
    \comm{q}{p}f(q) = if(q)
\end{equation}

\begin{equation}
    \comm{q}{p} = i
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.1}

\begin{equation}
%PREM
    a = \frac{1}{\sqrt{2}}(\frac{d}{dq} + q)
\end{equation}

\begin{equation}
%PREM
    p = -i\frac{d}{dq}
\end{equation}

\begin{equation}
%PREM
    -i\cdot i = 1
\end{equation}

\begin{equation}
    ip = \frac{d}{dq}
\end{equation}

\begin{equation}
    a = \frac{1}{\sqrt{2}}(ip + q)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.2}

\begin{equation}
%PREM
    a^{\dagger} = \frac{1}{\sqrt{2}}(-\frac{d}{dq} + q)
\end{equation}

\begin{equation}
%PREM
    p = -i\frac{d}{dq}
\end{equation}

\begin{equation}
%PREM
    -i\cdot i = 1
\end{equation}

\begin{equation}
    ip = \frac{d}{dq}
\end{equation}

\begin{equation}
    a^{\dagger} = \frac{1}{\sqrt{2}}(-ip + q)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.3}

\begin{equation}
%PREM
    a = \frac{1}{\sqrt{2}}(ip + q)
\end{equation}

\begin{equation}
%PREM
    a^{\dagger} = \frac{1}{\sqrt{2}}(-ip + q)
\end{equation}

\begin{equation}
    aa^{\dagger} = (\frac{1}{\sqrt{2}}(ip + q))(\frac{1}{\sqrt{2}}(-ip + q))
\end{equation}

\begin{equation}
    aa^{\dagger} = \frac{1}{2}(ip + q)(-ip + q)
\end{equation}

\begin{equation}
    -i\cdot i = 1
\end{equation}

\begin{equation}
    aa^{\dagger} = \frac{1}{2}(p^2 + ipq - iqp + q^2)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.4}

\begin{equation}
%PREM
    a = \frac{1}{\sqrt{2}}(ip + q)
\end{equation}

\begin{equation}
%PREM
    a^{\dagger} = \frac{1}{\sqrt{2}}(-ip + q)
\end{equation}

\begin{equation}
    a^{\dagger}a = (\frac{1}{\sqrt{2}}(-ip + q))(\frac{1}{\sqrt{2}}(ip + q))
\end{equation}

\begin{equation}
    a^{\dagger}a = \frac{1}{2}(-ip + q)(ip + q)
\end{equation}

\begin{equation}
    a^{\dagger}a = \frac{1}{2}(p^2 - ipq + iqp + q^2)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.5}

\begin{equation}
%PREM
    aa^{\dagger} = \frac{1}{2}(p^2 + ipq - iqp + q^2)
\end{equation}

\begin{equation}
%PREM
    a^{\dagger}a = \frac{1}{2}(p^2 - ipq + iqp + q^2)
\end{equation}

\begin{equation}
   aa^{\dagger} - a^{\dagger}a = \frac{1}{2}(p^2 + ipq - iqp + q^2) - \frac{1}{2}(p^2 - ipq + iqp + q^2)
\end{equation}

\begin{equation}
   aa^{\dagger} - a^{\dagger}a = \frac{1}{2}(2ipq - 2iqp)
\end{equation}

\begin{equation}
   aa^{\dagger} - a^{\dagger}a = i(pq - qp)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 3.6}

\begin{equation}
%PREM
   aa^{\dagger} - a^{\dagger}a = i(pq - qp)
\end{equation}

\begin{equation}
%PREM
   \comm{p}{q} = pq - qp
\end{equation}

\begin{equation}
   aa^{\dagger} - a^{\dagger}a = i\comm{p}{q}
\end{equation}

\begin{equation}
%PREM
   \comm{p}{q} = -i
\end{equation}

\begin{equation}
%PREM
    -i\cdot i = 1
\end{equation}

\begin{equation}
   aa^{\dagger} - a^{\dagger}a = 1
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = aa^{\dagger} - a^{\dagger}a
\end{equation}

\begin{equation}
   \comm{a}{a^{\dagger}} = 1
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 4.1}

\begin{equation}
%PREM
    H = \hbar\omega(a^{\dagger}a + \frac{1}{2})
\end{equation}

\begin{equation}
%PREM
    \comm{H}{a} = Ha - aH
\end{equation}

\begin{equation}
    \comm{H}{a} = \hbar\omega(a^{\dagger}a + \frac{1}{2})a - a\hbar\omega(a^{\dagger}a + \frac{1}{2})
\end{equation}

\begin{equation}
    \comm{H}{a} = \hbar\omega(a^{\dagger}aa + \frac{a}{2} - aa^{\dagger}a - \frac{a}{2})
\end{equation}

\begin{equation}
    \comm{H}{a} = -\hbar\omega (aa^{\dagger} - a^{\dagger}a)a
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 4.2}

\begin{equation}
%PREM
    \comm{H}{a} = -\hbar\omega (aa^{\dagger} - a^{\dagger}a)a
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = aa^{\dagger} - a^{\dagger}a
\end{equation}

\begin{equation}
    \comm{H}{a} = -\hbar\omega \comm{a}{a^{\dagger}}a
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = 1
\end{equation}

\begin{equation}
    \comm{H}{a} = -\hbar\omega a
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 5.1}

\begin{equation}
%PREM
    H = \hbar\omega(a^{\dagger}a + \frac{1}{2})
\end{equation}

\begin{equation}
%PREM
    \comm{H}{a^{\dagger}} = Ha^{\dagger} - a^{\dagger}H
\end{equation}

\begin{equation}
    \comm{H}{a^{\dagger}} = \hbar\omega(a^{\dagger}a + \frac{1}{2})a^{\dagger} - a^{\dagger}\hbar\omega(a^{\dagger}a + \frac{1}{2})
\end{equation}

\begin{equation}
    \comm{H}{a^{\dagger}} = \hbar\omega(a^{\dagger}aa^{\dagger} + \frac{a^{\dagger}}{2} - a^{\dagger}a^{\dagger}a - \frac{a^{\dagger}}{2})
\end{equation}

\begin{equation}
    \comm{H}{a^{\dagger}} = \hbar\omega a^{\dagger}(aa^{\dagger} - a^{\dagger}a)
\end{equation}

\subsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 5.2}

\begin{equation}
%PREM
    \comm{H}{a^{\dagger}} = \hbar\omega a^{\dagger}(aa^{\dagger} - a^{\dagger}a)
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = aa^{\dagger} - a^{\dagger}a
\end{equation}

\begin{equation}
    \comm{H}{a^{\dagger}} = \hbar\omega a^{\dagger}\comm{a}{a^{\dagger}}
\end{equation}

\begin{equation}
%PREM
    \comm{a}{a^{\dagger}} = 1
\end{equation}

\begin{equation}
    \comm{H}{a^{\dagger}} = \hbar\omega a^{\dagger}
\end{equation}

\subsection{Heisenberg picture: time evolution}

\begin{equation}
%PREM
    \hat{x}(t) = e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{equation}
    \frac{d}{dt}\hat{x}(t) = \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}})
\end{equation}

\begin{multline}
%PREM
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) =  \frac{d}{dt}(e^{i\frac{\hat{H}t}{\hbar}}) \hat{x} e^{-i\frac{\hat{H}t}{\hbar}} \\+ e^{i\frac{\hat{H}t}{\hbar}}(\frac{d}{dt} \hat{x})e^{-i\frac{\hat{H}t}{\hbar}} \\ + e^{i\frac{\hat{H}t}{\hbar}} \hat{x} \frac{d}{dt} (e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\begin{equation}
%PREM
     \frac{d}{dt} \hat{x} = 0
\end{equation}

\begin{multline}
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) =  \frac{d}{dt}(e^{i\frac{\hat{H}t}{\hbar}}) \hat{x} e^{-i\frac{\hat{H}t}{\hbar}} \\ + e^{i\frac{\hat{H}t}{\hbar}} \hat{x} \frac{d}{dt} (e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\subsection{Heisenberg picture: time evolution 2}

\begin{multline}
%PREM
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) =  \frac{d}{dt}(e^{i\frac{\hat{H}t}{\hbar}}) \hat{x} e^{-i\frac{\hat{H}t}{\hbar}} \\ + e^{i\frac{\hat{H}t}{\hbar}} \hat{x} \frac{d}{dt} (e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\begin{equation}
%PREM
    \frac{d}{dt}(e^{i\frac{\hat{H}t}{\hbar}}) = i\frac{\hat{H}}{\hbar} e^{i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt} (e^{-i\frac{\hat{H}t}{\hbar}}) = -i\frac{\hat{H}}{\hbar} e^{-i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{multline}
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) = (i\frac{\hat{H}}{\hbar} e^{i\frac{\hat{H}t}{\hbar}}) \hat{x} e^{-i\frac{\hat{H}t}{\hbar}} \\ + e^{i\frac{\hat{H}t}{\hbar}} \hat{x} (-i\frac{\hat{H}}{\hbar} e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\begin{multline}
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) = \frac{i}{\hbar}(\hat{H}e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}} - e^{i\frac{\hat{H}t}{\hbar}} \hat{x}\hat{H}   e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\subsection{Heisenberg picture: time evolution 3}

\begin{multline}
%PREM
    \frac{d}{dt} (e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}) = \frac{i}{\hbar}(\hat{H}e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}} - e^{i\frac{\hat{H}t}{\hbar}} \hat{x}\hat{H}   e^{-i\frac{\hat{H}t}{\hbar}})
\end{multline}

\begin{equation}
%PREM
    \hat{x}(t) = e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{equation}
    \frac{d}{dt}\hat{x}(t) = \frac{i}{\hbar}(\hat{H}e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}} - e^{i\frac{\hat{H}t}{\hbar}} \hat{x}\hat{H}   e^{-i\frac{\hat{H}t}{\hbar}})
\end{equation}

\begin{equation}
%PREM
    e^{-i\frac{\hat{H}t}{\hbar}} \hat{H} = \hat{H} e^{-i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{equation}
    \frac{d}{dt}\hat{x}(t) = \frac{i}{\hbar}(\hat{H}e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}} - e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}}\hat{H})
\end{equation}

\subsection{Heisenberg picture: time evolution 4}

\begin{equation}
%PREM
    \frac{d}{dt}\hat{x}(t) = \frac{i}{\hbar}(\hat{H}e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}} - e^{i\frac{\hat{H}t}{\hbar}} \hat{x}   e^{-i\frac{\hat{H}t}{\hbar}}\hat{H})
\end{equation}

\begin{equation}
%PREM
    \hat{x}(t) = e^{i\frac{\hat{H}t}{\hbar}} \hat{x} e^{-i\frac{\hat{H}t}{\hbar}}
\end{equation}

\begin{equation}
    \frac{d}{dt}\hat{x}(t) = \frac{i}{\hbar}(\hat{H}\hat{x}(t) - \hat{x}(t)\hat{H})
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{H}}{\hat{x}(t)} = \hat{H}\hat{x}(t) - \hat{x}(t)\hat{H}
\end{equation}

\begin{equation}
    \frac{d}{dt}\hat{x}(t) = \frac{i}{\hbar} \comm{\hat{H}}{\hat{x}(t)}
\end{equation}

\subsection{Heisenberg picture: position evolution}

\begin{equation}
%PREM
    \hat{H}(t) = \frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2}
\end{equation}

\begin{equation}
%PREM
    \frac{\partial \hat{H}(t)}{\partial \hat{p}(t)} = \frac{d \hat{x}(t)}{d t}
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{p}(t)} = \frac{\partial}{\partial \hat{p}(t)} (\frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2})
\end{equation}

\begin{equation}
    \frac{\partial}{\partial \hat{p}(t)} (\frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2}) = \frac{2\hat{p}(t)}{2m}
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{p}(t)} = \frac{\hat{p}(t)}{m}
\end{equation}

\subsection{Heisenberg picture: position evolution 2}

\begin{equation}
%PREM
   \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = - \frac{d \hat{p}(t)}{d t}
\end{equation}

\begin{equation}
%PREM
    \hat{H}(t) = \frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2}
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = \frac{\partial}{\partial \hat{x}(t)} (\frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2})
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = \frac{2m\omega^2\hat{x}(t)}{2}
\end{equation}

\begin{equation}
    \frac{\partial \hat{p}(t)}{dt} = -m\omega^2\hat{x}(t)
\end{equation}

\subsection{Heisenberg picture: position evolution 3}

\begin{equation}
%PREM
    \frac{d \hat{x}(t)}{d t} = \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \frac{d}{dt} \frac{d \hat{x}(t)}{d t} = \frac{d}{dt} \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \frac{d}{dt} \frac{d \hat{x}(t)}{d t} = \frac{1}{m} \frac{d \hat{p}(t)}{d t}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt}\frac{d\hat{x}}{dt} = \frac{d^2 \hat{x}(t)}{d t^2}
\end{equation}

\begin{equation}
    \frac{d^2 \hat{x}(t)}{d t^2} = \frac{1}{m} \frac{d \hat{p}(t)}{d t}
\end{equation}

\subsection{Heisenberg picture: position evolution 4}

\begin{equation}
%PREM
    \frac{\partial \hat{p}(t)}{dt} = -m\omega^2\hat{x}(t)
\end{equation}

\begin{equation}
%PREM
    \frac{d^2 \hat{x}(t)}{d t^2} = \frac{1}{m} \frac{d \hat{p}(t)}{d t}
\end{equation}

\begin{equation}
    \frac{d^2 \hat{x}(t)}{d t^2} = \frac{1}{m} (-m \omega^2 \hat{x}(t))
\end{equation}

\begin{equation}
     \frac{d^2 \hat{x}(t)}{d t^2} = -\omega^2 \hat{x}(t)
\end{equation}

\subsection{Heisenberg picture: position evolution 5}

\begin{equation}
%PREM
    \hat{x}(t) = A\cos(\omega t) + B \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d\hat{x}(t)}{dt} = \frac{d}{dt}(A\cos(\omega t) + B \sin(\omega t))
\end{equation}

\begin{equation}
    \frac{d\hat{x}(t)}{dt} = A\frac{d}{dt}\cos(\omega t) + B\frac{d}{dt} \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt}\cos(\omega t) = -\omega\sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \sin(\omega t) = \omega\cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d\hat{x}(t)}{dt} = -A\omega \sin(\omega t) + B\omega \cos(\omega t)
\end{equation}

\subsection{Heisenberg picture: position evolution 6}

\begin{equation}
%PREM
    \frac{d\hat{x}(t)}{dt} = -A\omega \sin(\omega t) + B\omega \cos(\omega t)
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{x}(t)}{dt}}_{t=0} = -A \omega \sin(0) + B\omega \cos(0)
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{x}(t)}{dt}}_{t=0} = B\omega
\end{equation}

\begin{equation}
%PREM
    \frac{d \hat{x}(t)}{d t} = \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{x}(t)}{dt}}_{t=0} = \frac{\hat{p}(0)}{m}
\end{equation}

\begin{equation}
    B\omega = \frac{\hat{p}(0)}{m}
\end{equation}

\begin{equation}
    B = \frac{\hat{p}(0)}{\omega m}
\end{equation}

\subsection{Heisenberg picture: position evolution 7}

\begin{equation}
%PREM
    \hat{x}(t) = A\cos(\omega t) + B \sin(\omega t)
\end{equation}

\begin{equation}
    \hat{x}(0) = A \cos(0) + B \sin(0)
\end{equation}

\begin{equation}
    \hat{x}(0) = A
\end{equation}

\begin{equation}
%PREM
    B = \frac{\hat{p}(0)}{\omega m}
\end{equation}

\begin{equation}
    \hat{x}(t) = \hat{x}(0) \cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \sin(\omega t)
\end{equation}

\subsection{Heisenberg picture: position evolution 8}

\begin{equation}
%PREM
    \hat{x}(t) = \hat{x}(0) \cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d \hat{x}(t)}{d t} = \frac{d}{d t} (\hat{x}(0) \cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \sin(\omega t))
\end{equation}

\begin{equation}
    \frac{d \hat{x}(t)}{d t} =  \hat{x}(0) \frac{d}{d t}\cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \frac{d}{d t}\sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \frac{d \hat{x}(t)}{d t} = \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \frac{\hat{p}(t)}{m} =  \hat{x}(0) \frac{d}{d t}\cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \frac{d}{d t}\sin(\omega t)
\end{equation}

\subsection{Heisenberg picture: position evolution 9}

\begin{equation}
%PREM
    \frac{\hat{p}(t)}{m} =  \hat{x}(0) \frac{d}{d t}\cos(\omega t) + \frac{\hat{p}(0)}{\omega m} \frac{d}{d t}\sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt}\cos(\omega t) = -\omega\sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \sin(\omega t) = \omega\cos(\omega t)
\end{equation}

\begin{equation}
     \frac{\hat{p}(t)}{m} = -\omega \hat{x}(0) \sin(\omega t) + \omega \frac{\hat{p}(0)}{\omega m} \cos(\omega t)
\end{equation}

\begin{equation}
     \hat{p}(t) = \hat{p}(0) \cos(\omega t) -\omega m \hat{x}(0) \sin(\omega t)
\end{equation}


\subsection{Heisenberg picture: momentum evolution 1}

\begin{equation}
%PREM
    \hat{H}(t) = \frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2}
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = \frac{\partial}{\partial \hat{x}(t)} (\frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2})
\end{equation}

\begin{equation}
    \frac{\partial}{\partial \hat{x}(t)} (\frac{\hat{p}(t)^2}{2m} + \frac{m\omega^2 \hat{x}(t)^2}{2}) = \frac{2m\omega^2\hat{x}(t)}{2}
\end{equation}

\begin{equation}
    \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = -m\omega^2\hat{x}(t)
\end{equation}

\begin{equation}
%PREM
    \frac{\partial \hat{H}(t)}{\partial \hat{x}(t)} = \frac{d\hat{p}(t)}{dt}
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = -m\omega^2\hat{x}(t)
\end{equation}

\subsection{Heisenberg picture: momentum evolution 2}

\begin{equation}
%PREM
    \frac{d\hat{p}(t)}{dt} = -m\omega^2\hat{x}(t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \frac{d\hat{p}(t)}{dt} =  \frac{d}{dt} (-m\omega^2\hat{x}(t))
\end{equation}

\begin{equation}
    \frac{d}{dt} \frac{d\hat{p}(t)}{dt} =  -m\omega^2  \frac{d\hat{x}(t)}{dt}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt} \frac{d\hat{p}(t)}{dt} =  \frac{d^2\hat{p}(t)}{dt^2}
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = -m\omega^2  \frac{d\hat{x}(t)}{dt}
\end{equation}

\subsection{Heisenberg picture: momentum evolution 3}

\begin{equation}
%PREM
    \frac{d^2\hat{p}(t)}{dt^2} = -m\omega^2  \frac{d\hat{x}(t)}{dt}
\end{equation}

\begin{equation}
%PREM
    \frac{d\hat{x}(t)}{dt} = \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = -m\omega^2 \frac{\hat{p}(t)}{m}
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = -\omega^2 \hat{p}(t)
\end{equation}

\subsection{Heisenberg picture: momentum evolution 4}

\begin{equation}
%PREM
    \hat{p}(t) = A\cos(\omega t) + B\sin(\omega t)
\end{equation}

\begin{equation}
    \hat{p}(0) = A\cos(0) + B\sin(0)
\end{equation}

\begin{equation}
    \hat{p}(0) = A
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = \frac{d}{dt} ( A\cos(\omega t) + B\sin(\omega t))
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} =  A\frac{d}{dt}\cos(\omega t) + B\frac{d}{dt}\sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt}\cos(\omega t) = -\omega \sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt}\sin(\omega t) = \omega \cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = -A\omega \sin(\omega t) + B\omega \cos(\omega t)
\end{equation}

\subsection{Heisenberg picture: momentum evolution 5}

\begin{equation}
%PREM
    \frac{d\hat{p}(t)}{dt} = -A\omega \sin(\omega t) + B\omega \cos(\omega t)
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{p}(t)}{dt}}_{t=0} = -A\omega \sin(0) + B\omega \cos(0)
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{p}(t)}{dt}}_{t=0} = B \omega
\end{equation}

\begin{equation}
%PREM
    \frac{d\hat{p}(t)}{dt} = -m\omega^2\hat{x}(t)
\end{equation}

\begin{equation}
    \eval{\frac{d\hat{p}(t)}{dt}}_{t=0} = -m\omega^2 \hat{x}(0)
\end{equation}

\begin{equation}
    B \omega = -m\omega^2 \hat{x}(0)
\end{equation}

\begin{equation}
    B = -m \omega \hat{x}(0)
\end{equation}


\subsection{Heisenberg picture: momentum evolution 6}

\begin{equation}
%PREM
     \hat{p}(t) = \hat{p}(0) \cos(\omega t) -\omega m \hat{x}(0) \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = \frac{d}{dt} ( \hat{p}(0) \cos(\omega t) -\omega m \hat{x}(0) \sin(\omega t) )
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = \frac{d}{dt} \hat{p}(0) \cos(\omega t) - \frac{d}{dt} \omega m \hat{x}(0) \sin(\omega t) 
\end{equation}

\begin{equation}
    \frac{d}{dt} \cos(\omega t) = -\omega\sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \sin(\omega t) = \omega\cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d\hat{p}(t)}{dt} = -\omega \hat{p}(0) \sin(\omega t) - \omega^2 m \hat{x}(0) \cos(\omega t)
\end{equation}

\subsection{Heisenberg picture: momentum evolution 7}

\begin{equation}
%PREM
    \frac{d\hat{p}(t)}{dt} = -\omega \hat{p}(0) \sin(\omega t) - \omega^2 m \hat{x}(0) \cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \frac{d\hat{p}(t)}{dt} = \frac{d}{dt} (-\omega \hat{p}(0) \sin(\omega t) - \omega^2 m \hat{x}(0) \cos(\omega t))
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dt} \frac{d\hat{p}(t)}{dt} = \frac{d^2\hat{p}(t)}{dt^2}
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = \frac{d}{dt} (-\omega \hat{p}(0) \sin(\omega t) - \omega^2 m \hat{x}(0) \cos(\omega t))
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} =  -\omega \hat{p}(0) \frac{d}{dt}\sin(\omega t) - \omega^2 m \hat{x}(0) \frac{d}{dt}\cos(\omega t)
\end{equation}

\subsection{Heisenberg picture: momentum evolution 8}

\begin{equation}
%PREM
    \frac{d^2\hat{p}(t)}{dt^2} =  -\omega \hat{p}(0) \frac{d}{dt}\sin(\omega t) - \omega^2 m \hat{x}(0) \frac{d}{dt}\cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \cos(\omega t) = -\omega\sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d}{dt} \sin(\omega t) = \omega\cos(\omega t)
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} =  -\omega^2 \hat{p}(0) \cos(\omega t) + \omega^3 m \hat{x}(0) \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = -\omega^2 ( \hat{p}(0) \cos(\omega t) - \omega m \hat{x}(0) \sin(\omega t) )
\end{equation}

\begin{equation}
%PREM
     \hat{p}(t) = \hat{p}(0) \cos(\omega t) -\omega m \hat{x}(0) \sin(\omega t)
\end{equation}

\begin{equation}
    \frac{d^2\hat{p}(t)}{dt^2} = -\omega^2 \hat{p}(t)
\end{equation}


\subsection{Heisenberg picture: position commutator 1}

\begin{equation}
%PREM
    \hat{x}(t) = \hat{x}_0 \cos(\omega t) + \frac{\hat{p}_0}{\omega m} \sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}(t_1)\hat{x}(t_2) - \hat{x}(t_2)\hat{x}(t_1)
\end{equation}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = (\hat{x}_0 \cos(\omega t_1) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_1)) \cdot \\ (\hat{x}_0 \cos(\omega t_2) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_2)) \\ - (\hat{x}_0 \cos(\omega t_2) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_2)) \cdot \\ (\hat{x}_0 \cos(\omega t_1) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_1))
\end{multline}


\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} (\cos(\omega t_1)\sin(\omega t_2) \\ - \cos(\omega t_2)\sin(\omega t_1)) \\ + \hat{p}_0\hat{x}_0\frac{1}{\omega m} (\sin(\omega t_1)\cos(\omega t_2) \\ - \sin(\omega t_2)\cos(\omega t_1))
\end{multline}


\subsection{Heisenberg picture: position commutator 2}

\begin{multline}
%PREM
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} (\cos(\omega t_1)\sin(\omega t_2) \\ - \cos(\omega t_2)\sin(\omega t_1)) \\ + \hat{p}_0\hat{x}_0\frac{1}{\omega m} (\sin(\omega t_1)\cos(\omega t_2) \\ - \sin(\omega t_2)\cos(\omega t_1))
\end{multline}

\begin{multline}
%PREM
    \sin(\omega t_1)\cos(\omega t_2) - \cos(\omega t_1)\sin(\omega t_2) \\ = \sin(\omega t_1 - \omega t_2)
\end{multline}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} \sin(\omega t_2 - \omega t_1) \\ + \hat{p}_0\hat{x}_0\frac{1}{\omega m} (\sin(\omega t_1)\cos(\omega t_2) \\ - \sin(\omega t_2)\cos(\omega t_1))
\end{multline}

\begin{multline}
%PREM
    \sin(\omega t_2)\cos(\omega t_1) - \cos(\omega t_2)\sin(\omega t_1) \\ = \sin(\omega t_2 - \omega t_1)
\end{multline}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} \sin(\omega t_2 - \omega t_1) \\ + \hat{p}_0\hat{x}_0\frac{1}{\omega m} \sin(\omega t_1 - \omega t_2)
\end{multline}

\subsection{Heisenberg picture: position commutator 3}

\begin{multline}
%PREM
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} \sin(\omega t_2 - \omega t_1) \\ + \hat{p}_0\hat{x}_0\frac{1}{\omega m} \sin(\omega t_1 - \omega t_2)
\end{multline}

\begin{equation}
%PREM
    \sin(\omega t_1 - \omega t_2) = - \sin(\omega t_2 - \omega t_1)
\end{equation}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \hat{x}_0\hat{p}_0\frac{1}{\omega m} \sin(\omega t_2 - \omega t_1) \\ -  \hat{p}_0\hat{x}_0\frac{1}{\omega m} \sin(\omega t_2 - \omega t_1)
\end{multline}

\begin{equation}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \frac{1}{\omega m} (\hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0) \sin(\omega t_2 - \omega t_1)
\end{equation}

\subsection{Heisenberg picture: position commutator 4}

\begin{equation}
%PREM
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \frac{1}{\omega m} (\hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0) \sin(\omega t_2 - \omega t_1)
\end{equation}

\begin{equation}
%PREM
    \hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0 = \comm{\hat{x}_0}{\hat{p}_0}
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{x}_0}{\hat{p}_0} = i\hbar
\end{equation}

\begin{equation}
    \hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0 = i\hbar
\end{equation}

\begin{equation}
    \comm{\hat{x}(t_1)}{\hat{x}(t_2)} = \frac{i\hbar}{\omega m} \sin(\omega t_2 - \omega t_1)
\end{equation}


\subsection{Heisenberg picture: momentum commutator}

\begin{equation}
%PREM
    \hat{p}(t) = \hat{p}_0 \cos(\omega t) - m\omega \hat{x}_0 \sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = \hat{p}(t_1)\hat{p}(t_2) - \hat{p}(t_2)\hat{p}(t_1)
\end{equation}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = (\hat{p}_0 \cos(\omega t_1) - m\omega \hat{x}_0 \sin(\omega t_1)) \cdot \\ (\hat{p}_0 \cos(\omega t_2) - m\omega \hat{x}_0 \sin(\omega t_2)) \\ + (\hat{p}_0 \cos(\omega t_2) - m\omega \hat{x}_0 \sin(\omega t_2)) \cdot \\ (\hat{p}_0 \cos(\omega t_1) - m\omega \hat{x}_0 \sin(\omega t_1))
\end{multline}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{p}_0 \hat{x}_0 (\cos(\omega t_2)\sin(\omega t_1) \\ - \cos(\omega t_1)\sin(\omega t_2)) \\ + m\omega \hat{x}_0 \hat{p}_0 (\sin(\omega t_2)\cos(\omega t_1) \\ - \sin(\omega t_1)\cos(\omega t_2))
\end{multline}

\subsection{Heisenberg picture: momentum commutator 2}

\begin{multline}
%PREM
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{p}_0 \hat{x}_0 (\cos(\omega t_2)\sin(\omega t_1) \\ - \cos(\omega t_1)\sin(\omega t_2)) \\ + m\omega \hat{x}_0 \hat{p}_0 (\sin(\omega t_2)\cos(\omega t_1) \\ - \sin(\omega t_1)\cos(\omega t_2))
\end{multline}

\begin{multline}
%PREM
    \sin(\omega t_1)\cos(\omega t_2) - \cos(\omega t_1)\sin(\omega t_2) \\ = \sin(\omega t_1 - \omega t_2)
\end{multline}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{p}_0 \hat{x}_0 (\cos(\omega t_2)\sin(\omega t_1) \\ - \cos(\omega t_1)\sin(\omega t_2)) \\ + m\omega \hat{x}_0 \hat{p}_0 \sin(\omega t_1 - \omega t_2)
\end{multline}

\begin{multline}
%PREM
    \sin(\omega t_2)\cos(\omega t_1) - \cos(\omega t_2)\sin(\omega t_1) \\ = \sin(\omega t_2 - \omega t_1)
\end{multline}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{p}_0 \hat{x}_0 \sin(\omega t_2 - \omega t_1) \\ + m\omega \hat{x}_0 \hat{p}_0 \sin(\omega t_1 - \omega t_2)
\end{multline}

\subsection{Heisenberg picture: momentum commutator 3}

\begin{multline}
%PREM
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{p}_0 \hat{x}_0 \sin(\omega t_2 - \omega t_1) \\ + m\omega \hat{x}_0 \hat{p}_0 \sin(\omega t_1 - \omega t_2)
\end{multline}

\begin{equation}
%PREM
    \sin(\omega t_1 - \omega t_2) = - \sin(\omega t_2 - \omega t_1)
\end{equation}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega \hat{x}_0\hat{p}_0 \sin(\omega t_2 - \omega t_1) \\ - m \omega \hat{p}_0\hat{x}_0 \sin(\omega t_2 - \omega t_1)
\end{multline}

\begin{multline}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = m\omega (\hat{x}_0\hat{p}_0 - \hat{x}_0\hat{p}_0) \sin(\omega t_2 - \omega t_1)
\end{multline}

\begin{equation}
%PREM
    \hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0 = i\hbar
\end{equation}

\begin{equation}
    \comm{\hat{p}(t_1)}{\hat{p}(t_2)} = i\hbar m\omega \sin(\omega t_2 - \omega t_1)
\end{equation}



\subsection{Heisenberg picture: position-momentum commutator}

\begin{equation}
%PREM
    \hat{x}(t) = \hat{x}_0 \cos(\omega t) + \frac{\hat{p}_0}{\omega m} \sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \hat{p}(t) = \hat{p}_0 \cos(\omega t) - m\omega \hat{x}_0 \sin(\omega t)
\end{equation}

\begin{equation}
%PREM
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = \hat{x}(t_1)\hat{p}(t_2) - \hat{p}(t_2)\hat{x}(t_1)
\end{equation}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = (\hat{x}_0 \cos(\omega t_1) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_1)) \cdot \\ (\hat{p}_0 \cos(\omega t_2) - m\omega \hat{x}_0 \sin(\omega t_2)) \\ + (\hat{x}_0 \cos(\omega t_2) + \frac{\hat{p}_0}{\omega m} \sin(\omega t_2)) \cdot \\ (\hat{p}_0 \cos(\omega t_1) - m\omega \hat{x}_0 \sin(\omega t_1))
\end{multline}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = \hat{x}_0 \hat{p}_0 (\cos(\omega t_2) \cos(\omega t_1) \\ + \sin(\omega t_2) \sin(\omega t_1))  \\ - \hat{p}_0 \hat{x}_0 (\sin(\omega t_2) \sin(\omega t_1)) \\ + \cos(\omega t_2) \cos(\omega t_1))
\end{multline}

\subsection{Heisenberg picture: position-momentum commutator 2}

\begin{multline}
%PREM
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = \hat{x}_0 \hat{p}_0 (\cos(\omega t_2) \cos(\omega t_1) \\ + \sin(\omega t_2) \sin(\omega t_1))  \\ - \hat{p}_0 \hat{x}_0 (\sin(\omega t_2) \sin(\omega t_1)) \\ + \cos(\omega t_2) \cos(\omega t_1))
\end{multline}

\begin{multline}
%PREM
    \cos(\omega t_1) \cos(\omega t_2) +  \sin(\omega t_1)\sin(\omega t_2) \\ = \cos(\omega t_2 - \omega t_1)
\end{multline}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = \hat{x}_0 \hat{p}_0 \cos(\omega t_2 - \omega t_1) \\ - \hat{p}_0 \hat{x}_0 \cos(\omega t_2 - \omega t_1)
\end{multline}

\begin{multline}
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = (\hat{x}_0 \hat{p}_0 - \hat{p}_0 \hat{x}_0) \cos(\omega t_2 - \omega t_1)
\end{multline}

\begin{equation}
%PREM
    \hat{x}_0\hat{p}_0 - \hat{p}_0\hat{x}_0 = i\hbar
\end{equation}

\begin{equation}
    \comm{\hat{x}(t_1)}{\hat{p}(t_2)} = i \hbar \cos(\omega t_2 - \omega t_1)
\end{equation}





\subsection{Vacuum Rabi Oscillations: excited state probability}

\begin{equation}
%PREM
    \ket{\Psi(t)} = \cos(\frac{\Omega t}{2})\ket{e,0} - i\sin(\frac{\Omega t}{2})\ket{g,1}
\end{equation}

\begin{equation}
%PREM
    P_e(t) = |\braket{e,0}{\Psi(t)}|^2
\end{equation}

\begin{multline}
    P_e(t) = |\bra{e,0}(\cos(\frac{\Omega t}{2})\ket{e,0} \\ - i\sin(\frac{\Omega t}{2})\ket{g,1})|^2
\end{multline}

\begin{multline}
     P_e(t) = |\bra{e,0}\cos(\frac{\Omega t}{2})\ket{e,0} \\ - \bra{e,0}i\sin(\frac{\Omega t}{2})\ket{g,1}|^2
\end{multline}

\begin{multline}
    P_e(t) = |\cos(\frac{\Omega t}{2})\braket{e,0}{e,0} \\ - i\sin(\frac{\Omega t}{2})\braket{e,0}{g,1}|^2
\end{multline}

\begin{equation}
%PREM
    \braket{e,0}{e,0} = 1
\end{equation}

\begin{equation}
%PREM
    \braket{e,0}{g,1} = 0
\end{equation}

\begin{equation}
    P_e(t) = |\cos(\frac{\Omega t}{2})|^2
\end{equation}

\begin{equation}
     P_e(t) = \cos^2(\frac{\Omega t}{2})
\end{equation}

\subsection{Vacuum Rabi Oscillations: ground state probability}

\begin{equation}
%PREM
    \ket{\Psi(t)} = \cos(\frac{\Omega t}{2})\ket{e,0} - i\sin(\frac{\Omega t}{2})\ket{g,1}
\end{equation}

\begin{equation}
%PREM
    P_g(t) = |\braket{g,1}{\Psi(t)}|^2
\end{equation}

\begin{multline}
    P_g(t) = |\bra{g,1}(\cos(\frac{\Omega t}{2})\ket{e,0} \\ - i\sin(\frac{\Omega t}{2})\ket{g,1})|^2
\end{multline}

\begin{multline}
     P_g(t) = |\bra{g,1}\cos(\frac{\Omega t}{2})\ket{e,0} \\ - \bra{g,1}i\sin(\frac{\Omega t}{2})\ket{g,1}|^2
\end{multline}

\begin{multline}
    P_g(t) = |\cos(\frac{\Omega t}{2})\braket{g,1}{e,0} \\ - i\sin(\frac{\Omega t}{2})\braket{g,1}{g,1}|^2
\end{multline}

\subsection{Vacuum Rabi Oscillations: ground state probability 2}

\begin{multline}
%PREM
    P_g(t) = |\cos(\frac{\Omega t}{2})\braket{g,1}{e,0} \\ - i\sin(\frac{\Omega t}{2})\braket{g,1}{g,1}|^2
\end{multline}

\begin{equation}
%PREM
    \braket{g,1}{e,0} = 0
\end{equation}

\begin{equation}
%PREM
    \braket{g,1}{g,1} = 1
\end{equation}

\begin{equation}
    P_g(t) = | - i\sin(\frac{\Omega t}{2})|^2
\end{equation}

\begin{equation}
    P_g(t) = |- i|^2 |\sin(\frac{\Omega t}{2})|^2
\end{equation}

\begin{equation}
%PREM
    |- i|^2=1
\end{equation}

\begin{equation}
    P_g(t) = \sin^2(\frac{\Omega t}{2})
\end{equation}

\subsection{Expectation value: integral expression}

\begin{equation}
%PREM
    \expval{\hat{X}}_{\Psi} = \bra{\Psi}\hat{X}\ket{\Psi}
\end{equation}

\begin{equation}
%PREM
    \hat{X} = \mathbb{I}\hat{X}\mathbb{I}
\end{equation}

\begin{equation}
    \expval{\hat{X}}_{\Psi} = \bra{\Psi}\mathbb{I}\hat{X}\mathbb{I}\ket{\Psi}
\end{equation}

\begin{equation}
%PREM
    \mathbb{I} = \int \ket{x}\bra{x}dx
\end{equation}

\begin{multline}
     \expval{\hat{X}}_{\Psi} = \bra{\Psi}(\int \ket{x}\bra{x}dx)\hat{X}(\int \ket{x'}\bra{x'}dx')\ket{\Psi}
\end{multline}

\begin{multline}
     \expval{\hat{X}}_{\Psi} = \int \int \braket{\Psi}{x}\bra{x}\hat{X}\ket{x'} \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\subsection{Expectation value: integral expression 2}

\begin{multline}
%PREM
     \expval{\hat{X}}_{\Psi} = \int \int \braket{\Psi}{x}\bra{x}\hat{X}\ket{x'} \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\begin{equation}
%PREM
    \hat{X}\ket{x'} = x'\ket{x'}
\end{equation}

\begin{multline}
     \expval{\hat{X}}_{\Psi} = \int \int \braket{\Psi}{x}\bra{x}x'\ket{x'} \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\begin{equation}
%PREM
    \braket{\Psi}{x} = \braket{x}{\Psi}^{\dagger}
\end{equation}

\begin{multline}
     \expval{\hat{X}}_{\Psi} = \int \int \braket{x}{\Psi}^{\dagger}x'\braket{x}{x'} \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\begin{equation}
%PREM
    \braket{x}{x'} = \delta(x-x')
\end{equation}

\begin{multline}
     \expval{\hat{X}}_{\Psi} = \int \int \braket{x}{\Psi}^{\dagger}x'\delta(x-x') \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\subsection{Expectation value: integral expression 3}

\begin{multline}
%PREM
     \expval{\hat{X}}_{\Psi} = \int \int \braket{x}{\Psi}^{\dagger}x'\delta(x-x') \\ \braket{x'}{\Psi}dx dx'
\end{multline}

\begin{multline}
%PREM
     \int \braket{x}{\Psi}^{\dagger}x'\delta(x-x') \braket{x'}{\Psi} dx' \\ = \braket{x}{\Psi}^{\dagger}x \braket{x}{\Psi}
\end{multline}

\begin{equation}
    \expval{\hat{X}}_{\Psi} = \int \braket{x}{\Psi}^{\dagger}x\braket{x}{\Psi} dx
\end{equation}

\begin{equation}
%PREM
    \braket{x}{\Psi} = \Psi(x)
\end{equation}

\begin{equation}
    \expval{\hat{X}}_{\Psi} = \int \Psi^{\dagger}(x) x \Psi(x) dx
\end{equation}

\begin{equation}
%PREM
    \Psi^{\dagger}(x) \Psi(x) = |\Psi(x)|^2
\end{equation}

\begin{equation}
    \expval{\hat{X}}_{\Psi} = \int x |\Psi(x)|^2 dx
\end{equation}

\subsection{Hellmann–Feynman theorem}

\begin{equation}
%PREM
    \hat{H}_\lambda\ket{\Psi_\lambda} = E_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{equation}
   \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda} = \bra{\Psi_\lambda} E_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{equation}
    E_\lambda \braket{\Psi_\lambda}{\Psi_\lambda} = \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{equation}
%PREM    
    \braket{\Psi_\lambda}{\Psi_\lambda} = 1
\end{equation}

\begin{equation}
     E_\lambda = \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{equation}
    \frac{d E_\lambda}{d\lambda} = \frac{d}{d\lambda} \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda}
\end{equation}

\subsection{Hellmann–Feynman theorem 2}

\begin{equation}
%PREM
    \frac{d E_\lambda}{d\lambda} = \frac{d}{d\lambda} \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{multline}
%PREM
    \frac{d}{d\lambda} \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\Psi_\lambda} = \bra{\frac{d \Psi_\lambda}{d\lambda}} \hat{H}_\lambda\ket{\Psi_\lambda} \\ + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda}\\ + \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\frac{d \Psi_\lambda}{d\lambda}}
\end{multline}

\begin{multline}
    \frac{d E_\lambda}{d\lambda} = \bra{\frac{d \Psi_\lambda}{d\lambda}} \hat{H}_\lambda\ket{\Psi_\lambda} \\ + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda}\\ + \bra{\Psi_\lambda} \hat{H}_\lambda\ket{\frac{d \Psi_\lambda}{d\lambda}}
\end{multline}

\begin{equation}
%PREM
    \bra{\Psi_\lambda}\hat{H}_\lambda = \bra{\Psi_\lambda}E_\lambda
\end{equation}

\begin{equation}
%PREM
    \hat{H}_\lambda\ket{\Psi_\lambda} = E_\lambda\ket{\Psi_\lambda}
\end{equation}

\begin{multline}
    \frac{d E_\lambda}{d\lambda} = E_\lambda \bra{\frac{d \Psi_\lambda}{d\lambda}}\ket{\Psi_\lambda} + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda} \\ +  E_\lambda \bra{\Psi_\lambda}\ket{\frac{d \Psi_\lambda}{d\lambda}}
\end{multline}

\subsection{Hellmann–Feynman theorem 3}

\begin{multline}
%PREM
    \frac{d E_\lambda}{d\lambda} = E_\lambda \bra{\frac{d \Psi_\lambda}{d\lambda}}\ket{\Psi_\lambda} + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda} \\ +  E_\lambda \bra{\Psi_\lambda}\ket{\frac{d \Psi_\lambda}{d\lambda}}
\end{multline}

\begin{multline}
    \frac{d E_\lambda}{d\lambda} = E_\lambda (\bra{\frac{d \Psi_\lambda}{d\lambda}}\ket{\Psi_\lambda} + \bra{\Psi_\lambda}\ket{\frac{d \Psi_\lambda}{d\lambda}}) \\ + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda}
\end{multline}

\begin{equation}
%PREM
    \bra{\frac{d \Psi_\lambda}{d\lambda}}\ket{\Psi_\lambda} + \bra{\Psi_\lambda}\ket{\frac{d \Psi_\lambda}{d\lambda}} = \frac{d}{d\lambda} \braket{\Psi_\lambda}{\Psi_\lambda}
\end{equation}

\begin{equation}
    \frac{d E_\lambda}{d\lambda} = E_\lambda \frac{d}{d\lambda} \braket{\Psi_\lambda}{\Psi_\lambda} + \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{d\lambda} \braket{\Psi_\lambda}{\Psi_\lambda} = 0
\end{equation}

\begin{equation}
    \frac{d E_\lambda}{d\lambda} = \bra{\Psi_\lambda} \frac{d\hat{H}_\lambda}{d\lambda} \ket{\Psi_\lambda}
\end{equation}





\subsection{Hellmann–Feynman theorem: time-dependent wavefunctions}

\begin{multline}
%PREM
    \frac{\partial}{\partial \lambda} \bra{\Psi_\lambda(t)} \hat{H}_\lambda \ket{\Psi_\lambda(t)} = \bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} \hat{H}_\lambda \ket{\Psi_\lambda(t)} \\ + \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)}  \\ + \bra{\Psi_\lambda(t)} \hat{H}_\lambda \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}
\end{multline}

\begin{multline}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} = \frac{\partial}{\partial \lambda} \bra{\Psi_\lambda(t)} \hat{H}_\lambda \ket{\Psi_\lambda(t)} \\ - \bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} \hat{H}_\lambda \ket{\Psi_\lambda(t)} \\ - \bra{\Psi_\lambda(t)} \hat{H}_\lambda \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}
\end{multline}

\begin{equation}
%PREM
    i \hbar \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} = \hat{H}_\lambda \ket{\Psi_\lambda(t)}
\end{equation}

\begin{equation}
%PREM
    - i \hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} = \bra{\Psi_\lambda(t)} \hat{H}_\lambda 
\end{equation}

\begin{multline}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} =  \frac{\partial}{\partial \lambda}  \bra{\Psi_\lambda(t)} i\hbar \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ - \bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} i\hbar \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ - (-i\hbar) \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} 
\end{multline}

\begin{multline}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} =  i\hbar \frac{\partial}{\partial \lambda}  \bra{\Psi_\lambda(t)} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ - i\hbar\bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}  \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ + i\hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} 
\end{multline}

\subsection{Hellmann–Feynman theorem: time-dependent wavefunctions 2}

\begin{multline}
%PREM
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} =  i\hbar \frac{\partial}{\partial \lambda}  \bra{\Psi_\lambda(t)} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ - i\hbar\bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}  \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ + i\hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} 
\end{multline}

\begin{multline}
%PREM \\
    \frac{\partial}{\partial \lambda}  \bra{\Psi_\lambda(t)} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} = \bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ + \bra{\Psi_\lambda(t)} \ket{\frac{\partial^2 \Psi_\lambda(t)}{\partial \lambda \partial t}} 
\end{multline}

\begin{multline}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} =  i\hbar (\bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ + \bra{\Psi_\lambda(t)} \ket{\frac{\partial^2 \Psi_\lambda(t)}{\partial \lambda \partial t}} ) \\- i\hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial t}} \\ + i\hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}
\end{multline}

\begin{multline}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} = i\hbar \bra{\Psi_\lambda(t)} \ket{\frac{\partial^2 \Psi_\lambda(t)}{\partial \lambda \partial t}} \\ + i\hbar \bra{\frac{\partial \Psi_\lambda(t)}{\partial t}} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}
\end{multline}

\begin{equation}
    \bra{\Psi_\lambda(t)} \frac{\partial \hat{H}_\lambda}{\partial \lambda} \ket{\Psi_\lambda(t)} = i\hbar \frac{\partial}{\partial t} \bra{\Psi_\lambda(t)} \ket{\frac{\partial \Psi_\lambda(t)}{\partial \lambda}}
\end{equation}




\section{Other}
\label{app:other}

\subsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$}

\begin{equation}
%PREM
    g_{\varepsilon}(x) = f(x) + \varepsilon\eta(x)
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}}{d\varepsilon} = \frac{d}{d\varepsilon}(f(x) + \varepsilon\eta(x))
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}}{d\varepsilon} = \frac{df(x)}{d\varepsilon} + \frac{d}{d\varepsilon}(\varepsilon\eta(x))
\end{equation}

\begin{equation}
%PREM
    \frac{df(x)}{d\varepsilon} = 0
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}}{d\varepsilon} = \frac{d}{d\varepsilon}(\varepsilon\eta(x))
\end{equation}

\subsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$ 2}

\begin{equation}
%PREM
    \frac{dg_{\varepsilon}}{d\varepsilon} = \frac{d}{d\varepsilon}(\varepsilon\eta(x))
\end{equation}

\begin{equation}
%PREM
    \frac{d}{d\varepsilon}(\varepsilon\eta(x)) = \eta(x) + \varepsilon\frac{d\eta(x)}{d\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \frac{d\eta(x)}{d\varepsilon} = 0
\end{equation}

\begin{equation}
    \frac{d}{d\varepsilon}(\varepsilon\eta(x)) = \eta(x)
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}}{d\varepsilon} = \eta(x)
\end{equation}

\subsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$ 3}

\begin{equation}
%PREM
    L_{\varepsilon} = L(x, g_{\varepsilon}(x), g_{\varepsilon}'(x))
\end{equation}

\begin{equation}
%PREM
    dL_{\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial x}dx + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}dg_{\varepsilon} + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}dg_{\varepsilon}'
\end{equation}

\begin{equation}
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial x}\frac{dx}{d\varepsilon} + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\frac{dg_{\varepsilon}}{d\varepsilon} + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}\frac{dg_{\varepsilon}'}{d\varepsilon}
\end{equation}

\begin{equation}
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\frac{dg_{\varepsilon}}{d\varepsilon} + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}\frac{dg_{\varepsilon}'}{d\varepsilon}
\end{equation}

\begin{equation}
%PREM
    \frac{dg_{\varepsilon}}{d\varepsilon} = \eta(x)
\end{equation}

\begin{equation}
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x) + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}\frac{dg_{\varepsilon}'}{d\varepsilon}
\end{equation}

\subsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$ 4}

\begin{equation}
%PREM
    \frac{dg_{\varepsilon}}{d\varepsilon} = \eta(x)
\end{equation}

\begin{equation}
    \frac{d}{dx}\frac{dg_{\varepsilon}}{d\varepsilon} = \frac{d}{dx}\eta(x)
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dx}\frac{dg_{\varepsilon}}{d\varepsilon} = \frac{dg_{\varepsilon}'}{d\varepsilon}
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}'}{d\varepsilon} = \frac{d}{dx}\eta(x)
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dx}\eta(x) = \eta '(x)
\end{equation}

\begin{equation}
    \frac{dg_{\varepsilon}'}{d\varepsilon} = \eta '(x)
\end{equation}

\begin{equation}
%PREM
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x) + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}\frac{dg_{\varepsilon}'}{d\varepsilon}
\end{equation}

\begin{equation}
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x) + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)
\end{equation}



\subsection{Euler-Lagrange equation: Derivation}

\begin{equation}
%PREM
    J = \int_{a}^{b}L(x, f(x), f'(x))
\end{equation}

\begin{equation}
%PREM
    g_{\varepsilon}(x) = f(x) + \varepsilon\eta(x)
\end{equation}

\begin{equation}
%PREM
    J_{\varepsilon} = \int_{a}^{b}L(x, g_{\varepsilon}(x), g_{\varepsilon}'(x))dx
\end{equation}

\begin{equation}
%PREM
    L_{\varepsilon} = L(x, g_{\varepsilon}(x), g_{\varepsilon}'(x))
\end{equation}

\begin{equation}
    J_{\varepsilon} = \int_{a}^{b}L_{\varepsilon}dx
\end{equation}

\begin{equation}
    \frac{dJ_{\varepsilon}}{d\varepsilon} = \frac{d}{d\varepsilon}\int_{a}^{b}L_{\varepsilon}dx
\end{equation}

\begin{equation}
    \frac{dJ_{\varepsilon}}{d\varepsilon} = \int_{a}^{b}\frac{dL_{\varepsilon}}{d\varepsilon}dx
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 2}

\begin{equation}
%PREM
    \frac{dJ_{\varepsilon}}{d\varepsilon} = \int_{a}^{b}\frac{dL_{\varepsilon}}{d\varepsilon}dx
\end{equation}

\begin{equation}
%PREM
    \frac{dL_{\varepsilon}}{d\varepsilon} = \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x) + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)
\end{equation}

\begin{equation}
    \frac{dJ_{\varepsilon}}{d\varepsilon} = \int_{a}^{b}(\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x) + \frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x))dx
\end{equation}

\begin{equation}
    \frac{dJ_{\varepsilon}}{d\varepsilon} = \int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x)dx + \int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)dx
\end{equation}

\begin{equation}
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x)dx + \int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)dx)}_{\varepsilon = 0}
\end{equation}

\begin{equation}
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x)dx)}_{\varepsilon = 0} + \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)dx)}_{\varepsilon = 0}
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 3}

\begin{equation}
%PREM
    L = L(x, f(x), f'(x))
\end{equation}

\begin{equation}
%PREM
    g_{\varepsilon}(x) = f(x) + \varepsilon\eta(x)
\end{equation}

\begin{equation}
%PREM
    L_{\varepsilon} = L(x, g_{\varepsilon}(x), g_{\varepsilon}'(x))
\end{equation}

\begin{equation}
%PREM
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x)dx)}_{\varepsilon = 0} + \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'} \eta '(x)dx)}_{\varepsilon = 0}
\end{equation}

\begin{equation}
    \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}}\eta(x)dx)}_{\varepsilon = 0} = \int_{a}^{b}\frac{\partial L}{\partial f}\eta(x)dx
\end{equation}

\begin{equation}
    \eval{(\int_{a}^{b}\frac{\partial L_{\varepsilon}}{\partial g_{\varepsilon}'}\eta'(x)dx)}_{\varepsilon = 0} = \int_{a}^{b}\frac{\partial L}{\partial f'}\eta'(x)dx
\end{equation}

\begin{equation}
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \int_{a}^{b}\frac{\partial L}{\partial f}\eta(x)dx + \int_{a}^{b}\frac{\partial L}{\partial f'}\eta'(x)dx
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 4}

\begin{equation}
%PREM
    \frac{dv}{dx} = \eta'(x)
\end{equation}

\begin{equation}
%PREM
    v = \int\frac{dv}{dx}dx 
\end{equation}

\begin{equation}
    v = \int\eta'(x)dx 
\end{equation}

\begin{equation}
%PREM
    \eta'(x) = \frac{d\eta(x)}{dx}
\end{equation}

\begin{equation}
    v = \int\frac{d\eta(x)}{dx}dx 
\end{equation}

\begin{equation}
    v = \eta(x)
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 5}

\begin{equation}
%PREM
    u = \frac{\partial L}{\partial f'}
\end{equation}

\begin{equation}
%PREM
    v = \eta(x)
\end{equation}

\begin{equation}
   uv = \frac{\partial L}{\partial f'}\eta(x)
\end{equation}

\begin{equation}
   \eval{(uv)}_a^b = \eval{(\frac{\partial L}{\partial f'}\eta(x))}_a^b
\end{equation}

\begin{equation}
   \eval{(uv)}_a^b = \frac{\partial L}{\partial f'}\eta(b) - \frac{\partial L}{\partial f'}\eta(a)
\end{equation}

\begin{equation}
%PREM
   \eta(a) = 0 
\end{equation}

\begin{equation}
%PREM
   \eta(b) = 0 
\end{equation}

\begin{equation}
   \eval{(uv)}_a^b = 0
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 6}

\begin{equation}
%PREM
    I = \int_{a}^{b}\frac{\partial L}{\partial f'}\eta'(x)dx
\end{equation}

\begin{equation}
%PREM
    I = \eval{(uv)}_a^b - \int_a^bv\frac{du}{dx}dx
\end{equation}

\begin{equation}
%PREM
   \eval{(uv)}_a^b = 0
\end{equation}

\begin{equation}
    I = - \int_a^bv\frac{du}{dx}dx
\end{equation}

\begin{equation}
%PREM
    \frac{du}{dx} = \frac{d}{dx}\frac{\partial L}{\partial f'}
\end{equation}

\begin{equation}
    v = \eta(x)
\end{equation}

\begin{equation}
    I = - \int_a^b\eta(x)\frac{d}{dx}\frac{\partial L}{\partial f'}dx
\end{equation}

\subsection{Euler-Lagrange equation: Derivation 7}

\begin{equation}
%PREM
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \int_{a}^{b}\frac{\partial L}{\partial f}\eta(x)dx + \int_{a}^{b}\frac{\partial L}{\partial f'}\eta'(x)dx
\end{equation}

\begin{equation}
%PREM
    \int_{a}^{b}\frac{\partial L}{\partial f'}\eta'(x)dx = - \int_a^b\eta(x)\frac{d}{dx}\frac{\partial L}{\partial f'}dx
\end{equation}

\begin{equation}
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \int_{a}^{b}\frac{\partial L}{\partial f}\eta(x)dx - \int_a^b\eta(x)\frac{d}{dx}\frac{\partial L}{\partial f'}dx
\end{equation}

\begin{equation}
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = \int_{a}^{b}\eta(x)(\frac{\partial L}{\partial f} - \frac{d}{dx}\frac{\partial L}{\partial f'})dx
\end{equation}

\begin{equation}
%PREM
    \eval{\frac{dJ_{\varepsilon}}{d\varepsilon}}_{\varepsilon = 0} = 0
\end{equation}

\begin{equation}
    \int_{a}^{b}\eta(x)(\frac{\partial L}{\partial f} - \frac{d}{dx}\frac{\partial L}{\partial f'})dx = 0
\end{equation}

\begin{equation}
    \frac{\partial L}{\partial f} - \frac{d}{dx}\frac{\partial L}{\partial f'} = 0
\end{equation}

\subsection{Euler-Lagrange equation: Straight line}

\begin{equation}
%PREM
    S = \int_a^bds
\end{equation}

\begin{equation}
%PREM
    ds = \sqrt{dx^2 + dy^2}
\end{equation}

\begin{equation}
    ds = \sqrt{dx^2 + (\frac{dy}{dx})^2dx^2}
\end{equation}

\begin{equation}
    ds = \sqrt{(1 + (\frac{dy}{dx})^2)dx^2}
\end{equation}

\begin{equation}
    ds = \sqrt{(1 + (\frac{dy}{dx})^2)}dx
\end{equation}

\begin{equation}
%PREM
    y' = \frac{dy}{dx}
\end{equation}

\begin{equation}
    ds = \sqrt{(1 + y'^2)}dx
\end{equation}

\begin{equation}
    \int_a^b ds = \int_a^b \sqrt{(1 + y'^2)}dx
\end{equation}

\begin{equation}
    S = \int_a^b\sqrt{(1 + y'^2)}dx
\end{equation}

\subsection{Euler-Lagrange equation: Straight line 2}

\begin{equation}
%PREM
    L = (1 + y'^2)^\frac{1}{2}
\end{equation}

\begin{equation}
%PREM
    u = 1 + y'^2
\end{equation}

\begin{equation}
    \frac{du}{dy'} = 2y'
\end{equation}

\begin{equation}
    L = u^\frac{1}{2}
\end{equation}

\begin{equation}
    \frac{dL}{du} = \frac{1}{2}u^{-\frac{1}{2}}
\end{equation}

\begin{equation}
    \frac{dL}{dy'} = \frac{dL}{du}\frac{du}{dy'}
\end{equation}

\begin{equation}
    \frac{dL}{dy'} = (\frac{1}{2}u^{-\frac{1}{2}})(2y')
\end{equation}

\begin{equation}
    \frac{dL}{dy'} = y'u^{-\frac{1}{2}}
\end{equation}

\begin{equation}
    \frac{dL}{dy'} = y'(1 + y'^2)^{-\frac{1}{2}}
\end{equation}

\subsection{Euler-Lagrange equation: Straight line 3}

\begin{equation}
%PREM
    \frac{dL}{dy} - \frac{d}{dx}\frac{dL}{dy'} = 0
\end{equation}

\begin{equation}
%PREM
    \frac{dL}{dy} = 0
\end{equation}

\begin{equation}
    \frac{d}{dx}\frac{dL}{dy'} = 0
\end{equation}

\begin{equation}
%PREM
    \frac{dL}{dy'} = y'(1 + y'^2)^{-\frac{1}{2}}
\end{equation}

\begin{equation}
    \frac{d}{dx}(y'(1 + y'^2)^{-\frac{1}{2}}) = 0
\end{equation}

\begin{equation}
    \int\frac{d}{dx}(y'(1 + y'^2)^{-\frac{1}{2}})dx = C
\end{equation}

\subsection{Euler-Lagrange equation: Straight line 4}

\begin{equation}
%PREM
    \int\frac{d}{dx}(y'(1 + y'^2)^{-\frac{1}{2}})dx = C
\end{equation}

\begin{equation}
    \int\frac{d}{dx}(y'(1 + y'^2)^{-\frac{1}{2}})dx = y'(1 + y'^2)^{-\frac{1}{2}}
\end{equation}

\begin{equation}
    y'(1 + y'^2)^{-\frac{1}{2}} = C
\end{equation}

\begin{equation}
    y'^2(1 + y'^2)^{-1} = C^2
\end{equation}

\begin{equation}
    y'^2 = C^2(1 + y'^2)
\end{equation}

\subsection{Euler-Lagrange equation: Straight line 5}

\begin{equation}
%PREM
    y'^2 = C^2(1 + y'^2)
\end{equation}

\begin{equation}
    y'^2 = C^2y'^2 + C^2
\end{equation}

\begin{equation}
    y'^2 - C^2y'^2 = C^2
\end{equation}

\begin{equation}
    y'^2(1 - C^2) = C^2
\end{equation}

\begin{equation}
    y'^2 = C^2(1 - C^2)^{-1}
\end{equation}

\begin{equation}
    y' = C(1 - C^2)^{-1/2}
\end{equation}

\subsection{Euler-Lagrange equation: Straight line 6}

\begin{equation}
%PREM
    \frac{dy}{dx} = C(1 - C^2)^{-1/2}
\end{equation}

\begin{equation}
%PREM
    C(1 - C^2)^{-1/2} = A
\end{equation}

\begin{equation}
    \frac{dy}{dx} = A
\end{equation}

\begin{equation}
    \int\frac{dy}{dx}dx = \int Adx
\end{equation}

\begin{equation}
%PREM
   \int \frac{dy}{dx}dx = Ax + C
\end{equation}

\begin{equation}
    y = Ax + C
\end{equation}

\subsection{Escape velocity}

\begin{equation}
%PREM
    F = \frac{GMm}{r^2}
\end{equation}

\begin{equation}
%PREM
    dW = Fdr
\end{equation}

\begin{equation}
    dW = \frac{GMm}{r^2} dr
\end{equation}

\begin{equation}
    \int_{r_0}^{\infty} dW = \int_{r_0}^{\infty} \frac{GMm}{r^2} dr
\end{equation}

\begin{equation}
%PREM
    W = \int_{r_0}^{\infty} dW
\end{equation}

\begin{equation}
    W = \int_{r_0}^{\infty} \frac{GMm}{r^2} dr
\end{equation}

\subsection{Escape velocity 2}

\begin{equation}
%PREM
    W = \int_{r_0}^{\infty} \frac{GMm}{r^2} dr
\end{equation}

\begin{equation}
    \int_{r_0}^{\infty} \frac{GMm}{r^2} dr = GMm ((-\frac{1}{\infty}) - (-\frac{1}{r_0}))
\end{equation}

\begin{equation}
    \int_{r_0}^{\infty} \frac{GMm}{r^2} dr = \frac{GMm}{r_0}
\end{equation}

\begin{equation}
    W = \frac{GMm}{r_0}
\end{equation}

\begin{equation}
%PREM
    F = \frac{GMm}{r^2}
\end{equation}

\begin{equation}
%PREM
    F=mg
\end{equation}

\begin{equation}
    \frac{GMm}{r_0^2} = mg
\end{equation}

\begin{equation}
    GM = gr_0^2
\end{equation}

\begin{equation}
    W = mgr_0
\end{equation}

\subsection{Escape velocity 3}

\begin{equation}
%PREM
    W = mgr_0
\end{equation}

\begin{equation}
%PREM
    E = \frac{1}{2}mv_{esc}^2
\end{equation}

\begin{equation}
%PREM
    W = E
\end{equation}

\begin{equation}
    \frac{1}{2}mv_{esc}^2 = mgr_0
\end{equation}

\begin{equation}
    v_{esc}^2 = 2gr_0
\end{equation}

\begin{equation}
    v_{esc} = \sqrt{2gr_0}
\end{equation}

\subsection{Terminal velocity}

\begin{equation}
%PREM
    F = mg - \frac{1}{2}\rho v_F^2 A C_d
\end{equation}

\begin{equation}
%PREM
    F = 0
\end{equation}

\begin{equation}
    mg - \frac{1}{2}\rho v_0^2 A C_d = 0
\end{equation}

\begin{equation}
    mg = \frac{1}{2}\rho v_0^2 A C_d
\end{equation}

\begin{equation}
    \frac{2mg}{\rho C_d A} = v_0^2
\end{equation}

\begin{equation}
    v_0 = \sqrt{\frac{2mg}{\rho C_d A}}
\end{equation}

\subsection{Snell's law: from Fermat's principle}

\begin{equation}
%PREM
    T = \frac{(x^2 + a^2)^\frac{1}{2}}{v_1} + \frac{(b^2 + (l-x)^2)^\frac{1}{2}}{v_2}
\end{equation}

\begin{equation}
    T = \frac{(x^2 + a^2)^\frac{1}{2}}{v_1} + \frac{(b^2 + l^2 -2lx + x^2)^\frac{1}{2}}{v_2}
\end{equation}

\begin{equation}
    \frac{dT}{dx} = \frac{d}{dx} ( \frac{(x^2 + a^2)^\frac{1}{2}}{v_1} + \frac{(b^2 + l^2 -2lx + x^2)^\frac{1}{2}}{v_2})
\end{equation}

\begin{equation}
    \frac{dT}{dx} = \frac{d}{dx} ( \frac{(x^2 + a^2)^\frac{1}{2}}{v_1}) + \frac{d}{dx} (\frac{(b^2 + l^2 -2lx + x^2)^\frac{1}{2}}{v_2})
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dx} ( \frac{(x^2 + a^2)^\frac{1}{2}}{v_1}) = \frac{x}{v_1 (x^2 + a^2)^\frac{1}{2}}
\end{equation}

\begin{equation}
%PREM
    \frac{d}{dx} (\frac{(b^2 + l^2 -2lx + x^2)^\frac{1}{2}}{v_2}) = \frac{x-l}{v_2  ((x-l)^2 + b^2)^\frac{1}{2} }
\end{equation}

\begin{equation}
    \frac{dT}{dx} = \frac{x}{v_1 (x^2 + a^2)^\frac{1}{2}} + \frac{x-l}{v_2  ((x-l)^2 + b^2)^\frac{1}{2} }
\end{equation}

\subsection{Snell's law: from Fermat's principle 2}

\begin{equation}
%PREM
    \frac{dT}{dx} = \frac{x}{v_1 (x^2 + a^2)^\frac{1}{2}} + \frac{x-l}{v_2  ((x-l)^2 + b^2)^\frac{1}{2} }
\end{equation}

\begin{equation}
%PREM
    \frac{x}{(x^2 + a^2)^\frac{1}{2}} = \sin \theta_1
\end{equation}

\begin{equation}
    \frac{dT}{dx} = \frac{\sin \theta_1}{v_1} + \frac{x-l}{v_2  ((x-l)^2 + b^2)^\frac{1}{2} }
\end{equation}

\begin{equation}
%PREM
    \frac{l-x}{((x-l)^2 + b^2)^\frac{1}{2} } = \sin \theta_2
\end{equation}

\begin{equation}
    \frac{dT}{dx} = \frac{\sin \theta_1}{v_1} - \frac{\sin \theta_2}{v_2}
\end{equation}

\begin{equation}
%PREM
    \frac{dT}{dx} = 0
\end{equation}

\begin{equation}
    \frac{\sin \theta_1}{v_1} - \frac{\sin \theta_2}{v_2} = 0
\end{equation}

\subsection{Snell's law: from Fermat's principle 3}

\begin{equation}
%PREM
    \frac{\sin \theta_1}{v_1} - \frac{\sin \theta_2}{v_2} = 0
\end{equation}

\begin{equation}
    \frac{\sin \theta_1}{v_1} = \frac{\sin \theta_2}{v_2}
\end{equation}

\begin{equation}
%PREM
    \frac{1}{v_1} = \frac{n_1}{c}
\end{equation}

\begin{equation}
%PREM    
    \frac{1}{v_2} = \frac{n_2}{c}
\end{equation}

\begin{equation}
    \frac{n_1}{c} \sin \theta_1 = \frac{n_2}{c} \sin \theta_2
\end{equation}

\begin{equation}
    n_1 \sin \theta_1 = n_2 \sin \theta_2
\end{equation}

\subsection{Maxwell-Boltzmann: energy distribution}

\begin{equation}
%PREM
    E = \frac{|\mathbf{p}|^2}{2m}
\end{equation}

\begin{equation}
    |\mathbf{p}| = (2mE)^{\frac{1}{2}}
\end{equation}

\begin{equation}
     \frac{d|\mathbf{p}|}{dE} = \frac{1}{2} (2m)^{\frac{1}{2}} E^{-\frac{3}{2}}
\end{equation}

\begin{equation}
    d|\mathbf{p}| = \frac{1}{2} (2m)^{\frac{1}{2}} E^{-\frac{3}{2}} dE
\end{equation}

\begin{equation}
    |\mathbf{p}|^2 = 2mE
\end{equation}

\begin{equation}
    |\mathbf{p}|^2 d|\mathbf{p}| = ((2mE)^{\frac{1}{2}})^2 \frac{1}{2} (2m)^{\frac{1}{2}} E^{-\frac{3}{2}} dE
\end{equation}

\begin{equation}
    |\mathbf{p}|^2 d|\mathbf{p}| = m (2mE)^{\frac{1}{2}} dE
\end{equation}

\subsection{Maxwell-Boltzmann: energy distribution 2}

\begin{equation}
%PREM
    |\mathbf{p}|^2 d|\mathbf{p}| = m (2mE)^{\frac{1}{2}} dE
\end{equation}

\begin{equation}
%PREM
    d^3\mathbf{p} = 4 \pi |\mathbf{p}|^2 d|\mathbf{p}|
\end{equation}

\begin{equation}
    d^3\mathbf{p} = 4\pi m (2mE)^  {\frac{1}{2}} dE
\end{equation}

\begin{equation}
%PREM
    f_{\mathbf{p}}(\mathbf{p}) = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{\mathbf{p}^2}{2mkT}}
\end{equation}

\begin{equation}
    f_{\mathbf{p}}(\mathbf{p}) d^3\mathbf{p} = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{\mathbf{p}^2}{2mkT}} d^3\mathbf{p}
\end{equation}

\begin{equation}
    f_\mathbf{p}(\mathbf{p}) d^3\mathbf{p} = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{\mathbf{p}^2}{2mkT}} 4\pi m (2mE)^{\frac{1}{2}} dE
\end{equation}

\begin{equation}
%PREM
    f_E(E)dE = f_{\mathbf{p}}(\mathbf{p})d^3\mathbf{p}
\end{equation}

\begin{equation}
    f_E(E)dE = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{\mathbf{p}^2}{2mkT}} 4\pi m (2mE)^{\frac{1}{2}} dE
\end{equation}

\begin{equation}
    f_E(E) = 2 (\frac{E}{\pi})^{\frac{1}{2}} (\frac{1}{kT})^{\frac{3}{2}} e^{-(\frac{E}{kT})}
\end{equation}

\subsection{Maxwell-Boltzmann: velocity vector distribution}

\begin{equation}
%PREM
    f_\mathbf{v}(\mathbf{v}) d^3 \mathbf{v} = f_\mathbf{p}(\mathbf{p})(\frac{d\mathbf{p}}{d\mathbf{v}})^3 d^3 \mathbf{v}
\end{equation}

\begin{equation}
%PREM
    \mathbf{p} = m \mathbf{v}
\end{equation}

\begin{equation}
    \frac{d\mathbf{p}}{d\mathbf{v}} = m
\end{equation}

\begin{equation}
    f_\mathbf{v}(\mathbf{v}) d^3 \mathbf{v} = f_\mathbf{p}(\mathbf{p}) m^3 d^3 \mathbf{v}
\end{equation}

\begin{equation}
%PREM
    f_\mathbf{p}(\mathbf{p}) = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{\mathbf{p}^2}{2mkT}}
\end{equation}

\begin{equation}
    f_\mathbf{p}(\mathbf{p}) = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{(m\mathbf{v})^2}{2mkT}}
\end{equation}

\begin{equation}
    f_\mathbf{v}(\mathbf{v}) d^3 \mathbf{v}  = (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{m^2\mathbf{v}^2}{2mkT}} m^3 d^3 \mathbf{v}
\end{equation}

\begin{equation}
    f_\mathbf{v}(\mathbf{v})  = m^3 (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{m^2\mathbf{v}^2}{2mkT}}
\end{equation}

\subsection{Maxwell-Boltzmann: velocity vector distribution 2}

\begin{equation}
%PREM
    f_\mathbf{v}(\mathbf{v})  = m^3 (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{m^2\mathbf{v}^2}{2mkT}}
\end{equation}

\begin{equation}
%PREM
    \mathbf{v} = (v_x, v_y, v_z)
\end{equation}

\begin{equation}
    \mathbf{v} \cdot \mathbf{v} = (v_x, v_y, v_z) \cdot (v_x, v_y, v_z)
\end{equation}

\begin{equation}
    \mathbf{v}^2 = (v_x, v_y, v_z) \cdot (v_x, v_y, v_z)
\end{equation}

\begin{equation}
    \mathbf{v}^2 = v_x^2 + v_y^2 + v_z^2
\end{equation}

\begin{equation}
    f_\mathbf{v} (v_x, v_y, v_z)  = m^3 (2\pi mkT)^{-\frac{3}{2}} e^{-\frac{m (v_x^2 + v_y^2 + v_z^2)}{2kT}}
\end{equation}

\begin{equation}
    f_\mathbf{v} (v_x, v_y, v_z)  = (\frac{m}{2\pi kT})^{\frac{3}{2}} e^{-\frac{m (v_x^2 + v_y^2 + v_z^2)}{2kT}}
\end{equation}

\subsection{Wave equation: plane wave eigenmodes}

\begin{equation}
%PREM
    u_{\omega}(x,t) = e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
    \frac{\partial u_{\omega}(x,t)}{\partial t} = -i\omega e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
%PREM
    \frac{\partial }{\partial t}\frac{\partial u_{\omega}(x,t)}{\partial t} = \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2}
\end{equation}

\begin{equation}
    \frac{\partial }{\partial t}\frac{\partial u_{\omega}(x,t)}{\partial t} = \frac{\partial }{\partial t}((-i\omega) e^{-i\omega t} f(x))
\end{equation}

\begin{equation}
    \frac{\partial }{\partial t}\frac{\partial u_{\omega}(x,t)}{\partial t} =(-i\omega) \frac{\partial }{\partial t}( e^{-i\omega t} f(x))
\end{equation}

\begin{equation}
    \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2} = (-i\omega) \frac{\partial }{\partial t}( e^{-i\omega t} f(x))
\end{equation}

\subsection{Wave equation: plane wave eigenmodes 2}

\begin{equation}
%PREM
    \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2} = (-i\omega) \frac{\partial }{\partial t}( e^{-i\omega t} f(x))
\end{equation}

\begin{equation}
    \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2} = (-i\omega)(-i\omega) e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
%PREM
    i \cdot i = -1
\end{equation}

\begin{equation}
    \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2} = -\omega^2 e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
%PREM
    \frac{\partial^2 u_{\omega}(x,t)}{\partial t^2} = c^2 \frac{\partial^2 u_{\omega}(x,t)}{\partial x^2}
\end{equation}

\begin{equation}
    -\omega^2 e^{-i\omega t} f(x) = c^2 \frac{\partial^2 u_{\omega}(x,t)}{\partial x^2}
\end{equation}

\subsection{Wave equation: plane wave eigenmodes 3}

\begin{equation}
%PREM
    c^2 \frac{\partial^2 u_{\omega}(x,t)}{\partial x^2} = -\omega^2 e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
    \frac{\partial^2 u_{\omega}(x,t)}{\partial x^2} = - \frac{\omega^2}{c^2}e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
%PREM
    u_{\omega}(x,t) = e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
    \frac{\partial^2}{\partial x^2} (e^{-i\omega t} f(x)) = - \frac{\omega^2}{c^2} e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
    e^{-i\omega t} \frac{\partial^2}{\partial x^2} f(x) = - \frac{\omega^2}{c^2} e^{-i\omega t} f(x)
\end{equation}

\begin{equation}
    \frac{\partial^2}{\partial x^2} f(x) = - \frac{\omega^2}{c^2} f(x)
\end{equation}

\subsection{Wave equation: plane wave eigenmodes 4}

\begin{equation}
%PREM
    u_{\omega}(x,t) = A e^{-i(kx-\omega t)} + B e^{i(kx-\omega t)} 
\end{equation}

\begin{equation}
%PREM
    u(x,t) = \int_{-\infty}^{\infty} s(\omega) u_{\omega}(x,t) d\omega
\end{equation}

\begin{equation}
    u(x,t) = \int_{-\infty}^{\infty} s(\omega) (A e^{-i(kx-\omega t)} + B e^{i(kx-\omega t)} ) d\omega
\end{equation}

\begin{multline}
    u(x,t) = \int_{-\infty}^{\infty} s(\omega) A e^{-i(kx-\omega t)}d\omega \\ + \int_{-\infty}^{\infty} s(\omega) B e^{i(kx-\omega t)}  d\omega
\end{multline}

\begin{equation}
%PREM
    s_+(\omega) = As(\omega)
\end{equation}

\begin{equation}
%PREM
    s_-(\omega) = Bs(\omega)
\end{equation}

\begin{multline}
    u(x,t) = \int_{-\infty}^{\infty} s_+(\omega) e^{-i(kx-\omega t)}d\omega \\ + \int_{-\infty}^{\infty} s_-(\omega) e^{i(kx-\omega t)}d\omega
\end{multline}

\subsection{Wave equation: plane wave eigenmodes 5}

\begin{multline}
%PREM
    u(x,t) = \int_{-\infty}^{\infty} s_+(\omega) e^{-i(kx-\omega t)}d\omega \\ + \int_{-\infty}^{\infty} s_-(\omega) e^{i(kx-\omega t)}d\omega
\end{multline}

\begin{equation}
%PREM
    \omega = kc
\end{equation}

\begin{multline}
    u(x,t) = \int_{-\infty}^{\infty} s_+(\omega) e^{-i(kx-kct)}d\omega \\ + \int_{-\infty}^{\infty} s_-(\omega) e^{i(kx-kct)}d\omega
\end{multline}

\begin{multline}
    u(x,t) = \int_{-\infty}^{\infty} s_+(\omega) e^{-ik(x-ct)}d\omega \\ + \int_{-\infty}^{\infty} s_-(\omega) e^{ik(x-ct)}d\omega
\end{multline}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty} s_+(\omega) e^{-ik(x-ct)}d\omega = F(x-ct)
\end{equation}

\begin{equation}
%PREM
    \int_{-\infty}^{\infty} s_-(\omega) e^{ik(x-ct)}d\omega = G(x+ct)
\end{equation}

\begin{equation}
    u(x,t) = F(x-ct) + G(x+ct)
\end{equation}

\subsection{Wave equation: Hooke's law}

\begin{equation}
%PREM
    F_H = F_{x+2h} - F_x
\end{equation}

\begin{equation}
%PREM
    F_N = ma(t)
\end{equation}

\begin{equation}
%PREM
    F_N = F_H
\end{equation}

\begin{equation}
    ma(t) = F_{x+2h} - F_x
\end{equation}

\begin{equation}
%PREM
    a(t) = \frac{\partial^2}{\partial t^2} u(x+h,t)
\end{equation}

\begin{equation}
    m\frac{\partial^2}{\partial t^2} u(x+h,t) = F_{x+2h} - F_x
\end{equation}

\subsection{Wave equation: Hooke's law 2}

\begin{equation}
%PREM
    m\frac{\partial^2}{\partial t^2} u(x+h,t) = F_{x+2h} - F_x
\end{equation}

\begin{equation}
%PREM
    F_{x+2h} = ku(x+2h,t) - ku(x+h,t)
\end{equation}

\begin{equation}
%PREM
    F_x = ku(x+h,t) - ku(x,t)
\end{equation}

\begin{multline}
     m \frac{\partial^2}{\partial t^2}u(x+h,t) = ku(x+2h,t) \\ - 2ku(x+h,t) + ku(x,t)
\end{multline}

\begin{multline}
    \frac{\partial^2}{\partial t^2}u(x+h,t) = \frac{k}{m} \big( u(x+2h,t) - 2u(x+h,t) \\ + u(x,t) \big)
\end{multline}

\subsection{Wave equation: Hooke's law 3}

\begin{multline}
%PREM
    \frac{\partial^2}{\partial t^2}u(x+h,t) = \frac{k}{m} \big( u(x+2h,t) - 2u(x+h,t) \\ + u(x,t) \big)
\end{multline}

\begin{equation}
%PREM
    N = \frac{L}{h}
\end{equation}

\begin{equation}
%PREM
    m = \frac{M}{N}
\end{equation}

\begin{equation}
%PREM
    k = KN
\end{equation}

\begin{equation}
    \frac{k}{m} = \frac{KN^2}{M}
\end{equation}

\begin{equation}
    \frac{k}{m} = \frac{KL^2}{Mh^2}
\end{equation}

\begin{multline}
    \frac{\partial^2}{\partial t^2}u(x+h,t) = \frac{KL^2}{Mh^2} \big( u(x+2h,t) - 2u(x+h,t) \\ + u(x,t) \big)
\end{multline}

\subsection{Wave equation: stress pulse in a bar}

\begin{multline}
%PREM
    \frac{\partial^2}{\partial t^2}u(x+h,t) = \frac{KL^2}{Mh^2} \big( u(x+2h,t) - 2u(x+h,t) \\ + u(x,t) \big)
\end{multline}

\begin{multline}
    \lim_{h\to 0} \frac{\partial^2 u(x+h,t)}{\partial t^2} = 
    \lim_{h\to 0}\frac{KL^2}{Mh^2} \big( u(x+2h,t) \\ - 2u(x+h,t) + u(x,t) \big)
\end{multline}

\begin{multline}
%PREM
    \lim_{h\to 0} \frac{u(x+2h,t) - 2u(x+h,t) + u(x,t)}{h^2} = \\ \frac{\partial^2 u(x,t)}{\partial x^2} 
\end{multline}

\begin{multline}
    \lim_{h\to 0} \frac{\partial^2 u(x+h,t)}{\partial t^2} = \frac{KL^2}{M} \frac{\partial^2 u(x,t)}{\partial x^2} 
\end{multline}

\begin{equation}
    \lim_{h\to 0} \frac{\partial^2 u(x+h,t)}{\partial t^2} = \frac{\partial^2 u(x,t)}{\partial t^2}
\end{equation}

\begin{equation}
    \frac{\partial^2 u(x,t)}{\partial t^2} =  \frac{KL^2}{M} \frac{\partial^2 u(x,t)}{\partial x^2} 
\end{equation}

\subsection{Wave equation: stress pulse in a bar 2}

\begin{equation}
%PREM
    \frac{\partial^2 u(x,t)}{\partial t^2} =  \frac{KL^2}{M} \frac{\partial^2 u(x,t)}{\partial x^2} 
\end{equation}

\begin{equation}
%PREM
    K = \frac{EA}{L}
\end{equation}

\begin{equation}
    \frac{\partial^2 u(x,t)}{\partial t^2} = \frac{EAL}{M} \frac{\partial^2 u(x,t)}{\partial x^2}
\end{equation}

\begin{equation}
%PREM
    \rho = \frac{M}{V}
\end{equation}

\begin{equation}
%PREM
    V=AL
\end{equation}

\begin{equation}
    \rho = \frac{M}{AL}
\end{equation}

\begin{equation}
    \frac{1}{\rho} = \frac{AL}{M}
\end{equation}

\begin{equation}
    \frac{\partial^2 u(x,t)}{\partial t^2} = \frac{E}{\rho} \frac{\partial^2 u(x,t)}{\partial x^2}
\end{equation}

\section{Comparing top 20 MathT5-base generated derivations by ROUGE} 

\subsection{Top ROUGE derivations}
\label{app:top_metric}

\subsubsection{Lorentz force: Derivation of x component of electric field} 


\begin{equation}
 \mathbf { E } = - \nabla \phi - \frac { \partial \mathbf { A } } { \partial t }  
\end{equation}


\begin{equation}
  \nabla \phi = ( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } )  
 \end{equation}


\begin{equation}
  \mathbf { A } = (A_x, A_y, A_z)  
 \end{equation}


\begin{equation}
  \mathbf { E } \cdot (1, 0) = ( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } ) - \frac { \partial } { \partial t } (A_x, A_y, A_z)  
 \end{equation}


\begin{equation}
  \mathbf { E } \cdot (1, 0) = -(( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } ) - \frac { \partial } { \partial t } (A_x, A_y, A_z)) \cdot (1, 0) 
 \end{equation}


\subsubsection{Heisenberg picture: momentum evolution 2} 


\begin{equation}
 \frac{d\hat{p}(t)}{dt} = -m \omega ^ {2} \hat{x}(t)  
\end{equation}


\begin{equation}
  \frac{d}{dt} \frac{d \hat{ p } (t) }{ dt } = \frac{ d }{ dt } ( -m \omega ^ { 2 } \hat { x } (t) )
\end{equation}


\begin{equation}
  \frac{ d }{ dt } \frac { d \hat{ p } (t) }{ dt } = \frac { d ^ { 2} \hat{ p } (t) }{ dt ^ { 2 }  }
\end{equation}


\begin{equation}
  \frac { d } { dt } \frac { d \hat { p } (t) } { dt } = \frac { d ^ { 2 } \hat { p } (t) } { dt ^ { 2 } } 
 \end{equation}


\begin{equation}
  \frac { d } { dt } \frac { d \hat { p } (t) } { dt } = -m \omega ^ { 2 } \frac { d \hat { x } (t) } { dt } 
 \end{equation}


\subsubsection{Maxwell's equations: Charge conservation 2} 


\begin{equation}
 \nabla \cdot \mu_0 \mathbf { J } + \nabla \cdot \mu_0 \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = 0  
\end{equation}


\begin{equation}
  \nabla \cdot \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } )  
\end{equation}


\begin{equation}
  \nabla \cdot \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } )  
\end{equation}


\begin{equation}
  \nabla \cdot \mathbf { J } + \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } ) = 0 
\end{equation}


\subsubsection{Uniqueness theorem for Poisson's equation 4} 


\begin{equation}
 \nabla \phi = ( \frac { \partial \phi } { \partial r }, \frac { 1 } { r } \frac { \partial \phi } { \partial \theta }, \frac { 1 } { r } \frac { \partial \phi } { \partial \theta }, \frac { 1 } { r \sin { \theta } } \frac { \partial \phi } { \partial \varphi } ) = ( \frac { \partial \phi } { \partial r }, \frac { 1 } { r } \frac { \partial \phi } { \partial \theta }, \frac { 1 } { r \sin { \theta } } \frac { \partial \phi } { \partial \varphi } )  
\end{equation}


\begin{equation}
  ( \frac { \partial \phi } { \partial r }, \frac { 1 } { r } \frac { \partial \phi } { \partial \theta }, \frac { 1 } { r \sin { \theta } } \frac { \partial \phi } { \partial \varphi } ) \cdot \hat { \mathbf { r } } = \frac { \partial \phi } { \partial r }  
\end{equation}


\begin{equation}
  \nabla \phi \cdot \hat { \mathbf { r } } = \frac { \partial \phi } { \partial r } 
\end{equation}


\subsubsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (RHS) 2} 


\begin{equation}
 \frac { \partial } { \partial x } = q \frac { \partial } { \partial x } ( \dot { x } A_x + \dot { y } A_y + \dot { z } A_z) - q \frac { \partial } { \partial x } \phi  
\end{equation}


\begin{equation}
  \frac { \partial } { \partial x } ( \dot { x } A_x) + \frac { \partial } { \partial x } ( \dot { x } A_y) + \frac { \partial } { \partial x } \dot { y } = \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_y } { \partial x } \dot { y } + \frac { \partial A_z } { \partial x } \dot { z }  
\end{equation}


\begin{equation}
  \frac { \partial } { \partial x } ( \dot { x } A_x) + \frac { \partial } { \partial x } ( \dot { y } A_y) + \frac { \partial } { \partial x } ( \dot { z } A_z) = \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_y } { \partial x } \dot { y } + \frac { \partial A_z } { \partial x } \dot { z } 
\end{equation}


\begin{equation}
  \frac { \partial L } { \partial x } = q( \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_y } { \partial x } \dot { y } + \frac { \partial A_z } { \partial x } \dot { z } ) - q \frac { \partial } { \partial x } \phi 
\end{equation}


\subsubsection{Heisenberg picture: position commutator 3} 


\begin{equation}
 \comm { \hat { x } (t_1) } { \hat { x } (t_2) } = \hat { x } _0 \hat { p } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1) + \hat { p } _0 \hat { x } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1) + \hat { p } _0 \hat { x } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \sin( \omega t_1 - \omega t_2) = - \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \frac { 1 } { \omega m } ( \hat { x } _0 \hat { p } _0 - \hat { p } _0 \hat { x } _0) \sin  ( \omega t_2 - \omega t_1)  = - \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \comm { \hat { x } (t_1) } { \hat { x } (t_2) } = \frac { 1 } { \omega m } ( \hat { x } _0 \hat { p } _0 - \hat { p } _0 \hat { x } _0) \sin( \omega t_2 - \omega t_1) 
\end{equation}


\subsubsection{Uncertainty principle: Kennard inequality proof part 5.3} 


\begin{equation}
 \bra { f } \ket { g } = -i \hbar \int_ { - \infty } ^ { \infty } x \psi ^ *(x) \frac { d \psi(x) } { dx } dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } x \psi ^ *(x) \frac { d \psi(x) } { dx } dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x) \frac { d } { dx } (x \psi (x))dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { g } = -i \hbar \int_ { - \infty } ^ { \infty } (x \psi ^ *(x) \frac { d } { dx } (x \psi (x))dx)  
\end{equation}


\begin{equation}
  \bra { g } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } (x \psi ^ *(x) \frac { d } { dx } - \psi ^ *(x) \frac { d } { dx } (x \psi(x)))dx 
\end{equation}


\subsubsection{Creation and annihilation operators: Ladder operators for the quantum harmonic oscillator part 1.4} 


\begin{equation}
 -( \frac { d ^ 2 } { dq ^ { 2 } } + q ^ 2)( \frac { d ^ 2 } { dq ^ { 2 } } + q ^ 2) = - \frac { d ^ 2 } { dq ^ { 2 } } - \frac { d } { dq ^ { 2 } } q + q \frac { d } { dq } + q ^ 2  
\end{equation}


\begin{equation}
  \frac { d } { dq } q - q \frac { d } { dq } = 1  
\end{equation}


\begin{equation}
  ( \frac { d } { dq } q - q \frac { d } { dq } ) = 1  
\end{equation}


\begin{equation}
  - \frac { d ^ { 2 } } { dq ^ 2 } + q ^ 2 = 1 + (- \frac { d ^ { 2 } } { dq ^ 2 } + q ^ 2)  
\end{equation}


\begin{equation}
  ( \frac { d } { dq } q - q \frac { d } { dq } ) = 1  
\end{equation}


\begin{equation}
  - \frac { d ^ { 2 } } { dq ^ 2 } + q ^ 2 = 1 + (- \frac { d ^ { 2 } } { dq ^ 2 } + q ^ 2) ( \frac { d ^ { 2 } } { dq { 2 } + q } 2) 
\end{equation}


\subsubsection{Gauss' law: equivalence between differential and integral forms} 


\begin{equation}
 \oiint_S \mathbf { E } \cdot d \mathbf { A } = \frac { Q } { \varepsilon_0 }  
\end{equation}


\begin{equation}
  \oiint_S \mathbf { E } \cdot d \mathbf { A } = \iiint_V \nabla \cdot \mathbf { E } dV  
\end{equation}


\begin{equation}
  Q = \iiint_V \rho dV  
\end{equation}


\begin{equation}
  \iiint_V \nabla \cdot \mathbf { E } dV = \iiint_V \frac { \rho } { \varepsilon_0 } dV 
\end{equation}


\subsubsection{Ampere's circuital law: Proof of equivalence 4} 


\begin{equation}
 \frac { 1 } { \mu_0 } ( \nabla \times \mathbf { B } ) = \mathbf { J } _f + \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } + \mathbf { J } _P + \mathbf { J } _M  
\end{equation}


\begin{equation}
  \mathbf { J } _b = \mathbf { J } _P + \mathbf { J } _M  
\end{equation}


\begin{equation}
  \mathbf { J } = \mathbf { J } _f + \mathbf { J } _b  
\end{equation}


\begin{equation}
  \mathbf { J } = \mathbf { J } _f + \mathbf { J } _b  
\end{equation}


\begin{equation}
  \frac { 1 } { \mu_0 } ( \nabla \times \mathbf { B } ) = \mathbf { J } + \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } + \mathbf { J } _P + \mathbf { J } _M  
\end{equation}


\begin{equation}
  \mathbf { J } _b = \mathbf { J } _f + \mathbf { J } _b  
\end{equation}


\begin{equation}
  \frac { 1 } { \mu_0 } ( \nabla \times \mathbf { B } ) = \mathbf { J } + \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } 
\end{equation}


\subsubsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$ 2} 


\begin{equation}
 \frac { dg_ { \varepsilon } } { d \varepsilon } = \frac { d } { d \varepsilon } ( \varepsilon \eta(x))  
\end{equation}


\begin{equation}
  \frac { d } { d \varepsilon } ( \varepsilon \eta(x)) = \eta(x) + \varepsilon \frac { d \eta(x) } { d \varepsilon }  
\end{equation}


\begin{equation}
  \frac { d } { d \varepsilon } ( \varepsilon \eta(x)) = \eta(x) + \varepsilon \frac { d \eta(x) } { d \varepsilon }  
\end{equation}


\begin{equation}
  \frac { d \eta(x) } { d \varepsilon } = 0  
\end{equation}


\begin{equation}
  \frac { d g_ { \varepsilon } } { d \varepsilon } = \eta(x) 
\end{equation}


\subsubsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian 5} 


\begin{equation}
 qE_x + q( \dot { \mathbf { r } } \times ( \nabla \times \mathbf { A } ))_x = qE_x + q( \dot { \mathbf { r } } \times ( \nabla \times \mathbf { A } ))_x  
\end{equation}


\begin{equation}
  \mathbf { B } = \nabla \times \mathbf { A }  
\end{equation}


\begin{equation}
  F_x = \mathbf { F } \cdot \hat { \mathbf { x } }  
\end{equation}


\begin{equation}
  E_x = \mathbf { E } \cdot \hat { \mathbf { x } }  
\end{equation}


\begin{equation}
  ( \dot { \mathbf { r } } \times \mathbf { B } )_x = q \mathbf { E } \cdot \hat { \mathbf { x } }  
\end{equation}


\begin{equation}
  \mathbf { F } \cdot \hat { \mathbf { x } } = q \mathbf { E } \cdot \hat { \mathbf { x } } + q( \dot { \mathbf { r } } \times \mathbf { B } ) \cdot \hat { \mathbf { x } } 
\end{equation}


\subsubsection{Lorentz force: continuous charge distribution} 


\begin{equation}
 \frac { d \mathbf { F } } { dV } = \frac { dq } { dV } ( \mathbf { E } + \mathbf { v }  \times \mathbf { B } )  
\end{equation}


\begin{equation}
  \mathbf { f } = \frac { d \mathbf { F } } { dV }  
\end{equation}


\begin{equation}
  \rho = \frac { dq } { dV }  
\end{equation}


\begin{equation}
  \mathbf { f } = \rho \mathbf { E } + \rho \mathbf { v }  \times \mathbf { B } 
\end{equation}


\subsubsection{Ampere's circuital law: Proof of equivalence 3} 


\begin{equation}
 \nabla \times \frac { 1 } { \mu_0 } \mathbf { B } = \mathbf { J } _f + \frac { \partial } { \partial t } \varepsilon_0 \mathbf { E } + \frac { \partial } { \partial t } \mathbf { P } + \mathbf { J } _M  
\end{equation}


\begin{equation}
  \frac { 1 } { \mu_0 } \mathbf { B } = \frac { \partial } { \partial t } ( \mathbf { J } _f + \frac { \partial } { \partial t } \varepsilon_0 \mathbf { E } + \frac { \partial } { \partial t } \mathbf { P } + \mathbf { J } _M)  
\end{equation}


\begin{equation}
  \mathbf { J } _P = \frac { \partial \mathbf { P } } { \partial t }  
\end{equation}


\begin{equation}
  \frac { 1 } { \mu_0 } ( \nabla \times \mathbf { B } ) = \mathbf { J } _f + \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } + \mathbf { J } _P + \mathbf { J } _M 
\end{equation}


\subsubsection{Lorentz force: Lorentz force in terms of potentials 2} 


\begin{equation}
 \frac { d \mathbf { A } } { dt } = \frac { \partial \mathbf { A } } { \partial t } + ( \mathbf { v } \cdot \nabla) \mathbf { A }  
\end{equation}


\begin{equation}
  \frac { d \mathbf { A } } { dt } - ( \mathbf { v } \cdot \nabla) \mathbf { A } = - \nabla \phi - \frac { \partial \mathbf { A } } { \partial t } + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A }  
\end{equation}


\begin{equation}
  \mathbf { F } = q(- \nabla \phi - \frac { \partial \mathbf { A } } { \partial t } + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A } )  
\end{equation}


\begin{equation}
  \mathbf { F } = q(- \nabla \phi - ( \frac { d \mathbf { A } } { dt } - ( \mathbf { v } \cdot \nabla) \mathbf { A } ) + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A } ) 
\end{equation}


\subsubsection{Gauss' law: Derivation from Coulomb's law 2} 


\begin{equation}
 \nabla \cdot \mathbf { E } ( \mathbf { r } ) = \frac { 1 } { 2 \pi \varepsilon_0 }  
\end{equation}


\begin{equation}
  \int \rho( \mathbf { s } ) \delta ( \mathbf { r } - \mathbf { s } )d ^ { 2 } \mathbf { s } = \int \frac { 1 } { 4 \pi \varepsilon_0 } \int \rho( \mathbf { s } ) 4 \pi \delta ( \mathbf { r } - \mathbf { s } )d ^ { 3 } \mathbf { s }  
\end{equation}


\begin{equation}
  \int \rho( \mathbf { s } ) \delta ( \mathbf { r } - \mathbf { s } )d ^ 3 \mathbf { s } = \rho( \mathbf { r } )  
\end{equation}


\begin{equation}
  \nabla \cdot \mathbf { E } ( \mathbf { r } ) = \frac { \rho( \mathbf { r } ) } { \varepsilon_0 } 
\end{equation}


\subsubsection{Uniqueness theorem for Poisson's equation 2} 


\begin{equation}
 \nabla \cdot ( \phi \nabla \phi) = ( \nabla \phi)^{2} + \phi \nabla ^{2} \phi  
\end{equation}


\begin{equation}
  \nabla  ^{2} \phi = 0  
\end{equation}


\begin{equation}
  \nabla \cdot ( \phi \nabla \phi) = \phi ( \nabla \phi) ^{2} + \phi \nabla  ^{2} \phi  
\end{equation}


\begin{equation}
  \nabla ^{2} \phi = 0  
\end{equation}


\begin{equation}
  \int \nabla  \cdot ( \phi \nabla \phi) dV = \int 0 dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot ( \phi \nabla \phi) dV = \int_V ( \nabla \phi) ^ 2 dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot ( \phi \nabla \phi) dV = \int_S \phi \nabla \phi  \cdot d \mathbf { S }  
\end{equation}


\begin{equation}
  \int_S \phi \nabla \phi \cdot d \mathbf { S } = \int_V ( \nabla \phi) ^ 2 dV 
\end{equation}


\subsubsection{Poisson's equation: Gravitational potential from Poisson's equation 2} 


\begin{equation}
 m = \int_V \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot \nabla \phi dV = \int_V 4 \pi G \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot \nabla \phi dV = \int_V 4 \pi G \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot d \mathbf { S } = \int_S \nabla \phi \cdot d \mathbf { S }  
\end{equation}


\begin{equation}
  \int_S \nabla \phi \cdot d \mathbf { S } = 4 \pi G m 
\end{equation}


\subsubsection{Lorentz force: Derivation of classical Lagrangian of EM field} 

\begin{equation}
    q \phi - q \dot { \mathbf { r } } \cdot \mathbf { A } = q \phi - q \dot { \mathbf { r } } \cdot \mathbf { r } 
\end{equation}

\iffalse
\begin{equation}
  T = \frac{ m ^{ 2 }\dot}{\mathbf{r}}\cdot\dot{\mathbf{r}}  
\end{equation}
\fi

\begin{equation}
  T = \frac{ m ^{ 2 }}{\mathbf{r}}\dot{\mathbf{r}}  
\end{equation}


\begin{equation}
  L = T - V  
\end{equation}

\iffalse
\begin{equation}
    L = \frac{ m ^{ 2 } \dot}{ \mathbf { r } } \cdot \dot { \mathbf{ r } } + q \dot { \mathbf{ r } } \cdot \mathbf{ A } - q \phi 
\end{equation}
\fi

\begin{equation}
    L = \frac{ m ^{ 2 }}{ \mathbf { r } }\dot { \mathbf{ r } } + q \dot { \mathbf{ r } } \cdot \mathbf{ A } - q \phi 
\end{equation}

\subsubsection{Uncertainty principle: Kennard inequality proof part 5.5} 


\begin{equation}
 \bra { f } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x)( x \frac { d \psi(x) } { dx } - (x \frac { d \psi(x) } { dx } + \psi(x)))dx  
\end{equation}


\begin{equation}
  \psi ^ *(x) \psi(x) = \psi(x)| \psi(x)| \psi(x)| \psi(x)| \psi(x)| \psi(x)  
\end{equation}


\begin{equation}
  \bra { f } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x)( x \frac { d \psi(x) } { dx } - (x \frac { d \psi(x) } { dx } + \psi(x)))dx  
\end{equation}


\begin{equation}
  \psi ^ *(x) \psi(x) = \psi(x)| ^ 2  
\end{equation}


\begin{equation}
  \bra { f } \ket { g } - \bra { g } \ket { f } = i \hbar \int_ { - \infty } ^ { \infty } + \psi(x)| ^ 2 dx 
\end{equation}
\newpage

\subsection{Top $\mathcal{S}_{ROUGE}$ derivations}
\label{app:top_new_metric}

\subsubsection{Lorentz force: Derivation of x component of electric field} 

\begin{equation}
 \mathbf { E } = - \nabla \phi - \frac { \partial \mathbf { A } } { \partial t }  
\end{equation}


\begin{equation}
  \nabla \phi = ( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } )  
\end{equation}


\begin{equation}
  \mathbf { A } = (A_x, A_y, A_z)  
\end{equation}


\begin{equation}
  \mathbf { E } \cdot (1, 0) = ( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } ) - \frac { \partial } { \partial t } (A_x, A_y, A_z)  
\end{equation}


\begin{equation}
  \mathbf { E } \cdot (1, 0) = -(( \frac { \partial \phi } { \partial x }, \frac { \partial \phi } { \partial y }, \frac { \partial \phi } { \partial z } ) - \frac { \partial } { \partial t } (A_x, A_y, A_z)) \cdot (1, 0) 
\end{equation}


\subsubsection{Poisson's equation: Gravitational potential from Poisson's equation 7} 


\begin{equation}
 \int_S \frac { \partial \phi } { \partial r } dS = \int 4 \pi \frac { \partial \phi } { \partial r } r ^ 2 dS  
\end{equation}


\begin{equation}
  \int_S \frac { \partial \phi } { \partial r } dS = 4 \pi G m  
\end{equation}


\begin{equation}
  \int_S \frac { \partial \phi } { \partial r } dS = 4 \pi \frac { \partial \phi } { \partial r } r ^ 2  
\end{equation}


\begin{equation}
  \frac { \partial \phi } { \partial r } = \frac { G m } { r ^ 2 } 
\end{equation}


\subsubsection{Lorentz force: Lorentz force in terms of potentials 2} 


\begin{equation}
 \frac { d \mathbf { A } } { dt } = \frac { \partial \mathbf { A } } { \partial t } + ( \mathbf { v } \cdot \nabla) \mathbf { A }  
\end{equation}


\begin{equation}
  \frac { d \mathbf { A } } { dt } - ( \mathbf { v } \cdot \nabla) \mathbf { A } = - \nabla \phi - \frac { \partial \mathbf { A } } { \partial t } + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A }  
\end{equation}


\begin{equation}
  \mathbf { F } = q(- \nabla \phi - \frac { \partial \mathbf { A } } { \partial t } + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A } )  
\end{equation}


\begin{equation}
  \mathbf { F } = q(- \nabla \phi - ( \frac { d \mathbf { A } } { dt } - ( \mathbf { v } \cdot \nabla) \mathbf { A } ) + \nabla( \mathbf { v } \cdot \mathbf { A } ) - ( \mathbf { v } \cdot \mathbf { A } ) \mathbf { A } ) 
\end{equation}


\subsubsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 4} 


\begin{equation}
 dA_x = \frac { \partial A_x } { \partial t } dt + \frac { \partial A_x } { \partial x } dx + \frac { \partial A_x } { \partial y } dy + \frac { \partial A_x } { \partial z } dz  
\end{equation}


\begin{equation}
  \frac { dx } { dt } = \dot { x }  
\end{equation}


\begin{equation}
  \frac { dy } { dt } = \dot { y }  
\end{equation}


\begin{equation}
  \frac { dz } { dt } = \dot { z }  
\end{equation}


\begin{equation}
  \frac { dA_x } { dt } = \frac { \partial A_x } { \partial t } + \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_x } { \partial y } \dot { y } + \frac { \partial A_x } { \partial z } \dot { z } 
\end{equation}


\subsubsection{Lorentz force: Derivation of Lorentz force from classical Lagrangian (LHS) 5} 


\begin{equation}
 \frac { d } { dt } \frac { \partial L } { \partial \dot { x } } = m \frac { d } { dt } \dot { x } + q \frac { d } { dt } A_x  
\end{equation}


\begin{equation}
  \frac { d } { dt } \dot { x } = \Ddot { x }  
\end{equation}


\begin{equation}
  \frac { d } { dt } \frac { \partial L } { \partial \dot { x } } = m \frac { d } { dt } \dot { x } + q \frac { d } { dt } A_x  
\end{equation}


\begin{equation}
  \frac { d } { dt } \dot { x } = \Ddot { x }  
\end{equation}


\begin{equation}
  \frac { d } { dt } \frac { \partial L } { \partial \dot { x } } = m \Ddot { x } + q \frac { d } { dt } \dot { x } + \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_x } { \partial z } \dot { z }  
\end{equation}


\begin{equation}
  \frac { d } { dt } \frac { \partial L } { \partial \dot { x } } = m \Ddot { x } + q( \frac { \partial A_x } { \partial t } + \frac { \partial A_x } { \partial x } \dot { x } + \frac { \partial A_x } { \partial y } \dot { y } + \frac { \partial A_x } { \partial z } \dot { z } ) 
\end{equation}


\subsubsection{Gauss' law: equivalence between differential and integral forms} 


\begin{equation}
 \oiint_S \mathbf { E } \cdot d \mathbf { A } = \frac { Q } { \varepsilon_0 }  
\end{equation}


\begin{equation}
  \oiint_S \mathbf { E } \cdot d \mathbf { A } = \iiint_V \nabla \cdot \mathbf { E } dV  
\end{equation}


\begin{equation}
  Q = \iiint_V \rho dV  
\end{equation}


\begin{equation}
  \iiint_V \nabla \cdot \mathbf { E } dV = \iiint_V \frac { \rho } { \varepsilon_0 } dV 
\end{equation}


\subsubsection{Euler-Lagrange equation: Straight line 6} 


\begin{equation}
 \frac { dy } { dx } = C(1 - C ^ 2) ^ { -1/2 }  
\end{equation}


\begin{equation}
  C(1 - C ^ 2) ^ { -1/2 } = A  
\end{equation}


\begin{equation}
  \int \frac { dy } { dx } dx = \int A dx  
\end{equation}


\begin{equation}
  \int \frac { dy } { dx } dx = Ax + C  
\end{equation}


\begin{equation}
  \int \frac { dy } { dx } dx = Ax + C  
\end{equation}


\begin{equation}
  y = Ax + C 
\end{equation}


\subsubsection{Magnetic flux: Flux through a closed surface} 


\begin{equation}
 \oiint_S \mathbf { B } \cdot d \mathbf { S } = 0  
\end{equation}


\begin{equation}
  \iiint_S \mathbf { B } \cdot d \mathbf { S } dV = \iiint 0 dV  
\end{equation}


\begin{equation}
  \iiint_S \mathbf { B } \cdot d \mathbf { S } dV = \iiint 0 dV  
\end{equation}


\begin{equation}
  \iiint_V \nabla \cdot \mathbf { B } dV dV = \iiint 0 dV dV  
\end{equation}


\begin{equation}
  \nabla \cdot \mathbf { B } = 0 
\end{equation}


\subsubsection{Uncertainty principle: Kennard inequality proof part 5.5} 


\begin{equation}
 \bra { f } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x)( x \frac { d \psi(x) } { dx } - (x \frac { d \psi(x) } { dx } + \psi(x)))dx  
\end{equation}


\begin{equation}
  \psi ^ *(x) \psi(x) = \psi(x)| \psi(x)| \psi(x)| \psi(x)| \psi(x)| \psi(x)  
\end{equation}


\begin{equation}
  \bra { f } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x)( x \frac { d \psi(x) } { dx } - (x \frac { d \psi(x) } { dx } + \psi(x)))dx  
\end{equation}


\begin{equation}
  \psi ^ *(x) \psi(x) = \psi(x)| ^ 2  
\end{equation}


\begin{equation}
  \bra { f } \ket { g } - \bra { g } \ket { f } = i \hbar \int_ { - \infty } ^ { \infty } + |\psi(x)| ^ 2 dx 
\end{equation}


\subsubsection{Maxwell's equations: Charge conservation 2} 


\begin{equation}
 \nabla \cdot \mu_0 \mathbf { J } + \nabla \cdot \mu_0 \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = 0  
\end{equation}


\begin{equation}
  \nabla \cdot \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } )  
\end{equation}


\begin{equation}
  \nabla \cdot \varepsilon_0 \frac { \partial \mathbf { E } } { \partial t } = \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } )  
\end{equation}


\begin{equation}
  \nabla \cdot \mathbf { J } + \varepsilon_0 \frac { \partial } { \partial t } ( \nabla \cdot \mathbf { E } ) = 0 
\end{equation}


\subsubsection{Wave equation: plane wave eigenmodes 4} 


\begin{equation}
 u_{\omega}(x,t) = A e ^ { -i(kx- \omega t) } + B e ^ { i(kx- \omega t) }  
\end{equation}


\begin{equation}
  \int u_{\omega}(x,t) d \omega = \int (A e ^ { -i(kx- \omega t) } + B e ^ { i(kx- \omega t) } ) d \omega  
\end{equation}


\begin{equation}
  u(x,t) = \int_ { - \infty } ^ { \infty } s( \omega) u_{\omega}(x,t) d \omega  
\end{equation}


\begin{equation}
  s_+( \omega) = As( \omega)  
\end{equation}


\begin{equation}
  s_-( \omega) = Bs( \omega)  
\end{equation}


\begin{equation}
  u(x,t) = \int_ { - \infty } ^ { \infty } s_ +( \omega) e ^ { -i(kx- \omega t) } d \omega + \int_ { - \infty } ^ { \infty } s_-( \omega) e ^ { i(kx- \omega t) } d \omega 
\end{equation}


\subsubsection{Euler-lagrange equation: Full derivative of the perturbation Lagrangian with respect to $\varepsilon$ 2} 


\begin{equation}
 \frac { dg_ { \varepsilon } } { d \varepsilon } = \frac { d } { d \varepsilon } ( \varepsilon \eta(x))  
\end{equation}


\begin{equation}
  \frac { d } { d \varepsilon } ( \varepsilon \eta(x)) = \eta(x) + \varepsilon \frac { d \eta(x) } { d \varepsilon }  
\end{equation}


\begin{equation}
  \frac { d } { d \varepsilon } ( \varepsilon \eta(x)) = \eta(x) + \varepsilon \frac { d \eta(x) } { d \varepsilon }  
\end{equation}


\begin{equation}
  \frac { d \eta(x) } { d \varepsilon } = 0  
\end{equation}


\begin{equation}
  \frac { d g_ { \varepsilon } } { d \varepsilon } = \eta(x) 
\end{equation}


\subsubsection{Uniqueness theorem for Poisson's equation 6} 


\begin{equation}
 \frac { \partial \phi } { \partial r } = 0  
\end{equation}


\begin{equation}
  \int \frac { \partial \phi } { \partial r } dr = \int 0 dr  
\end{equation}


\begin{equation}
  \int \frac { \partial \phi } { \partial r } dr = C_1  
\end{equation}


\begin{equation}
  \int \frac { \partial \phi } { \partial r } dr = \phi + C_2  
\end{equation}


\begin{equation}
  \int \frac { \partial \phi } { \partial r } dr = \phi + C_2  
\end{equation}


\begin{equation}
  \phi = C_1 - C_2 
\end{equation}


\subsubsection{Uncertainty principle: Kennard inequality proof part 2.5} 


\begin{equation}
 \eval { (uv) } ^ { \infty } _ { - \infty } - \int ^ { \infty } _ { - \infty } v \frac { du } { d \chi } d \chi = 0  
\end{equation}


\begin{equation}
  \eval { (uv) } ^ { \infty } _ { - \infty } = 0  
\end{equation}


\begin{equation}
  \frac { d \chi } { d \chi } = \frac { d \psi( \chi) } { d \chi }  
\end{equation}


\begin{equation}
  \frac { d \chi } { d \chi } = \frac { d \psi ( \chi) } { d \chi }  
\end{equation}


\begin{equation}
  v = \frac { \hbar } { -ip } e ^ { \frac { -ip \chi } { \hbar } }  
\end{equation}


\begin{equation}
  I = \frac { \hbar } { ip } \int ^ { \infty } _ { - \infty } \frac { d \psi( \chi) } { d \chi } e ^ { \frac { -ip \chi } { \hbar } } d \chi 
\end{equation}


\subsubsection{Heisenberg picture: position commutator 3} 


\begin{equation}
 \comm { \hat { x } (t_1) } { \hat { x } (t_2) } = \hat { x } _0 \hat { p } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1) + \hat { p } _0 \hat { x } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1) + \hat { p } _0 \hat { x } _0 \frac { 1 } { \omega m } \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \sin( \omega t_1 - \omega t_2) = - \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \frac { 1 } { \omega m } ( \hat { x } _0 \hat { p } _0 - \hat { p } _0 \hat { x } _0) \sin  ( \omega t_2 - \omega t_1) = - \sin( \omega t_2 - \omega t_1)  
\end{equation}


\begin{equation}
  \comm { \hat { x } (t_1) } { \hat { x } (t_2) } = \frac { 1 } { \omega m } ( \hat { x } _0 \hat { p } _0 - \hat { p } _0 \hat { x } _0) \sin( \omega t_2 - \omega t_1) 
\end{equation}


\subsubsection{Poisson's equation: Gravitational potential from Poisson's equation 5} 


\begin{equation}
 \nabla \phi \cdot d \mathbf { S } = \frac { \partial \phi } { \partial r } dS  
\end{equation}


\begin{equation}
  \int \nabla \phi \cdot d \mathbf { S } d \mathbf { S } = \int \frac { \partial \phi } { \partial r } dS d \mathbf { S }  
\end{equation}


\begin{equation}
  \int_S \nabla \phi \cdot d \mathbf { S } d \mathbf { S } = 4 \pi G m
\end{equation}


\begin{equation}
  \int_S \frac { \partial \phi } { \partial r } dS = 4 \pi G m 
\end{equation}


\subsubsection{Uncertainty principle: Kennard inequality proof part 5.3} 


\begin{equation}
 \bra { f } \ket { g } = -i \hbar \int_ { - \infty } ^ { \infty } x \psi ^ *(x) \frac { d \psi(x) } { dx } dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } x \psi ^ *(x) \frac { d \psi(x) } { dx } dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } \psi ^ * (x) \frac { d } { dx } (x \psi (x))dx  
\end{equation}


\begin{equation}
  \bra { g } \ket { g } = -i \hbar \int_ { - \infty } ^ { \infty } (x \psi ^ *(x) \frac { d } { dx } (x \psi (x))dx)  
\end{equation}


\begin{equation}
  \bra { g } \ket { g } - \bra { g } \ket { f } = -i \hbar \int_ { - \infty } ^ { \infty } (x \psi ^ *(x) \frac { d } { dx } - \psi ^ *(x) \frac { d } { dx } (x \psi(x)))dx 
\end{equation}


\subsubsection{Gauss' law: Equivalence of total and free charge statements} 


\begin{equation}
 \rho_{ b } = - \nabla \cdot \mathbf { P }  
\end{equation}


\begin{equation}
  \rho_f = \nabla \cdot \mathbf { D }  
\end{equation}


\begin{equation}
  \rho_b + \rho_f = \nabla \cdot ( \mathbf { D } - \mathbf { P } )  
\end{equation}


\begin{equation}
  \rho = \rho_b + \rho_f  
\end{equation}


\begin{equation}
  \rho = \nabla \cdot ( \mathbf { D } - \mathbf { P } ) 
\end{equation}


\subsubsection{Heisenberg picture: time evolution 4} 


\begin{equation}
 \frac { d } { dt } \hat { x } (t) = \frac { i } { \hbar } ( \hat { H } e ^ { i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } \hat { H } )  
\end{equation}


\begin{equation}
  \hat { x } (t) = e ^ { i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } - e ^ { i \frac { \hat { H } t } { \hbar } } \hat { x } e ^ { -i \frac { \hat { H } t } { \hbar } } \hat { H } = \hat { H } \hat { x } (t) - \hat { x } (t) \hat { H }  
\end{equation}


\begin{equation}
  \comm { \hat { H } } { \hat { x } (t) } = \hat { H } \hat { x } (t) - \hat { x } (t) \hat { H }  
\end{equation}


\begin{equation}
  \frac { d } { dt } \hat { x } (t) = \frac { i } { \hbar } \comm { \hat { H } } { \hat { x } (t) } 
\end{equation}


\subsubsection{Poisson's equation: Gravitational potential from Poisson's equation 2} 


\begin{equation}
 m = \int_V \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot \nabla \phi dV = \int_V 4 \pi G \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot \nabla \phi dV = \int_V 4 \pi G \rho dV  
\end{equation}


\begin{equation}
  \int_V \nabla \cdot d \mathbf { S } = \int_S \nabla \phi \cdot d \mathbf { S }  
\end{equation}


\begin{equation}
  \int_S \nabla \phi \cdot d \mathbf { S } = 4 \pi G m 
\end{equation}



\section{Enhanced metric, $\mathcal{S}_M$}
\label{app:enhanced_metric}

The implementation used in this work is given below. This could be improved by pre-computing equation pair scores, and repeated equations could be more heavily penalised by inserting a padding element rather than removing duplicates. The $M_+$ equation-level metric could be improved by introducing hyperparameters rather than giving all failed equations a score of 0 regardless of the failure type.

\begin{algorithm*}
\caption{Enhanced metric, $\mathcal{S}_M$}
\begin{algorithmic}[1]
\Procedure{$\mathcal{S}_M$}{$\text{ref, pred, $M$}$}
\State $\text{ref\_eqs, pred\_eqs} \gets \text{RemoveDuplicates}(\text{ref, pred})$
\State $\text{D} \gets \text{abs}(\text{len}(\text{ref\_eqs}) - \text{len}(\text{pred\_eqs}))$
\State $\text{L} \gets \text{min}(\text{len}(\text{ref\_eqs}), \text{len}(\text{pred\_eqs}))$
\If {$\text{D} > \text{L} + 1$}
\Return 0
\Else
\State $\text{C} \gets \text{Combinations}(\text{range}(\text{L} + 1), \text{D})$
\State $\text{avg\_scores} \gets []$
\For {$\text{c} \in \text{C}$}
\State $\text{ref\_copy, pred\_copy} \gets \text{InsertPaddingElements}(\text{ref\_eqs, pred\_eqs, c})$
\State $\text{scores} \gets [M_+(\text{ref}, \text{pred}, M)$ for $\text{ref, pred} \in \text{zip}(\text{ref\_copy, pred\_copy})]$
\State $\text{avg\_score} \gets \frac{1}{\text{L} + \text{D}} \cdot \text{sum}(\text{scores})$
\State $\text{append avg\_score to avg\_scores}$
\EndFor
\State $\text{max\_index} \gets \text{argmax}(\text{avg\_scores})$
\If {return\_equations}
\Return $\text{avg\_scores[max\_index], C[max\_index]}$
\Else
\Return $\text{avg\_scores[max\_index]}$
\EndIf
\EndIf
\EndProcedure
\end{algorithmic}
\label{alg:enhanced_metric}
\end{algorithm*}

\end{document}